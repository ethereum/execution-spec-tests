
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A collection of test cases implemented in Python for Ethereum execution clients">
      
      
      
        <link rel="canonical" href="https://ethereum.github.io/execution-spec-tests/main/library/ethereum_test_tools/">
      
      
        <link rel="prev" href="../evm_transition_tool/">
      
      
        <link rel="next" href="../ethereum_test_forks/">
      
      
      <link rel="icon" href="../../img/ETH-logo-icon.svg">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.3.1">
    
    
      
        <title>Ethereum Test Tools Package - Ethereum Execution Spec Tests</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Ethereum Test Tools Package - Ethereum Execution Spec Tests" >
      
        <meta  property="og:description"  content="A collection of test cases implemented in Python for Ethereum execution clients" >
      
        <meta  property="og:image"  content="https://ethereum.github.io/execution-spec-tests/main/assets/images/social/library/ethereum_test_tools.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://ethereum.github.io/execution-spec-tests/main/library/ethereum_test_tools/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Ethereum Test Tools Package - Ethereum Execution Spec Tests" >
      
        <meta  name="twitter:description"  content="A collection of test cases implemented in Python for Ethereum execution clients" >
      
        <meta  name="twitter:image"  content="https://ethereum.github.io/execution-spec-tests/main/assets/images/social/library/ethereum_test_tools.png" >
      
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ethereum-test-tools-package" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Ethereum Execution Spec Tests" class="md-header__button md-logo" aria-label="Ethereum Execution Spec Tests" data-md-component="logo">
      
  <img src="../../img/Ethereum-logo-600px.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ethereum Execution Spec Tests
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ethereum Test Tools Package
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_3" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_3">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ethereum/execution-spec-tests" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    execution-spec-tests
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting_started/quick_start/" class="md-tabs__link">
          
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../writing_tests/" class="md-tabs__link">
          
  
    
  
  Writing Tests

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/state_transition/" class="md-tabs__link">
          
  
    
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../getting_help/" class="md-tabs__link">
        
  
    
  
  Getting Help

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../dev/" class="md-tabs__link">
          
  
    
  
  Developer Doc

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Library Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tests/" class="md-tabs__link">
          
  
    
  
  Test case reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Ethereum Execution Spec Tests" class="md-nav__button md-logo" aria-label="Ethereum Execution Spec Tests" data-md-component="logo">
      
  <img src="../../img/Ethereum-logo-600px.png" alt="logo">

    </a>
    Ethereum Execution Spec Tests
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ethereum/execution-spec-tests" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    execution-spec-tests
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/quick_start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/setup_vs_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VS Code Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/repository_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Repository Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/executing_tests_command_line/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Executing Tests at a Prompt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/executing_tests_vs_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Executing Tests in VS Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/executing_tests_dev_fork/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Executing Tests for Features Under Development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/debugging_t8n_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugging Transition Tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../writing_tests/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Writing Tests
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Writing Tests
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../writing_tests/code_standards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Standards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../writing_tests/types_of_tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types of Test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../writing_tests/adding_a_new_test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding a New Test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../writing_tests/writing_a_new_test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Writing a New Test
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../writing_tests/reference_specification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Referencing an EIP Spec Version
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../writing_tests/verifying_changes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verifying Changes Locally
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/state_transition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State Transition Tests
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_help/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Help
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../dev/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Developer Doc
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_6">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Developer Doc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/coding_style/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding Style
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/precommit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enabling Precommit Checks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Library Reference
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_7">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Library Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../evm_transition_tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EVM Transition Tool Package
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Ethereum Test Tools Package
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Ethereum Test Tools Package
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools" class="md-nav__link">
    ethereum_test_tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code" class="md-nav__link">
    Code
  </a>
  
    <nav class="md-nav" aria-label="Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.bytecode" class="md-nav__link">
    bytecode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.__bytes__" class="md-nav__link">
    __bytes__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.__radd__" class="md-nav__link">
    __radd__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.fill_test" class="md-nav__link">
    fill_test()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Initcode" class="md-nav__link">
    Initcode
  </a>
  
    <nav class="md-nav" aria-label="Initcode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Initcode.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Initcode.execution_gas" class="md-nav__link">
    execution_gas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Initcode.deploy_code" class="md-nav__link">
    deploy_code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Initcode.deployment_gas" class="md-nav__link">
    deployment_gas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.ceiling_division" class="md-nav__link">
    ceiling_division()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder" class="md-nav__link">
    JSONEncoder
  </a>
  
    <nav class="md-nav" aria-label="JSONEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field" class="md-nav__link">
    Field
  </a>
  
    <nav class="md-nav" aria-label="Field">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.cast_type" class="md-nav__link">
    cast_type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.skip_string_convert" class="md-nav__link">
    skip_string_convert
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.to_json" class="md-nav__link">
    to_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.default_value" class="md-nav__link">
    default_value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.default_value_skip_cast" class="md-nav__link">
    default_value_skip_cast
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.keep_none" class="md-nav__link">
    keep_none
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.skip" class="md-nav__link">
    skip
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.apply" class="md-nav__link">
    apply()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.default" class="md-nav__link">
    default()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.EngineAPIError" class="md-nav__link">
    EngineAPIError
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.compute_create_address" class="md-nav__link">
    compute_create_address()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode" class="md-nav__link">
    Opcode
  </a>
  
    <nav class="md-nav" aria-label="Opcode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode.__new__" class="md-nav__link">
    __new__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode.int" class="md-nav__link">
    int()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec" class="md-nav__link">
    ReferenceSpec
  </a>
  
    <nav class="md-nav" aria-label="ReferenceSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.name" class="md-nav__link">
    name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.has_known_version" class="md-nav__link">
    has_known_version()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.known_version" class="md-nav__link">
    known_version()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.api_url" class="md-nav__link">
    api_url()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.latest_version" class="md-nav__link">
    latest_version()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.is_outdated" class="md-nav__link">
    is_outdated()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.write_info" class="md-nav__link">
    write_info()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.parseable_from_module" class="md-nav__link">
    parseable_from_module()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.parse_from_module" class="md-nav__link">
    parse_from_module()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.StateTest" class="md-nav__link">
    StateTest
  </a>
  
    <nav class="md-nav" aria-label="StateTest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.StateTest.pytest_parameter_name" class="md-nav__link">
    pytest_parameter_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.StateTest.make_genesis" class="md-nav__link">
    make_genesis()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.StateTest.make_blocks" class="md-nav__link">
    make_blocks()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.BlockchainTest" class="md-nav__link">
    BlockchainTest
  </a>
  
    <nav class="md-nav" aria-label="BlockchainTest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BlockchainTest.pytest_parameter_name" class="md-nav__link">
    pytest_parameter_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BlockchainTest.make_genesis" class="md-nav__link">
    make_genesis()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BlockchainTest.make_block" class="md-nav__link">
    make_block()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BlockchainTest.make_blocks" class="md-nav__link">
    make_blocks()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.compute_create2_address" class="md-nav__link">
    compute_create2_address()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul" class="md-nav__link">
    Yul
  </a>
  
    <nav class="md-nav" aria-label="Yul">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul.__bytes__" class="md-nav__link">
    __bytes__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul.__radd__" class="md-nav__link">
    __radd__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul.version" class="md-nav__link">
    version()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.cost_memory_bytes" class="md-nav__link">
    cost_memory_bytes()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Removable" class="md-nav__link">
    Removable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Auto" class="md-nav__link">
    Auto
  </a>
  
    <nav class="md-nav" aria-label="Auto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Auto.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.copy_opcode_cost" class="md-nav__link">
    copy_opcode_cost()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.eip_2028_transaction_data_cost" class="md-nav__link">
    eip_2028_transaction_data_cost()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTestConfig" class="md-nav__link">
    BaseTestConfig
  </a>
  
    <nav class="md-nav" aria-label="BaseTestConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTestConfig.disable_hive" class="md-nav__link">
    disable_hive
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.to_address" class="md-nav__link">
    to_address()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.to_hash_bytes" class="md-nav__link">
    to_hash_bytes()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTest" class="md-nav__link">
    BaseTest
  </a>
  
    <nav class="md-nav" aria-label="BaseTest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTest.make_genesis" class="md-nav__link">
    make_genesis()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTest.make_blocks" class="md-nav__link">
    make_blocks()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTest.pytest_parameter_name" class="md-nav__link">
    pytest_parameter_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTest.get_next_transition_tool_output_path" class="md-nav__link">
    get_next_transition_tool_output_path()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.to_hash" class="md-nav__link">
    to_hash()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.add_kzg_version" class="md-nav__link">
    add_kzg_version()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure" class="md-nav__link">
    CodeGasMeasure
  </a>
  
    <nav class="md-nav" aria-label="CodeGasMeasure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure.code" class="md-nav__link">
    code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure.overhead_cost" class="md-nav__link">
    overhead_cost
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure.extra_stack_items" class="md-nav__link">
    extra_stack_items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure.sstore_key" class="md-nav__link">
    sstore_key
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcodes" class="md-nav__link">
    Opcodes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Conditional" class="md-nav__link">
    Conditional
  </a>
  
    <nav class="md-nav" aria-label="Conditional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Conditional.condition" class="md-nav__link">
    condition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Conditional.if_true" class="md-nav__link">
    if_true
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Conditional.if_false" class="md-nav__link">
    if_false
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Conditional.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Case" class="md-nav__link">
    Case
  </a>
  
    <nav class="md-nav" aria-label="Case">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Case.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage" class="md-nav__link">
    Storage
  </a>
  
    <nav class="md-nav" aria-label="Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.StorageDictType" class="md-nav__link">
    StorageDictType
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.InvalidType" class="md-nav__link">
    InvalidType
  </a>
  
    <nav class="md-nav" aria-label="InvalidType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.InvalidType.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.InvalidValue" class="md-nav__link">
    InvalidValue
  </a>
  
    <nav class="md-nav" aria-label="InvalidValue">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.InvalidValue.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.AmbiguousKeyValue" class="md-nav__link">
    AmbiguousKeyValue
  </a>
  
    <nav class="md-nav" aria-label="AmbiguousKeyValue">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.AmbiguousKeyValue.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.MissingKey" class="md-nav__link">
    MissingKey
  </a>
  
    <nav class="md-nav" aria-label="MissingKey">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.MissingKey.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.KeyValueMismatch" class="md-nav__link">
    KeyValueMismatch
  </a>
  
    <nav class="md-nav" aria-label="KeyValueMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.KeyValueMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.parse_key_value" class="md-nav__link">
    parse_key_value()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.key_value_to_string" class="md-nav__link">
    key_value_to_string()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__contains__" class="md-nav__link">
    __contains__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__getitem__" class="md-nav__link">
    __getitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__setitem__" class="md-nav__link">
    __setitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__delitem__" class="md-nav__link">
    __delitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.store_next" class="md-nav__link">
    store_next()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__json__" class="md-nav__link">
    __json__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.contains" class="md-nav__link">
    contains()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.must_contain" class="md-nav__link">
    must_contain()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.must_be_equal" class="md-nav__link">
    must_be_equal()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.CalldataCase" class="md-nav__link">
    CalldataCase
  </a>
  
    <nav class="md-nav" aria-label="CalldataCase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CalldataCase.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Switch" class="md-nav__link">
    Switch
  </a>
  
    <nav class="md-nav" aria-label="Switch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Switch.default_action" class="md-nav__link">
    default_action
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Switch.cases" class="md-nav__link">
    cases
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Switch.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account" class="md-nav__link">
    Account
  </a>
  
    <nav class="md-nav" aria-label="Account">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.nonce" class="md-nav__link">
    nonce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.balance" class="md-nav__link">
    balance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.code" class="md-nav__link">
    code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.storage" class="md-nav__link">
    storage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.NONEXISTENT" class="md-nav__link">
    NONEXISTENT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.NonceMismatch" class="md-nav__link">
    NonceMismatch
  </a>
  
    <nav class="md-nav" aria-label="NonceMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.NonceMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.BalanceMismatch" class="md-nav__link">
    BalanceMismatch
  </a>
  
    <nav class="md-nav" aria-label="BalanceMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.BalanceMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.CodeMismatch" class="md-nav__link">
    CodeMismatch
  </a>
  
    <nav class="md-nav" aria-label="CodeMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.CodeMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.check_alloc" class="md-nav__link">
    check_alloc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.is_empty" class="md-nav__link">
    is_empty()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.from_dict" class="md-nav__link">
    from_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.with_code" class="md-nav__link">
    with_code()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.merge" class="md-nav__link">
    merge()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Withdrawal" class="md-nav__link">
    Withdrawal
  </a>
  
    <nav class="md-nav" aria-label="Withdrawal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Withdrawal.to_serializable_list" class="md-nav__link">
    to_serializable_list()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Environment" class="md-nav__link">
    Environment
  </a>
  
    <nav class="md-nav" aria-label="Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Environment.from_parent_header" class="md-nav__link">
    from_parent_header()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Environment.parent_hash" class="md-nav__link">
    parent_hash()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Environment.apply_new_parent" class="md-nav__link">
    apply_new_parent()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Environment.set_fork_requirements" class="md-nav__link">
    set_fork_requirements()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.AccessList" class="md-nav__link">
    AccessList
  </a>
  
    <nav class="md-nav" aria-label="AccessList">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.AccessList.to_list" class="md-nav__link">
    to_list()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction" class="md-nav__link">
    Transaction
  </a>
  
    <nav class="md-nav" aria-label="Transaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.ty" class="md-nav__link">
    ty
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.InvalidFeePayment" class="md-nav__link">
    InvalidFeePayment
  </a>
  
    <nav class="md-nav" aria-label="InvalidFeePayment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.InvalidFeePayment.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.InvalidSignaturePrivateKey" class="md-nav__link">
    InvalidSignaturePrivateKey
  </a>
  
    <nav class="md-nav" aria-label="InvalidSignaturePrivateKey">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.InvalidSignaturePrivateKey.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.with_error" class="md-nav__link">
    with_error()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.with_nonce" class="md-nav__link">
    with_nonce()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.with_fields" class="md-nav__link">
    with_fields()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.payload_body" class="md-nav__link">
    payload_body()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.serialized_bytes" class="md-nav__link">
    serialized_bytes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.signing_envelope" class="md-nav__link">
    signing_envelope()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.signing_bytes" class="md-nav__link">
    signing_bytes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.signature_bytes" class="md-nav__link">
    signature_bytes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.with_signature_and_sender" class="md-nav__link">
    with_signature_and_sender()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Header" class="md-nav__link">
    Header
  </a>
  
    <nav class="md-nav" aria-label="Header">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Header.REMOVE_FIELD" class="md-nav__link">
    REMOVE_FIELD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Header.EMPTY_FIELD" class="md-nav__link">
    EMPTY_FIELD
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block" class="md-nav__link">
    Block
  </a>
  
    <nav class="md-nav" aria-label="Block">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.rlp" class="md-nav__link">
    rlp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.header_verify" class="md-nav__link">
    header_verify
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.rlp_modifier" class="md-nav__link">
    rlp_modifier
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.exception" class="md-nav__link">
    exception
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.engine_api_error_code" class="md-nav__link">
    engine_api_error_code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.txs" class="md-nav__link">
    txs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.ommers" class="md-nav__link">
    ommers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.withdrawals" class="md-nav__link">
    withdrawals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.set_environment" class="md-nav__link">
    set_environment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.copy_with_rlp" class="md-nav__link">
    copy_with_rlp()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.FixtureEngineNewPayload" class="md-nav__link">
    FixtureEngineNewPayload
  </a>
  
    <nav class="md-nav" aria-label="FixtureEngineNewPayload">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.FixtureEngineNewPayload.from_fixture_header" class="md-nav__link">
    from_fixture_header()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Fixture" class="md-nav__link">
    Fixture
  </a>
  
    <nav class="md-nav" aria-label="Fixture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Fixture.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Fixture.to_json" class="md-nav__link">
    to_json()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Fixture.fill_info" class="md-nav__link">
    fill_info()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ethereum_test_forks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ethereum Test Forks Package
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../pytest_plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pytest Plugins
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test case reference
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Test case reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Cancun
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Cancun
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip1153_tstore/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EIP-1153 Tstore
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_2">
            <span class="md-nav__icon md-icon"></span>
            EIP-1153 Tstore
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip1153_tstore/spec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip1153_tstore/test_tstorage/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Tstorage
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_2_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Test Tstorage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip1153_tstore/test_tstorage/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip1153_tstore/test_tstorage_create_contexts/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Tstorage Create Contexts
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_2_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_2_4">
            <span class="md-nav__icon md-icon"></span>
            Test Tstorage Create Contexts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip1153_tstore/test_tstorage_create_contexts/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip1153_tstore/test_tstorage_execution_contexts/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Tstorage Execution Contexts
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_2_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_2_5">
            <span class="md-nav__icon md-icon"></span>
            Test Tstorage Execution Contexts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip1153_tstore/test_tstorage_execution_contexts/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_2_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip1153_tstore/test_tstorage_reentrancy_contexts/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Tstorage Reentrancy Contexts
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_2_6">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_2_6">
            <span class="md-nav__icon md-icon"></span>
            Test Tstorage Reentrancy Contexts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip1153_tstore/test_tstorage_reentrancy_contexts/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_2_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip1153_tstore/test_tstorage_selfdestruct/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Tstorage Selfdestruct
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_2_7">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_2_7">
            <span class="md-nav__icon md-icon"></span>
            Test Tstorage Selfdestruct
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip1153_tstore/test_tstorage_selfdestruct/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4788_beacon_root/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EIP-4788 Beacon Root
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_3">
            <span class="md-nav__icon md-icon"></span>
            EIP-4788 Beacon Root
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4788_beacon_root/test_beacon_root_contract/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Beacon Root Contract
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_3_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Test Beacon Root Contract
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4788_beacon_root/test_beacon_root_contract/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4788_beacon_root/test_blocks_beacon_root_contract/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Blocks Beacon Root Contract
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_3_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            Test Blocks Beacon Root Contract
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4788_beacon_root/test_blocks_beacon_root_contract/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4844_blobs/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EIP-4844 Blobs
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4">
            <span class="md-nav__icon md-icon"></span>
            EIP-4844 Blobs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4844_blobs/spec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4844_blobs/test_blob_txs/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Blob Txs
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_4_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            Test Blob Txs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4844_blobs/test_blob_txs/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4844_blobs/test_blob_txs_full/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Blob Txs Full
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_4_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4_4">
            <span class="md-nav__icon md-icon"></span>
            Test Blob Txs Full
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4844_blobs/test_blob_txs_full/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4844_blobs/test_blobhash_opcode/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Blobhash Opcode
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_4_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4_5">
            <span class="md-nav__icon md-icon"></span>
            Test Blobhash Opcode
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4844_blobs/test_blobhash_opcode/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4844_blobs/test_blobhash_opcode_contexts/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Blobhash Opcode Contexts
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_4_6">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4_6">
            <span class="md-nav__icon md-icon"></span>
            Test Blobhash Opcode Contexts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4844_blobs/test_blobhash_opcode_contexts/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4844_blobs/test_excess_blob_gas/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Excess Blob Gas
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_4_7">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4_7">
            <span class="md-nav__icon md-icon"></span>
            Test Excess Blob Gas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4844_blobs/test_excess_blob_gas/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4844_blobs/test_excess_blob_gas_fork_transition/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Excess Blob Gas Fork Transition
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_4_8">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4_8">
            <span class="md-nav__icon md-icon"></span>
            Test Excess Blob Gas Fork Transition
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4844_blobs/test_excess_blob_gas_fork_transition/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4844_blobs/test_point_evaluation_precompile/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Point Evaluation Precompile
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_4_9">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4_9">
            <span class="md-nav__icon md-icon"></span>
            Test Point Evaluation Precompile
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4844_blobs/test_point_evaluation_precompile/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip4844_blobs/test_point_evaluation_precompile_gas/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Point Evaluation Precompile Gas
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_4_10">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4_10">
            <span class="md-nav__icon md-icon"></span>
            Test Point Evaluation Precompile Gas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4844_blobs/test_point_evaluation_precompile_gas/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_4_11" >
        
          <label class="md-nav__link" for="__nav_8_2_4_11" id="__nav_8_2_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Point Evaluation Vectors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_4_11">
            <span class="md-nav__icon md-icon"></span>
            Point Evaluation Vectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip4844_blobs/point_evaluation_vectors/README_./" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Readme
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip5656_mcopy/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EIP-5656 Mcopy
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_5">
            <span class="md-nav__icon md-icon"></span>
            EIP-5656 Mcopy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip5656_mcopy/test_mcopy/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Mcopy
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_5_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_5_2">
            <span class="md-nav__icon md-icon"></span>
            Test Mcopy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip5656_mcopy/test_mcopy/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_5_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip5656_mcopy/test_mcopy_contexts/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Mcopy Contexts
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_5_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_5_3">
            <span class="md-nav__icon md-icon"></span>
            Test Mcopy Contexts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip5656_mcopy/test_mcopy_contexts/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_5_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip5656_mcopy/test_mcopy_memory_expansion/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Mcopy Memory Expansion
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_5_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_5_4">
            <span class="md-nav__icon md-icon"></span>
            Test Mcopy Memory Expansion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip5656_mcopy/test_mcopy_memory_expansion/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip6780_selfdestruct/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EIP-6780 Selfdestruct
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_6">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_6">
            <span class="md-nav__icon md-icon"></span>
            EIP-6780 Selfdestruct
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_6_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip6780_selfdestruct/test_selfdestruct/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Selfdestruct
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_6_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_6_2">
            <span class="md-nav__icon md-icon"></span>
            Test Selfdestruct
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip6780_selfdestruct/test_selfdestruct/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_6_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/cancun/eip6780_selfdestruct/test_selfdestruct_revert/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Selfdestruct Revert
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_2_6_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_2_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_6_3">
            <span class="md-nav__icon md-icon"></span>
            Test Selfdestruct Revert
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/cancun/eip6780_selfdestruct/test_selfdestruct_revert/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/shanghai/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Shanghai
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            Shanghai
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/shanghai/eip3651_warm_coinbase/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EIP-3651 Warm Coinbase
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_3_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_2">
            <span class="md-nav__icon md-icon"></span>
            EIP-3651 Warm Coinbase
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/shanghai/eip3651_warm_coinbase/test_warm_coinbase/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Warm Coinbase
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_3_2_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            Test Warm Coinbase
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/shanghai/eip3651_warm_coinbase/test_warm_coinbase/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/shanghai/eip3855_push0/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EIP-3855 Push0
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_3_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_3">
            <span class="md-nav__icon md-icon"></span>
            EIP-3855 Push0
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/shanghai/eip3855_push0/test_push0/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Push0
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_3_3_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            Test Push0
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/shanghai/eip3855_push0/test_push0/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/shanghai/eip3860_initcode/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EIP-3860 Initcode
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_3_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_4">
            <span class="md-nav__icon md-icon"></span>
            EIP-3860 Initcode
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_4_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/shanghai/eip3860_initcode/test_initcode/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Initcode
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_3_4_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            Test Initcode
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/shanghai/eip3860_initcode/test_initcode/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/shanghai/eip4895_withdrawals/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EIP-4895 Withdrawals
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_3_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_5">
            <span class="md-nav__icon md-icon"></span>
            EIP-4895 Withdrawals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/shanghai/eip4895_withdrawals/test_withdrawals/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Withdrawals
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_3_5_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_3_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_5_2">
            <span class="md-nav__icon md-icon"></span>
            Test Withdrawals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/shanghai/eip4895_withdrawals/test_withdrawals/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/merge/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Merge
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4">
            <span class="md-nav__icon md-icon"></span>
            Merge
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_4_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/merge/security/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Security
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_4_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4_2">
            <span class="md-nav__icon md-icon"></span>
            Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_4_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/merge/security/test_selfdestruct_balance_bug/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Selfdestruct Balance Bug
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_4_2_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_4_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            Test Selfdestruct Balance Bug
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/merge/security/test_selfdestruct_balance_bug/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/berlin/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Berlin
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_5">
            <span class="md-nav__icon md-icon"></span>
            Berlin
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/berlin/eip2930_access_list/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EIP-2930 Access List
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_5_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_5_2">
            <span class="md-nav__icon md-icon"></span>
            EIP-2930 Access List
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_5_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/berlin/eip2930_access_list/test_acl/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test ACL
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_5_2_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_5_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_5_2_2">
            <span class="md-nav__icon md-icon"></span>
            Test ACL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/berlin/eip2930_access_list/test_acl/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/istanbul/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Istanbul
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_6">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_6">
            <span class="md-nav__icon md-icon"></span>
            Istanbul
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_6_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/istanbul/eip1344_chainid/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EIP-1344 CHAINID
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_6_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_6_2">
            <span class="md-nav__icon md-icon"></span>
            EIP-1344 CHAINID
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_6_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/istanbul/eip1344_chainid/test_chainid/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test CHAINID
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_6_2_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_6_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_6_2_2">
            <span class="md-nav__icon md-icon"></span>
            Test CHAINID
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/istanbul/eip1344_chainid/test_chainid/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/homestead/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Homestead
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_7">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_7">
            <span class="md-nav__icon md-icon"></span>
            Homestead
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_7_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/homestead/yul/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Yul
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_7_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_7_2">
            <span class="md-nav__icon md-icon"></span>
            Yul
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_7_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/homestead/yul/test_yul_example/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test Yul Example
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_7_2_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_7_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_7_2_2">
            <span class="md-nav__icon md-icon"></span>
            Test Yul Example
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/homestead/yul/test_yul_example/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/frontier/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Frontier
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_8">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_8">
            <span class="md-nav__icon md-icon"></span>
            Frontier
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_8_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/frontier/opcodes/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Opcodes
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_8_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_8_2">
            <span class="md-nav__icon md-icon"></span>
            Opcodes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_8_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tests/frontier/opcodes/test_dup/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Test DUP
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_8_8_2_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_8_8_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_8_2_2">
            <span class="md-nav__icon md-icon"></span>
            Test DUP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tests/frontier/opcodes/test_dup/index/test_cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Cases
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools" class="md-nav__link">
    ethereum_test_tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code" class="md-nav__link">
    Code
  </a>
  
    <nav class="md-nav" aria-label="Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.bytecode" class="md-nav__link">
    bytecode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.__bytes__" class="md-nav__link">
    __bytes__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Code.__radd__" class="md-nav__link">
    __radd__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.fill_test" class="md-nav__link">
    fill_test()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Initcode" class="md-nav__link">
    Initcode
  </a>
  
    <nav class="md-nav" aria-label="Initcode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Initcode.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Initcode.execution_gas" class="md-nav__link">
    execution_gas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Initcode.deploy_code" class="md-nav__link">
    deploy_code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Initcode.deployment_gas" class="md-nav__link">
    deployment_gas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.ceiling_division" class="md-nav__link">
    ceiling_division()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder" class="md-nav__link">
    JSONEncoder
  </a>
  
    <nav class="md-nav" aria-label="JSONEncoder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field" class="md-nav__link">
    Field
  </a>
  
    <nav class="md-nav" aria-label="Field">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.cast_type" class="md-nav__link">
    cast_type
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.skip_string_convert" class="md-nav__link">
    skip_string_convert
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.to_json" class="md-nav__link">
    to_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.default_value" class="md-nav__link">
    default_value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.default_value_skip_cast" class="md-nav__link">
    default_value_skip_cast
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.keep_none" class="md-nav__link">
    keep_none
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.skip" class="md-nav__link">
    skip
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.Field.apply" class="md-nav__link">
    apply()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.JSONEncoder.default" class="md-nav__link">
    default()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.EngineAPIError" class="md-nav__link">
    EngineAPIError
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.compute_create_address" class="md-nav__link">
    compute_create_address()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode" class="md-nav__link">
    Opcode
  </a>
  
    <nav class="md-nav" aria-label="Opcode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode--parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode.__new__" class="md-nav__link">
    __new__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode.int" class="md-nav__link">
    int()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcode.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec" class="md-nav__link">
    ReferenceSpec
  </a>
  
    <nav class="md-nav" aria-label="ReferenceSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.name" class="md-nav__link">
    name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.has_known_version" class="md-nav__link">
    has_known_version()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.known_version" class="md-nav__link">
    known_version()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.api_url" class="md-nav__link">
    api_url()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.latest_version" class="md-nav__link">
    latest_version()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.is_outdated" class="md-nav__link">
    is_outdated()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.write_info" class="md-nav__link">
    write_info()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.parseable_from_module" class="md-nav__link">
    parseable_from_module()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.ReferenceSpec.parse_from_module" class="md-nav__link">
    parse_from_module()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.StateTest" class="md-nav__link">
    StateTest
  </a>
  
    <nav class="md-nav" aria-label="StateTest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.StateTest.pytest_parameter_name" class="md-nav__link">
    pytest_parameter_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.StateTest.make_genesis" class="md-nav__link">
    make_genesis()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.StateTest.make_blocks" class="md-nav__link">
    make_blocks()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.BlockchainTest" class="md-nav__link">
    BlockchainTest
  </a>
  
    <nav class="md-nav" aria-label="BlockchainTest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BlockchainTest.pytest_parameter_name" class="md-nav__link">
    pytest_parameter_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BlockchainTest.make_genesis" class="md-nav__link">
    make_genesis()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BlockchainTest.make_block" class="md-nav__link">
    make_block()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BlockchainTest.make_blocks" class="md-nav__link">
    make_blocks()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.compute_create2_address" class="md-nav__link">
    compute_create2_address()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul" class="md-nav__link">
    Yul
  </a>
  
    <nav class="md-nav" aria-label="Yul">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul.__bytes__" class="md-nav__link">
    __bytes__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul.__radd__" class="md-nav__link">
    __radd__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Yul.version" class="md-nav__link">
    version()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.cost_memory_bytes" class="md-nav__link">
    cost_memory_bytes()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Removable" class="md-nav__link">
    Removable
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Auto" class="md-nav__link">
    Auto
  </a>
  
    <nav class="md-nav" aria-label="Auto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Auto.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.copy_opcode_cost" class="md-nav__link">
    copy_opcode_cost()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.eip_2028_transaction_data_cost" class="md-nav__link">
    eip_2028_transaction_data_cost()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTestConfig" class="md-nav__link">
    BaseTestConfig
  </a>
  
    <nav class="md-nav" aria-label="BaseTestConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTestConfig.disable_hive" class="md-nav__link">
    disable_hive
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.to_address" class="md-nav__link">
    to_address()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.to_hash_bytes" class="md-nav__link">
    to_hash_bytes()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTest" class="md-nav__link">
    BaseTest
  </a>
  
    <nav class="md-nav" aria-label="BaseTest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTest.make_genesis" class="md-nav__link">
    make_genesis()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTest.make_blocks" class="md-nav__link">
    make_blocks()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTest.pytest_parameter_name" class="md-nav__link">
    pytest_parameter_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.BaseTest.get_next_transition_tool_output_path" class="md-nav__link">
    get_next_transition_tool_output_path()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.to_hash" class="md-nav__link">
    to_hash()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.add_kzg_version" class="md-nav__link">
    add_kzg_version()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure" class="md-nav__link">
    CodeGasMeasure
  </a>
  
    <nav class="md-nav" aria-label="CodeGasMeasure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure.code" class="md-nav__link">
    code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure.overhead_cost" class="md-nav__link">
    overhead_cost
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure.extra_stack_items" class="md-nav__link">
    extra_stack_items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure.sstore_key" class="md-nav__link">
    sstore_key
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CodeGasMeasure.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Opcodes" class="md-nav__link">
    Opcodes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Conditional" class="md-nav__link">
    Conditional
  </a>
  
    <nav class="md-nav" aria-label="Conditional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Conditional.condition" class="md-nav__link">
    condition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Conditional.if_true" class="md-nav__link">
    if_true
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Conditional.if_false" class="md-nav__link">
    if_false
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Conditional.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Case" class="md-nav__link">
    Case
  </a>
  
    <nav class="md-nav" aria-label="Case">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Case.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage" class="md-nav__link">
    Storage
  </a>
  
    <nav class="md-nav" aria-label="Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.StorageDictType" class="md-nav__link">
    StorageDictType
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.InvalidType" class="md-nav__link">
    InvalidType
  </a>
  
    <nav class="md-nav" aria-label="InvalidType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.InvalidType.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.InvalidValue" class="md-nav__link">
    InvalidValue
  </a>
  
    <nav class="md-nav" aria-label="InvalidValue">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.InvalidValue.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.AmbiguousKeyValue" class="md-nav__link">
    AmbiguousKeyValue
  </a>
  
    <nav class="md-nav" aria-label="AmbiguousKeyValue">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.AmbiguousKeyValue.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.MissingKey" class="md-nav__link">
    MissingKey
  </a>
  
    <nav class="md-nav" aria-label="MissingKey">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.MissingKey.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.KeyValueMismatch" class="md-nav__link">
    KeyValueMismatch
  </a>
  
    <nav class="md-nav" aria-label="KeyValueMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.KeyValueMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.parse_key_value" class="md-nav__link">
    parse_key_value()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.key_value_to_string" class="md-nav__link">
    key_value_to_string()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__contains__" class="md-nav__link">
    __contains__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__getitem__" class="md-nav__link">
    __getitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__setitem__" class="md-nav__link">
    __setitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__delitem__" class="md-nav__link">
    __delitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.store_next" class="md-nav__link">
    store_next()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.__json__" class="md-nav__link">
    __json__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.contains" class="md-nav__link">
    contains()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.must_contain" class="md-nav__link">
    must_contain()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Storage.must_be_equal" class="md-nav__link">
    must_be_equal()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.CalldataCase" class="md-nav__link">
    CalldataCase
  </a>
  
    <nav class="md-nav" aria-label="CalldataCase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.CalldataCase.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Switch" class="md-nav__link">
    Switch
  </a>
  
    <nav class="md-nav" aria-label="Switch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Switch.default_action" class="md-nav__link">
    default_action
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Switch.cases" class="md-nav__link">
    cases
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Switch.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account" class="md-nav__link">
    Account
  </a>
  
    <nav class="md-nav" aria-label="Account">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.nonce" class="md-nav__link">
    nonce
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.balance" class="md-nav__link">
    balance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.code" class="md-nav__link">
    code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.storage" class="md-nav__link">
    storage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.NONEXISTENT" class="md-nav__link">
    NONEXISTENT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.NonceMismatch" class="md-nav__link">
    NonceMismatch
  </a>
  
    <nav class="md-nav" aria-label="NonceMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.NonceMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.BalanceMismatch" class="md-nav__link">
    BalanceMismatch
  </a>
  
    <nav class="md-nav" aria-label="BalanceMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.BalanceMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.CodeMismatch" class="md-nav__link">
    CodeMismatch
  </a>
  
    <nav class="md-nav" aria-label="CodeMismatch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.CodeMismatch.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.check_alloc" class="md-nav__link">
    check_alloc()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.is_empty" class="md-nav__link">
    is_empty()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.from_dict" class="md-nav__link">
    from_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.with_code" class="md-nav__link">
    with_code()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Account.merge" class="md-nav__link">
    merge()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Withdrawal" class="md-nav__link">
    Withdrawal
  </a>
  
    <nav class="md-nav" aria-label="Withdrawal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Withdrawal.to_serializable_list" class="md-nav__link">
    to_serializable_list()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Environment" class="md-nav__link">
    Environment
  </a>
  
    <nav class="md-nav" aria-label="Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Environment.from_parent_header" class="md-nav__link">
    from_parent_header()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Environment.parent_hash" class="md-nav__link">
    parent_hash()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Environment.apply_new_parent" class="md-nav__link">
    apply_new_parent()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Environment.set_fork_requirements" class="md-nav__link">
    set_fork_requirements()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.AccessList" class="md-nav__link">
    AccessList
  </a>
  
    <nav class="md-nav" aria-label="AccessList">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.AccessList.to_list" class="md-nav__link">
    to_list()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction" class="md-nav__link">
    Transaction
  </a>
  
    <nav class="md-nav" aria-label="Transaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.ty" class="md-nav__link">
    ty
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.InvalidFeePayment" class="md-nav__link">
    InvalidFeePayment
  </a>
  
    <nav class="md-nav" aria-label="InvalidFeePayment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.InvalidFeePayment.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.InvalidSignaturePrivateKey" class="md-nav__link">
    InvalidSignaturePrivateKey
  </a>
  
    <nav class="md-nav" aria-label="InvalidSignaturePrivateKey">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.InvalidSignaturePrivateKey.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.with_error" class="md-nav__link">
    with_error()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.with_nonce" class="md-nav__link">
    with_nonce()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.with_fields" class="md-nav__link">
    with_fields()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.payload_body" class="md-nav__link">
    payload_body()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.serialized_bytes" class="md-nav__link">
    serialized_bytes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.signing_envelope" class="md-nav__link">
    signing_envelope()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.signing_bytes" class="md-nav__link">
    signing_bytes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.signature_bytes" class="md-nav__link">
    signature_bytes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Transaction.with_signature_and_sender" class="md-nav__link">
    with_signature_and_sender()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Header" class="md-nav__link">
    Header
  </a>
  
    <nav class="md-nav" aria-label="Header">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Header.REMOVE_FIELD" class="md-nav__link">
    REMOVE_FIELD
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Header.EMPTY_FIELD" class="md-nav__link">
    EMPTY_FIELD
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block" class="md-nav__link">
    Block
  </a>
  
    <nav class="md-nav" aria-label="Block">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.rlp" class="md-nav__link">
    rlp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.header_verify" class="md-nav__link">
    header_verify
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.rlp_modifier" class="md-nav__link">
    rlp_modifier
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.exception" class="md-nav__link">
    exception
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.engine_api_error_code" class="md-nav__link">
    engine_api_error_code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.txs" class="md-nav__link">
    txs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.ommers" class="md-nav__link">
    ommers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.withdrawals" class="md-nav__link">
    withdrawals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.set_environment" class="md-nav__link">
    set_environment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Block.copy_with_rlp" class="md-nav__link">
    copy_with_rlp()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.FixtureEngineNewPayload" class="md-nav__link">
    FixtureEngineNewPayload
  </a>
  
    <nav class="md-nav" aria-label="FixtureEngineNewPayload">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.FixtureEngineNewPayload.from_fixture_header" class="md-nav__link">
    from_fixture_header()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethereum_test_tools.Fixture" class="md-nav__link">
    Fixture
  </a>
  
    <nav class="md-nav" aria-label="Fixture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Fixture.__post_init__" class="md-nav__link">
    __post_init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Fixture.to_json" class="md-nav__link">
    to_json()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ethereum_test_tools.Fixture.fill_info" class="md-nav__link">
    fill_info()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="ethereum-test-tools-package">Ethereum Test Tools Package<a class="headerlink" href="#ethereum-test-tools-package" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="ethereum_test_tools"></a>
  <div class="doc doc-contents first">
  
      <p>Module containing tools for generating cross-client Ethereum execution layer
tests.</p>

  

  <div class="doc doc-children">



































<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Code" class="doc doc-heading">
          <code>Code</code>


<a href="#ethereum_test_tools.Code" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="typing.SupportsBytes">SupportsBytes</span></code>, <code><span title="typing.Sized">Sized</span></code></p>

  
      <p>Generic code object.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/code/code.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Code</span><span class="p">(</span><span class="n">SupportsBytes</span><span class="p">,</span> <span class="n">Sized</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generic code object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bytecode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    bytes array that represents the bytecode of this object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name used to describe this code.</span>
<span class="sd">    Usually used to add extra information to a test case.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">code</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new Code object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">code</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="fm">__bytes__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transform the Code object into bytes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">bytes</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the length of the Code object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Code&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds two code objects together, by converting both to bytes first.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Code</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Code&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds two code objects together, by converting both to bytes first.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Code</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">+</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Code.bytecode" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">bytecode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Code.bytecode" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>bytes array that represents the bytecode of this object.</p>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Code.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Code.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a new Code object.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/code.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">code</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new Code object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">code</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Code.name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Code.name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Name used to describe this code.
Usually used to add extra information to a test case.</p>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Code.__bytes__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__bytes__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Code.__bytes__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Transform the Code object into bytes.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/code.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__bytes__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transform the Code object into bytes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Code.__len__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Code.__len__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get the length of the Code object.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/code.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the length of the Code object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Code.__add__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Code.__add__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Adds two code objects together, by converting both to bytes first.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/code.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Code&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds two code objects together, by converting both to bytes first.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Code</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Code.__radd__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__radd__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Code.__radd__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Adds two code objects together, by converting both to bytes first.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/code.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Code&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds two code objects together, by converting both to bytes first.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Code</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">+</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h2 id="ethereum_test_tools.fill_test" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fill_test</span><span class="p">(</span><span class="n">t8n</span><span class="p">,</span> <span class="n">test_spec</span><span class="p">,</span> <span class="n">fork</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="n">eips</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.fill_test" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Fills fixtures for the specified fork.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/filling/fill.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fill_test</span><span class="p">(</span>
    <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
    <span class="n">test_spec</span><span class="p">:</span> <span class="n">BaseTest</span><span class="p">,</span>
    <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
    <span class="n">engine</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">spec</span><span class="p">:</span> <span class="n">ReferenceSpec</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">eips</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Fixture</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fills fixtures for the specified fork.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t8n</span><span class="o">.</span><span class="n">reset_traces</span><span class="p">()</span>

    <span class="n">pre</span><span class="p">,</span> <span class="n">genesis_rlp</span><span class="p">,</span> <span class="n">genesis</span> <span class="o">=</span> <span class="n">test_spec</span><span class="o">.</span><span class="n">make_genesis</span><span class="p">(</span><span class="n">t8n</span><span class="p">,</span> <span class="n">fork</span><span class="p">)</span>

    <span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">alloc</span><span class="p">)</span> <span class="o">=</span> <span class="n">test_spec</span><span class="o">.</span><span class="n">make_blocks</span><span class="p">(</span>
        <span class="n">t8n</span><span class="p">,</span>
        <span class="n">genesis</span><span class="p">,</span>
        <span class="n">pre</span><span class="p">,</span>
        <span class="n">fork</span><span class="p">,</span>
        <span class="n">eips</span><span class="o">=</span><span class="n">eips</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fork_name</span> <span class="o">=</span> <span class="n">fork</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
    <span class="n">fixture</span> <span class="o">=</span> <span class="n">Fixture</span><span class="p">(</span>
        <span class="n">blocks</span><span class="o">=</span><span class="n">blocks</span><span class="p">,</span>
        <span class="n">genesis</span><span class="o">=</span><span class="n">genesis</span><span class="p">,</span>
        <span class="n">genesis_rlp</span><span class="o">=</span><span class="n">genesis_rlp</span><span class="p">,</span>
        <span class="n">head</span><span class="o">=</span><span class="n">head</span><span class="p">,</span>
        <span class="n">fork</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">fork_name</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">eip</span><span class="p">)</span> <span class="k">for</span> <span class="n">eip</span> <span class="ow">in</span> <span class="n">eips</span><span class="p">])</span> <span class="k">if</span> <span class="n">eips</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">fork_name</span><span class="p">,</span>
        <span class="n">pre_state</span><span class="o">=</span><span class="n">pre</span><span class="p">,</span>
        <span class="n">post_state</span><span class="o">=</span><span class="n">alloc_to_accounts</span><span class="p">(</span><span class="n">alloc</span><span class="p">),</span>
        <span class="n">seal_engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">test_spec</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">fixture</span><span class="o">.</span><span class="n">fill_info</span><span class="p">(</span><span class="n">t8n</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fixture</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Initcode" class="doc doc-heading">
          <code>Initcode</code>


<a href="#ethereum_test_tools.Initcode" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="ethereum_test_tools.code.code.Code" href="#ethereum_test_tools.Code">Code</a></code></p>

  
      <p>Helper class used to generate initcode for the specified deployment code.</p>
<p>The execution gas cost of the initcode is calculated, and also the
deployment gas costs for the deployed code.</p>
<p>The initcode can be padded to a certain length if necessary, which
does not affect the deployed code.</p>
<p>Other costs such as the CREATE2 hashing costs or the initcode_word_cost
of EIP-3860 are <em>not</em> taken into account by any of these calculated
costs.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Initcode</span><span class="p">(</span><span class="n">Code</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper class used to generate initcode for the specified deployment code.</span>

<span class="sd">    The execution gas cost of the initcode is calculated, and also the</span>
<span class="sd">    deployment gas costs for the deployed code.</span>

<span class="sd">    The initcode can be padded to a certain length if necessary, which</span>
<span class="sd">    does not affect the deployed code.</span>

<span class="sd">    Other costs such as the CREATE2 hashing costs or the initcode_word_cost</span>
<span class="sd">    of EIP-3860 are *not* taken into account by any of these calculated</span>
<span class="sd">    costs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">deploy_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bytecode to be deployed by the initcode.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">execution_gas</span><span class="p">:</span> <span class="nb">int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gas cost of executing the initcode, without considering deployment gas</span>
<span class="sd">    costs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deployment_gas</span><span class="p">:</span> <span class="nb">int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gas cost of deploying the cost, subtracted after initcode execution,</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">deploy_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">,</span>
        <span class="n">initcode_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">initcode_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">initcode_prefix_execution_gas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">padding_byte</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate legacy initcode that inits a contract with the specified code.</span>
<span class="sd">        The initcode can be padded to a specified length for testing purposes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">=</span> <span class="n">initcode_prefix_execution_gas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deploy_code</span> <span class="o">=</span> <span class="n">deploy_code</span>
        <span class="n">deploy_code_bytes</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deploy_code</span><span class="p">)</span>
        <span class="n">code_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">deploy_code_bytes</span><span class="p">)</span>

        <span class="n">initcode_prefix_bytes</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">initcode_prefix</span><span class="p">)</span>
        <span class="n">initcode</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">initcode_prefix_bytes</span><span class="p">)</span>

        <span class="c1"># PUSH2: length=&lt;bytecode length&gt;</span>
        <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x61</span><span class="p">)</span>
        <span class="n">initcode</span> <span class="o">+=</span> <span class="n">code_length</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">3</span>

        <span class="c1"># PUSH1: offset=0</span>
        <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x60</span><span class="p">)</span>
        <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x00</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">3</span>

        <span class="c1"># DUP2</span>
        <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x81</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">3</span>

        <span class="c1"># PUSH1: initcode_length=11 + len(initcode_prefix_bytes) (constant)</span>
        <span class="n">no_prefix_length</span> <span class="o">=</span> <span class="mh">0x0B</span>
        <span class="k">assert</span> <span class="n">no_prefix_length</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">initcode_prefix_bytes</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="s2">&quot;initcode prefix too long&quot;</span>
        <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x60</span><span class="p">)</span>
        <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">no_prefix_length</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">initcode_prefix_bytes</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">3</span>

        <span class="c1"># DUP3</span>
        <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x82</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">3</span>

        <span class="c1"># CODECOPY: destinationOffset=0, offset=0, length</span>
        <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x39</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="mi">3</span>
            <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">ceiling_division</span><span class="p">(</span><span class="n">code_length</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
            <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">code_length</span><span class="p">)</span>
            <span class="o">+</span> <span class="p">((</span><span class="n">code_length</span> <span class="o">*</span> <span class="n">code_length</span><span class="p">)</span> <span class="o">//</span> <span class="mi">512</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># RETURN: offset=0, length</span>
        <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0xF3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">0</span>

        <span class="n">initcode_plus_deploy_code</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">initcode</span><span class="p">)</span> <span class="o">+</span> <span class="n">deploy_code_bytes</span>
        <span class="n">padding_bytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">initcode_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">initcode_length</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span>
                <span class="n">initcode_plus_deploy_code</span>
            <span class="p">),</span> <span class="s2">&quot;specified invalid length for initcode&quot;</span>

            <span class="n">padding_bytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span>
                <span class="p">[</span><span class="n">padding_byte</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">initcode_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">initcode_plus_deploy_code</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">deployment_gas</span> <span class="o">=</span> <span class="n">GAS_PER_DEPLOYED_CODE_BYTE</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">deploy_code_bytes</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">initcode_plus_deploy_code</span> <span class="o">+</span> <span class="n">padding_bytes</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Initcode.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">deploy_code</span><span class="p">,</span> <span class="n">initcode_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initcode_prefix</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">initcode_prefix_execution_gas</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padding_byte</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Initcode.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Generate legacy initcode that inits a contract with the specified code.
The initcode can be padded to a specified length for testing purposes.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deploy_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">,</span>
    <span class="n">initcode_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">initcode_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">initcode_prefix_execution_gas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">padding_byte</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate legacy initcode that inits a contract with the specified code.</span>
<span class="sd">    The initcode can be padded to a specified length for testing purposes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">=</span> <span class="n">initcode_prefix_execution_gas</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">deploy_code</span> <span class="o">=</span> <span class="n">deploy_code</span>
    <span class="n">deploy_code_bytes</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deploy_code</span><span class="p">)</span>
    <span class="n">code_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">deploy_code_bytes</span><span class="p">)</span>

    <span class="n">initcode_prefix_bytes</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">initcode_prefix</span><span class="p">)</span>
    <span class="n">initcode</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">initcode_prefix_bytes</span><span class="p">)</span>

    <span class="c1"># PUSH2: length=&lt;bytecode length&gt;</span>
    <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x61</span><span class="p">)</span>
    <span class="n">initcode</span> <span class="o">+=</span> <span class="n">code_length</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">3</span>

    <span class="c1"># PUSH1: offset=0</span>
    <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x60</span><span class="p">)</span>
    <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x00</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">3</span>

    <span class="c1"># DUP2</span>
    <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x81</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">3</span>

    <span class="c1"># PUSH1: initcode_length=11 + len(initcode_prefix_bytes) (constant)</span>
    <span class="n">no_prefix_length</span> <span class="o">=</span> <span class="mh">0x0B</span>
    <span class="k">assert</span> <span class="n">no_prefix_length</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">initcode_prefix_bytes</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="s2">&quot;initcode prefix too long&quot;</span>
    <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x60</span><span class="p">)</span>
    <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">no_prefix_length</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">initcode_prefix_bytes</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">3</span>

    <span class="c1"># DUP3</span>
    <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x82</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">3</span>

    <span class="c1"># CODECOPY: destinationOffset=0, offset=0, length</span>
    <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x39</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="p">(</span>
        <span class="mi">3</span>
        <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">ceiling_division</span><span class="p">(</span><span class="n">code_length</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
        <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">code_length</span><span class="p">)</span>
        <span class="o">+</span> <span class="p">((</span><span class="n">code_length</span> <span class="o">*</span> <span class="n">code_length</span><span class="p">)</span> <span class="o">//</span> <span class="mi">512</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># RETURN: offset=0, length</span>
    <span class="n">initcode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0xF3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">execution_gas</span> <span class="o">+=</span> <span class="mi">0</span>

    <span class="n">initcode_plus_deploy_code</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">initcode</span><span class="p">)</span> <span class="o">+</span> <span class="n">deploy_code_bytes</span>
    <span class="n">padding_bytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">initcode_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">initcode_length</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span>
            <span class="n">initcode_plus_deploy_code</span>
        <span class="p">),</span> <span class="s2">&quot;specified invalid length for initcode&quot;</span>

        <span class="n">padding_bytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span>
            <span class="p">[</span><span class="n">padding_byte</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">initcode_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">initcode_plus_deploy_code</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">deployment_gas</span> <span class="o">=</span> <span class="n">GAS_PER_DEPLOYED_CODE_BYTE</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">deploy_code_bytes</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">initcode_plus_deploy_code</span> <span class="o">+</span> <span class="n">padding_bytes</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Initcode.execution_gas" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">execution_gas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">initcode_prefix_execution_gas</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Initcode.execution_gas" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Gas cost of executing the initcode, without considering deployment gas
costs.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Initcode.deploy_code" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">deploy_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span> <span class="o">=</span> <span class="n">deploy_code</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Initcode.deploy_code" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Bytecode to be deployed by the initcode.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Initcode.deployment_gas" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">deployment_gas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">GAS_PER_DEPLOYED_CODE_BYTE</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">deploy_code_bytes</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Initcode.deployment_gas" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Gas cost of deploying the cost, subtracted after initcode execution,</p>
  </div>

</div>




  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h2 id="ethereum_test_tools.ceiling_division" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">ceiling_division</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.ceiling_division" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the ceil without using floating point.
Used by many of the EVM's formulas</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ceiling_division</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the ceil without using floating point.</span>
<span class="sd">    Used by many of the EVM&#39;s formulas</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">a</span> <span class="o">//</span> <span class="o">-</span><span class="n">b</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.JSONEncoder" class="doc doc-heading">
          <code>JSONEncoder</code>


<a href="#ethereum_test_tools.JSONEncoder" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="json.JSONEncoder">JSONEncoder</span></code></p>

  
      <p>Custom JSON encoder for <code>ethereum_test</code> types.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/json.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">JSONEncoder</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Custom JSON encoder for `ethereum_test` types.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">class</span> <span class="nc">Field</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Settings for a field in a JSON object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The name of the field in the JSON object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cast_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The type or function to use to cast the field to before serializing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">skip_string_convert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        By default, the fields are converted to string after serializing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether the field should be converted to JSON by itself.</span>
<span class="sd">        This option and `JSON_SKIP_STRING_CONVERT` are mutually exclusive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">default_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Value to use if the field is not set before type casting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">default_value_skip_cast</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Value to use if the field is not set and also skip type casting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keep_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether to keep the field if it is `None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether to skip the field when serializing.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Applies the settings to the target dictionary.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value_skip_cast</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">target</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value_skip_cast</span>
                    <span class="k">return</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_none</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span>

            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cast_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cast_type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_string_convert</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="n">target</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Encodes types defined in this module using basic python facilities.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;__json__&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">__json__</span><span class="p">(</span><span class="n">encoder</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">is_dataclass</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">result</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">object_field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                <span class="n">field_name</span> <span class="o">=</span> <span class="n">object_field</span><span class="o">.</span><span class="n">name</span>
                <span class="n">metadata</span> <span class="o">=</span> <span class="n">object_field</span><span class="o">.</span><span class="n">metadata</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
                <span class="k">assert</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Field </span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2"> has no metadata&quot;</span>
                <span class="n">field_settings</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;json_encoder&quot;</span><span class="p">)</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_settings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">),</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Field </span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2"> has invalid json_encoder &quot;</span> <span class="sa">f</span><span class="s2">&quot;metadata: </span><span class="si">{</span><span class="n">field_settings</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">field_settings</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">]</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">or</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-class">




<h3 id="ethereum_test_tools.JSONEncoder.Field" class="doc doc-heading">
          <code>Field</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.JSONEncoder.Field" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

  
      <p>Settings for a field in a JSON object.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/json.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Field</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Settings for a field in a JSON object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The name of the field in the JSON object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cast_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The type or function to use to cast the field to before serializing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">skip_string_convert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    By default, the fields are converted to string after serializing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">to_json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Whether the field should be converted to JSON by itself.</span>
<span class="sd">    This option and `JSON_SKIP_STRING_CONVERT` are mutually exclusive.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Value to use if the field is not set before type casting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default_value_skip_cast</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Value to use if the field is not set and also skip type casting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keep_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Whether to keep the field if it is `None`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Whether to skip the field when serializing.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies the settings to the target dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value_skip_cast</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">target</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value_skip_cast</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_none</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cast_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cast_type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_string_convert</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="n">target</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h4 id="ethereum_test_tools.JSONEncoder.Field.name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.JSONEncoder.Field.name" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>The name of the field in the JSON object.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h4 id="ethereum_test_tools.JSONEncoder.Field.cast_type" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cast_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.JSONEncoder.Field.cast_type" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>The type or function to use to cast the field to before serializing.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h4 id="ethereum_test_tools.JSONEncoder.Field.skip_string_convert" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">skip_string_convert</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.JSONEncoder.Field.skip_string_convert" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>By default, the fields are converted to string after serializing.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h4 id="ethereum_test_tools.JSONEncoder.Field.to_json" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.JSONEncoder.Field.to_json" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Whether the field should be converted to JSON by itself.
This option and <code>JSON_SKIP_STRING_CONVERT</code> are mutually exclusive.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h4 id="ethereum_test_tools.JSONEncoder.Field.default_value" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">default_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.JSONEncoder.Field.default_value" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Value to use if the field is not set before type casting.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h4 id="ethereum_test_tools.JSONEncoder.Field.default_value_skip_cast" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">default_value_skip_cast</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.JSONEncoder.Field.default_value_skip_cast" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Value to use if the field is not set and also skip type casting.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h4 id="ethereum_test_tools.JSONEncoder.Field.keep_none" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">keep_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.JSONEncoder.Field.keep_none" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Whether to keep the field if it is <code>None</code>.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h4 id="ethereum_test_tools.JSONEncoder.Field.skip" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">skip</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.JSONEncoder.Field.skip" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Whether to skip the field when serializing.</p>
  </div>

</div>







<div class="doc doc-object doc-function">




<h4 id="ethereum_test_tools.JSONEncoder.Field.apply" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">apply</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.JSONEncoder.Field.apply" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Applies the settings to the target dictionary.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/json.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONEncoder</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">field_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies the settings to the target dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
        <span class="n">field_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value_skip_cast</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">target</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_value_skip_cast</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_none</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cast_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cast_type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_string_convert</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="n">target</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.JSONEncoder.default" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">default</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.JSONEncoder.default" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Encodes types defined in this module using basic python facilities.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/json.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Encodes types defined in this module using basic python facilities.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;__json__&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">__json__</span><span class="p">(</span><span class="n">encoder</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">is_dataclass</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">object_field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">field_name</span> <span class="o">=</span> <span class="n">object_field</span><span class="o">.</span><span class="n">name</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="n">object_field</span><span class="o">.</span><span class="n">metadata</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">field_name</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Field </span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2"> has no metadata&quot;</span>
            <span class="n">field_settings</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;json_encoder&quot;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_settings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Field</span><span class="p">),</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Field </span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s2"> has invalid json_encoder &quot;</span> <span class="sa">f</span><span class="s2">&quot;metadata: </span><span class="si">{</span><span class="n">field_settings</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">field_settings</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">field_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">]</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">or</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.EngineAPIError" class="doc doc-heading">
          <code>EngineAPIError</code>


<a href="#ethereum_test_tools.EngineAPIError" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="enum.IntEnum">IntEnum</span></code></p>

  
      <p>List of Engine API errors</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/constants.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">EngineAPIError</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of Engine API errors</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ParseError</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32700</span>
    <span class="n">InvalidRequest</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32600</span>
    <span class="n">MethodNotFound</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32601</span>
    <span class="n">InvalidParams</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32602</span>
    <span class="n">InternalError</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32603</span>
    <span class="n">ServerError</span> <span class="o">=</span> <span class="o">-</span><span class="mi">32000</span>
    <span class="n">UnknownPayload</span> <span class="o">=</span> <span class="o">-</span><span class="mi">38001</span>
    <span class="n">InvalidForkchoiceState</span> <span class="o">=</span> <span class="o">-</span><span class="mi">38002</span>
    <span class="n">InvalidPayloadAttributes</span> <span class="o">=</span> <span class="o">-</span><span class="mi">38003</span>
    <span class="n">TooLargeRequest</span> <span class="o">=</span> <span class="o">-</span><span class="mi">38004</span>
    <span class="n">UnsupportedFork</span> <span class="o">=</span> <span class="o">-</span><span class="mi">38005</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">





  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h2 id="ethereum_test_tools.compute_create_address" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_create_address</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">nonce</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.compute_create_address" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Compute address of the resulting contract created using a transaction
or the <code>CREATE</code> opcode.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_create_address</span><span class="p">(</span><span class="n">address</span><span class="p">:</span> <span class="n">FixedSizeBytesConvertible</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute address of the resulting contract created using a transaction</span>
<span class="sd">    or the `CREATE` opcode.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nonce_bytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span> <span class="k">if</span> <span class="n">nonce</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">nonce</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">)</span>
    <span class="nb">hash</span> <span class="o">=</span> <span class="n">keccak256</span><span class="p">(</span><span class="n">encode</span><span class="p">([</span><span class="n">Address</span><span class="p">(</span><span class="n">address</span><span class="p">),</span> <span class="n">nonce_bytes</span><span class="p">]))</span>
    <span class="k">return</span> <span class="s2">&quot;0x&quot;</span> <span class="o">+</span> <span class="nb">hash</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:]</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Opcode" class="doc doc-heading">
          <code>Opcode</code>


<a href="#ethereum_test_tools.Opcode" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>bytes</code></p>

  
      <p>Represents a single Opcode instruction in the EVM, with extra
metadata useful to parametrize tests.</p>
<h4 id="ethereum_test_tools.Opcode--parameters">Parameters<a class="headerlink" href="#ethereum_test_tools.Opcode--parameters" title="Permanent link">&para;</a></h4>
<ul>
<li>popped_stack_items: number of items the opcode pops from the stack</li>
<li>pushed_stack_items: number of items the opcode pushes to the stack</li>
<li>min_stack_height: minimum stack height required by the opcode</li>
<li>data_portion_length: number of bytes after the opcode in the bytecode
    that represent data</li>
</ul>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/vm/opcode.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Opcode</span><span class="p">(</span><span class="nb">bytes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a single Opcode instruction in the EVM, with extra</span>
<span class="sd">    metadata useful to parametrize tests.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    - popped_stack_items: number of items the opcode pops from the stack</span>
<span class="sd">    - pushed_stack_items: number of items the opcode pushes to the stack</span>
<span class="sd">    - min_stack_height: minimum stack height required by the opcode</span>
<span class="sd">    - data_portion_length: number of bytes after the opcode in the bytecode</span>
<span class="sd">        that represent data</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">popped_stack_items</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">pushed_stack_items</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">min_stack_height</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">data_portion_length</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">_name_</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">opcode_or_byte</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s2">&quot;Opcode&quot;</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">popped_stack_items</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">pushed_stack_items</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">min_stack_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">data_portion_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new opcode instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">opcode_or_byte</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Opcode</span><span class="p">:</span>
            <span class="c1"># Required because Enum class calls the base class with the</span>
            <span class="c1"># instantiated object as parameter.</span>
            <span class="k">return</span> <span class="n">opcode_or_byte</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opcode_or_byte</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="p">[</span><span class="n">opcode_or_byte</span><span class="p">])</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">popped_stack_items</span> <span class="o">=</span> <span class="n">popped_stack_items</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">pushed_stack_items</span> <span class="o">=</span> <span class="n">pushed_stack_items</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">min_stack_height</span> <span class="o">=</span> <span class="n">min_stack_height</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">data_portion_length</span> <span class="o">=</span> <span class="n">data_portion_length</span>
            <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args_t</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Opcode&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Makes all opcode instances callable to return formatted bytecode,</span>
<span class="sd">        which constitutes a data portion, that is located after the opcode</span>
<span class="sd">        byte, and pre-opcode bytecode, which is normally used to set up the</span>
<span class="sd">        stack.</span>

<span class="sd">        This useful to automatically format, e.g., push opcodes and their</span>
<span class="sd">        data sections as `Opcodes.PUSH1(0x00)`.</span>

<span class="sd">        Data sign is automatically detected but for this reason the range</span>
<span class="sd">        of the input must be:</span>
<span class="sd">        `[-2^(data_portion_bits-1), 2^(data_portion_bits)]`</span>
<span class="sd">        where:</span>
<span class="sd">        `data_portion_bits == data_portion_length * 8`</span>

<span class="sd">        For the stack, the arguments are set up in the opposite order they are</span>
<span class="sd">        given, so the first argument is the last item pushed to the stack.</span>

<span class="sd">        The resulting stack arrangement does not take into account opcode stack</span>
<span class="sd">        element consumption, so the stack height is not guaranteed to be</span>
<span class="sd">        correct and the user must take this into consideration.</span>

<span class="sd">        Integers can also be used as stack elements, in which case they are</span>
<span class="sd">        automatically converted to PUSH operations, and negative numbers always</span>
<span class="sd">        use a PUSH32 operation.</span>

<span class="sd">        Hex-strings will automatically be converted to bytes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Opcode&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args_t</span><span class="p">)</span>
        <span class="n">pre_opcode_bytecode</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>
        <span class="n">data_portion</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_portion_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># For opcodes with a data portion, the first argument is the data</span>
            <span class="c1"># and the rest of the arguments form the stack.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Opcode with data portion requires at least one argument&quot;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;0x&quot;</span><span class="p">):</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_portion_length</span>
                <span class="n">data_portion</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_portion_length</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">signed</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&lt;</span> <span class="mi">0</span>
                <span class="n">data_portion</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span>
                    <span class="n">length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_portion_length</span><span class="p">,</span>
                    <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">,</span>
                    <span class="n">signed</span><span class="o">=</span><span class="n">signed</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Opcode data portion must be either an int or bytes/hex string&quot;</span><span class="p">)</span>

        <span class="c1"># The rest of the arguments conform the stack.</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;0x&quot;</span><span class="p">):</span>
                        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">pre_opcode_bytecode</span> <span class="o">+=</span> <span class="n">data</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="c1"># We are going to push a constant to the stack.</span>
                <span class="n">signed</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&lt;</span> <span class="mi">0</span>
                <span class="n">data_size</span> <span class="o">=</span> <span class="n">_get_int_size</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">data_size</span> <span class="o">&gt;</span> <span class="mi">32</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Opcode stack data must be less than 32 bytes&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">data_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Pushing 0 is done with the PUSH1 opcode for compatibility</span>
                    <span class="c1"># reasons.</span>
                    <span class="n">data_size</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="n">pre_opcode_bytecode</span> <span class="o">+=</span> <span class="n">_push_opcodes_byte_list</span><span class="p">[</span><span class="n">data_size</span><span class="p">]</span>
                <span class="n">pre_opcode_bytecode</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span>
                    <span class="n">length</span><span class="o">=</span><span class="n">data_size</span><span class="p">,</span>
                    <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">,</span>
                    <span class="n">signed</span><span class="o">=</span><span class="n">signed</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Opcode stack data must be either an int or a bytes/hex string&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pre_opcode_bytecode</span> <span class="o">+</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">data_portion</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the total bytecode length of the opcode, taking into account</span>
<span class="sd">        its data portion.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_portion_length</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the integer representation of the opcode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="nb">bytes</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the name of the opcode, assigned at Enum creation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name_</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Opcode.__new__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="n">opcode_or_byte</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Opcode.__new__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a new opcode instance.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/vm/opcode.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">opcode_or_byte</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s2">&quot;Opcode&quot;</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">popped_stack_items</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">pushed_stack_items</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">min_stack_height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">data_portion_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a new opcode instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">opcode_or_byte</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Opcode</span><span class="p">:</span>
        <span class="c1"># Required because Enum class calls the base class with the</span>
        <span class="c1"># instantiated object as parameter.</span>
        <span class="k">return</span> <span class="n">opcode_or_byte</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opcode_or_byte</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="p">[</span><span class="n">opcode_or_byte</span><span class="p">])</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">popped_stack_items</span> <span class="o">=</span> <span class="n">popped_stack_items</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">pushed_stack_items</span> <span class="o">=</span> <span class="n">pushed_stack_items</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">min_stack_height</span> <span class="o">=</span> <span class="n">min_stack_height</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">data_portion_length</span> <span class="o">=</span> <span class="n">data_portion_length</span>
        <span class="k">return</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Opcode.__call__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args_t</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Opcode.__call__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Makes all opcode instances callable to return formatted bytecode,
which constitutes a data portion, that is located after the opcode
byte, and pre-opcode bytecode, which is normally used to set up the
stack.</p>
<p>This useful to automatically format, e.g., push opcodes and their
data sections as <code>Opcodes.PUSH1(0x00)</code>.</p>
<p>Data sign is automatically detected but for this reason the range
of the input must be:
<code>[-2^(data_portion_bits-1), 2^(data_portion_bits)]</code>
where:
<code>data_portion_bits == data_portion_length * 8</code></p>
<p>For the stack, the arguments are set up in the opposite order they are
given, so the first argument is the last item pushed to the stack.</p>
<p>The resulting stack arrangement does not take into account opcode stack
element consumption, so the stack height is not guaranteed to be
correct and the user must take this into consideration.</p>
<p>Integers can also be used as stack elements, in which case they are
automatically converted to PUSH operations, and negative numbers always
use a PUSH32 operation.</p>
<p>Hex-strings will automatically be converted to bytes.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/vm/opcode.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args_t</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Opcode&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes all opcode instances callable to return formatted bytecode,</span>
<span class="sd">    which constitutes a data portion, that is located after the opcode</span>
<span class="sd">    byte, and pre-opcode bytecode, which is normally used to set up the</span>
<span class="sd">    stack.</span>

<span class="sd">    This useful to automatically format, e.g., push opcodes and their</span>
<span class="sd">    data sections as `Opcodes.PUSH1(0x00)`.</span>

<span class="sd">    Data sign is automatically detected but for this reason the range</span>
<span class="sd">    of the input must be:</span>
<span class="sd">    `[-2^(data_portion_bits-1), 2^(data_portion_bits)]`</span>
<span class="sd">    where:</span>
<span class="sd">    `data_portion_bits == data_portion_length * 8`</span>

<span class="sd">    For the stack, the arguments are set up in the opposite order they are</span>
<span class="sd">    given, so the first argument is the last item pushed to the stack.</span>

<span class="sd">    The resulting stack arrangement does not take into account opcode stack</span>
<span class="sd">    element consumption, so the stack height is not guaranteed to be</span>
<span class="sd">    correct and the user must take this into consideration.</span>

<span class="sd">    Integers can also be used as stack elements, in which case they are</span>
<span class="sd">    automatically converted to PUSH operations, and negative numbers always</span>
<span class="sd">    use a PUSH32 operation.</span>

<span class="sd">    Hex-strings will automatically be converted to bytes.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;Opcode&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args_t</span><span class="p">)</span>
    <span class="n">pre_opcode_bytecode</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>
    <span class="n">data_portion</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_portion_length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># For opcodes with a data portion, the first argument is the data</span>
        <span class="c1"># and the rest of the arguments form the stack.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Opcode with data portion requires at least one argument&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;0x&quot;</span><span class="p">):</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
                <span class="n">data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_portion_length</span>
            <span class="n">data_portion</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_portion_length</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">signed</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&lt;</span> <span class="mi">0</span>
            <span class="n">data_portion</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span>
                <span class="n">length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_portion_length</span><span class="p">,</span>
                <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">,</span>
                <span class="n">signed</span><span class="o">=</span><span class="n">signed</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Opcode data portion must be either an int or bytes/hex string&quot;</span><span class="p">)</span>

    <span class="c1"># The rest of the arguments conform the stack.</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;0x&quot;</span><span class="p">):</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
                <span class="n">data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">pre_opcode_bytecode</span> <span class="o">+=</span> <span class="n">data</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="c1"># We are going to push a constant to the stack.</span>
            <span class="n">signed</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&lt;</span> <span class="mi">0</span>
            <span class="n">data_size</span> <span class="o">=</span> <span class="n">_get_int_size</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">data_size</span> <span class="o">&gt;</span> <span class="mi">32</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Opcode stack data must be less than 32 bytes&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">data_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Pushing 0 is done with the PUSH1 opcode for compatibility</span>
                <span class="c1"># reasons.</span>
                <span class="n">data_size</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="n">pre_opcode_bytecode</span> <span class="o">+=</span> <span class="n">_push_opcodes_byte_list</span><span class="p">[</span><span class="n">data_size</span><span class="p">]</span>
            <span class="n">pre_opcode_bytecode</span> <span class="o">+=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span>
                <span class="n">length</span><span class="o">=</span><span class="n">data_size</span><span class="p">,</span>
                <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">,</span>
                <span class="n">signed</span><span class="o">=</span><span class="n">signed</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Opcode stack data must be either an int or a bytes/hex string&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pre_opcode_bytecode</span> <span class="o">+</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">data_portion</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Opcode.__len__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Opcode.__len__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the total bytecode length of the opcode, taking into account
its data portion.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/vm/opcode.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the total bytecode length of the opcode, taking into account</span>
<span class="sd">    its data portion.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_portion_length</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Opcode.int" class="doc doc-heading">
          <code class="highlight language-python"><span class="nb">int</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Opcode.int" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the integer representation of the opcode.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/vm/opcode.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">int</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the integer representation of the opcode.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="nb">bytes</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Opcode.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Opcode.__str__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Return the name of the opcode, assigned at Enum creation.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/vm/opcode.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the name of the opcode, assigned at Enum creation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name_</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.ReferenceSpec" class="doc doc-heading">
          <code>ReferenceSpec</code>


<a href="#ethereum_test_tools.ReferenceSpec" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Reference Specification Description Abstract Class.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/reference_spec/reference_spec.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ReferenceSpec</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reference Specification Description Abstract Class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the name of the spec.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">has_known_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns true if the reference spec object is hard-coded with a latest</span>
<span class="sd">        known version.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">known_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the latest known version in the reference.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">api_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the URL required to poll the version from an API, if needed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">latest_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a digest that points to the latest version of the spec.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">is_outdated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the reference specification has been updated since the</span>
<span class="sd">        test was last updated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">write_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes info about the reference specification used into the output</span>
<span class="sd">        fixture.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@staticmethod</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">parseable_from_module</span><span class="p">(</span><span class="n">module_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether the module&#39;s dict contains required reference spec</span>
<span class="sd">        information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@staticmethod</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">parse_from_module</span><span class="p">(</span><span class="n">module_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;ReferenceSpec&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses the module&#39;s dict into a reference spec.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.ReferenceSpec.name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">name</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#ethereum_test_tools.ReferenceSpec.name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the name of the spec.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/reference_spec/reference_spec.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the name of the spec.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.ReferenceSpec.has_known_version" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">has_known_version</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#ethereum_test_tools.ReferenceSpec.has_known_version" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns true if the reference spec object is hard-coded with a latest
known version.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/reference_spec/reference_spec.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">has_known_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns true if the reference spec object is hard-coded with a latest</span>
<span class="sd">    known version.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.ReferenceSpec.known_version" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">known_version</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#ethereum_test_tools.ReferenceSpec.known_version" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the latest known version in the reference.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/reference_spec/reference_spec.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">known_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the latest known version in the reference.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.ReferenceSpec.api_url" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">api_url</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#ethereum_test_tools.ReferenceSpec.api_url" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the URL required to poll the version from an API, if needed.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/reference_spec/reference_spec.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">api_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the URL required to poll the version from an API, if needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.ReferenceSpec.latest_version" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">latest_version</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#ethereum_test_tools.ReferenceSpec.latest_version" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns a digest that points to the latest version of the spec.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/reference_spec/reference_spec.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">latest_version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a digest that points to the latest version of the spec.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.ReferenceSpec.is_outdated" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_outdated</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#ethereum_test_tools.ReferenceSpec.is_outdated" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Checks whether the reference specification has been updated since the
test was last updated.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/reference_spec/reference_spec.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">is_outdated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the reference specification has been updated since the</span>
<span class="sd">    test was last updated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.ReferenceSpec.write_info" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">write_info</span><span class="p">(</span><span class="n">info</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#ethereum_test_tools.ReferenceSpec.write_info" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Writes info about the reference specification used into the output
fixture.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/reference_spec/reference_spec.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">write_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes info about the reference specification used into the output</span>
<span class="sd">    fixture.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.ReferenceSpec.parseable_from_module" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parseable_from_module</span><span class="p">(</span><span class="n">module_dict</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ethereum_test_tools.ReferenceSpec.parseable_from_module" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Checks whether the module's dict contains required reference spec
information.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/reference_spec/reference_spec.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">parseable_from_module</span><span class="p">(</span><span class="n">module_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the module&#39;s dict contains required reference spec</span>
<span class="sd">    information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.ReferenceSpec.parse_from_module" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_from_module</span><span class="p">(</span><span class="n">module_dict</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ethereum_test_tools.ReferenceSpec.parse_from_module" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parses the module's dict into a reference spec.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/reference_spec/reference_spec.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">parse_from_module</span><span class="p">(</span><span class="n">module_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;ReferenceSpec&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses the module&#39;s dict into a reference spec.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.StateTest" class="doc doc-heading">
          <code>StateTest</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.StateTest" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="ethereum_test_tools.spec.base_test.BaseTest" href="#ethereum_test_tools.BaseTest">BaseTest</a></code></p>

  
      <p>Filler type that tests transactions over the period of a single block.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/spec/state_test.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">StateTest</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filler type that tests transactions over the period of a single block.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">env</span><span class="p">:</span> <span class="n">Environment</span>
    <span class="n">pre</span><span class="p">:</span> <span class="n">Mapping</span>
    <span class="n">post</span><span class="p">:</span> <span class="n">Mapping</span>
    <span class="n">txs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Transaction</span><span class="p">]</span>
    <span class="n">engine_api_error_code</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EngineAPIError</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">pytest_parameter_name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the parameter name used to identify this filler in a test.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;state_test&quot;</span>

    <span class="k">def</span> <span class="nf">make_genesis</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
        <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Alloc</span><span class="p">,</span> <span class="n">Bytes</span><span class="p">,</span> <span class="n">FixtureHeader</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a genesis block from the state test definition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The genesis environment is similar to the block 1 environment specified by the test</span>
        <span class="c1"># with some slight differences, so make a copy here</span>
        <span class="n">genesis_env</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>

        <span class="c1"># Modify values to the proper values for the genesis block</span>
        <span class="n">genesis_env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">genesis_env</span><span class="o">.</span><span class="n">beacon_root</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">genesis_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">number</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">genesis_env</span><span class="o">.</span><span class="n">number</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="p">),</span> <span class="s2">&quot;genesis block number cannot be negative, set state test env.number to 1&quot;</span>

        <span class="c1"># Set the fork requirements to the genesis environment in-place</span>
        <span class="n">genesis_env</span><span class="o">.</span><span class="n">set_fork_requirements</span><span class="p">(</span><span class="n">fork</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">pre_alloc</span> <span class="o">=</span> <span class="n">Alloc</span><span class="p">(</span>
            <span class="n">fork</span><span class="o">.</span><span class="n">pre_allocation</span><span class="p">(</span>
                <span class="n">block_number</span><span class="o">=</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">new_alloc</span><span class="p">,</span> <span class="n">state_root</span> <span class="o">=</span> <span class="n">t8n</span><span class="o">.</span><span class="n">calc_state_root</span><span class="p">(</span>
            <span class="n">alloc</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">Alloc</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pre_alloc</span><span class="p">,</span> <span class="n">Alloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pre</span><span class="p">))),</span>
            <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
            <span class="n">debug_output_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_transition_tool_output_path</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">genesis</span> <span class="o">=</span> <span class="n">FixtureHeader</span><span class="p">(</span>
            <span class="n">parent_hash</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">ommers_hash</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyOmmersRoot</span><span class="p">),</span>
            <span class="n">coinbase</span><span class="o">=</span><span class="n">Address</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">state_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">state_root</span><span class="p">),</span>
            <span class="n">transactions_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyTrieRoot</span><span class="p">),</span>
            <span class="n">receipt_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyTrieRoot</span><span class="p">),</span>
            <span class="n">bloom</span><span class="o">=</span><span class="n">Bloom</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">difficulty</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">(</span>
                <span class="mh">0x20000</span> <span class="k">if</span> <span class="n">genesis_env</span><span class="o">.</span><span class="n">difficulty</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">genesis_env</span><span class="o">.</span><span class="n">difficulty</span>
            <span class="p">),</span>
            <span class="n">number</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">number</span><span class="p">),</span>
            <span class="n">gas_limit</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
            <span class="n">gas_used</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">extra_data</span><span class="o">=</span><span class="n">Bytes</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">mix_digest</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">nonce</span><span class="o">=</span><span class="n">HeaderNonce</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">base_fee</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">base_fee</span><span class="p">),</span>
            <span class="n">blob_gas_used</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">blob_gas_used</span><span class="p">),</span>
            <span class="n">excess_blob_gas</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">excess_blob_gas</span><span class="p">),</span>
            <span class="n">withdrawals_root</span><span class="o">=</span><span class="n">Hash</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span>
                <span class="n">EmptyTrieRoot</span> <span class="k">if</span> <span class="n">genesis_env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">),</span>
            <span class="n">beacon_root</span><span class="o">=</span><span class="n">Hash</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">beacon_root</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">genesis_rlp</span><span class="p">,</span> <span class="n">genesis</span><span class="o">.</span><span class="n">hash</span> <span class="o">=</span> <span class="n">genesis</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
            <span class="n">txs</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">withdrawals</span><span class="o">=</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">new_alloc</span><span class="p">),</span> <span class="n">genesis_rlp</span><span class="p">,</span> <span class="n">genesis</span>

    <span class="k">def</span> <span class="nf">make_blocks</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
        <span class="n">genesis</span><span class="p">:</span> <span class="n">FixtureHeader</span><span class="p">,</span>
        <span class="n">pre</span><span class="p">:</span> <span class="n">Alloc</span><span class="p">,</span>
        <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
        <span class="n">chain_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">eips</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">FixtureBlock</span><span class="p">],</span> <span class="n">Hash</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a block from the state test definition.</span>
<span class="sd">        Performs checks against the expected behavior of the test.</span>
<span class="sd">        Raises exception on invalid test behavior.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">apply_new_parent</span><span class="p">(</span><span class="n">genesis</span><span class="p">)</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">set_fork_requirements</span><span class="p">(</span><span class="n">fork</span><span class="p">)</span>

        <span class="n">txs</span> <span class="o">=</span> <span class="p">[</span><span class="n">tx</span><span class="o">.</span><span class="n">with_signature_and_sender</span><span class="p">()</span> <span class="k">for</span> <span class="n">tx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">txs</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">txs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="n">alloc</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">t8n</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
            <span class="n">alloc</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">pre</span><span class="p">),</span>
            <span class="n">txs</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">txs</span><span class="p">),</span>
            <span class="n">env</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">env</span><span class="p">),</span>
            <span class="n">fork_name</span><span class="o">=</span><span class="n">fork</span><span class="o">.</span><span class="n">fork</span><span class="p">(</span><span class="n">block_number</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">number</span><span class="p">),</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)),</span>
            <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">,</span>
            <span class="n">reward</span><span class="o">=</span><span class="n">fork</span><span class="o">.</span><span class="n">get_reward</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">number</span><span class="p">),</span> <span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)),</span>
            <span class="n">eips</span><span class="o">=</span><span class="n">eips</span><span class="p">,</span>
            <span class="n">debug_output_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_transition_tool_output_path</span><span class="p">(),</span>
        <span class="p">)</span>

        <span class="n">rejected_txs</span> <span class="o">=</span> <span class="n">verify_transactions</span><span class="p">(</span><span class="n">txs</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rejected_txs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;one or more transactions in `StateTest` are &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;intrinsically invalid, which are not allowed. &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;Use `BlockchainTest` to verify rejection of blocks &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;that include invalid transactions.&quot;</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">verify_post_alloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="p">,</span> <span class="n">alloc</span><span class="p">)</span>
            <span class="n">verify_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">print_traces</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">t8n</span><span class="o">.</span><span class="n">get_traces</span><span class="p">())</span>
            <span class="k">raise</span> <span class="n">e</span>

        <span class="n">env</span><span class="o">.</span><span class="n">extra_data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">FixtureHeader</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span>
            <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
            <span class="n">transition_tool_result</span><span class="o">=</span><span class="n">result</span><span class="p">,</span>
            <span class="n">environment</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">block</span><span class="p">,</span> <span class="n">header</span><span class="o">.</span><span class="n">hash</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
            <span class="n">txs</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
            <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">new_payload</span><span class="p">:</span> <span class="n">FixtureEngineNewPayload</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_test_config</span><span class="o">.</span><span class="n">disable_hive</span><span class="p">:</span>
            <span class="n">new_payload</span> <span class="o">=</span> <span class="n">FixtureEngineNewPayload</span><span class="o">.</span><span class="n">from_fixture_header</span><span class="p">(</span>
                <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                <span class="n">transactions</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
                <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
                <span class="n">error_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">engine_api_error_code</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="p">[</span>
                <span class="n">FixtureBlock</span><span class="p">(</span>
                    <span class="n">rlp</span><span class="o">=</span><span class="n">block</span><span class="p">,</span>
                    <span class="n">new_payload</span><span class="o">=</span><span class="n">new_payload</span><span class="p">,</span>
                    <span class="n">block_header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                    <span class="n">txs</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
                    <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
                    <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">],</span>
            <span class="n">header</span><span class="o">.</span><span class="n">hash</span><span class="p">,</span>
            <span class="n">alloc</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.StateTest.pytest_parameter_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">pytest_parameter_name</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#ethereum_test_tools.StateTest.pytest_parameter_name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the parameter name used to identify this filler in a test.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/spec/state_test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">pytest_parameter_name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the parameter name used to identify this filler in a test.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;state_test&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.StateTest.make_genesis" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_genesis</span><span class="p">(</span><span class="n">t8n</span><span class="p">,</span> <span class="n">fork</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.StateTest.make_genesis" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a genesis block from the state test definition.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/spec/state_test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_genesis</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
    <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Alloc</span><span class="p">,</span> <span class="n">Bytes</span><span class="p">,</span> <span class="n">FixtureHeader</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a genesis block from the state test definition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># The genesis environment is similar to the block 1 environment specified by the test</span>
    <span class="c1"># with some slight differences, so make a copy here</span>
    <span class="n">genesis_env</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>

    <span class="c1"># Modify values to the proper values for the genesis block</span>
    <span class="n">genesis_env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">genesis_env</span><span class="o">.</span><span class="n">beacon_root</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">genesis_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">number</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">genesis_env</span><span class="o">.</span><span class="n">number</span> <span class="o">&gt;=</span> <span class="mi">0</span>
    <span class="p">),</span> <span class="s2">&quot;genesis block number cannot be negative, set state test env.number to 1&quot;</span>

    <span class="c1"># Set the fork requirements to the genesis environment in-place</span>
    <span class="n">genesis_env</span><span class="o">.</span><span class="n">set_fork_requirements</span><span class="p">(</span><span class="n">fork</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">pre_alloc</span> <span class="o">=</span> <span class="n">Alloc</span><span class="p">(</span>
        <span class="n">fork</span><span class="o">.</span><span class="n">pre_allocation</span><span class="p">(</span>
            <span class="n">block_number</span><span class="o">=</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">new_alloc</span><span class="p">,</span> <span class="n">state_root</span> <span class="o">=</span> <span class="n">t8n</span><span class="o">.</span><span class="n">calc_state_root</span><span class="p">(</span>
        <span class="n">alloc</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">Alloc</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pre_alloc</span><span class="p">,</span> <span class="n">Alloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pre</span><span class="p">))),</span>
        <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
        <span class="n">debug_output_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_transition_tool_output_path</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="n">genesis</span> <span class="o">=</span> <span class="n">FixtureHeader</span><span class="p">(</span>
        <span class="n">parent_hash</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">ommers_hash</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyOmmersRoot</span><span class="p">),</span>
        <span class="n">coinbase</span><span class="o">=</span><span class="n">Address</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">state_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">state_root</span><span class="p">),</span>
        <span class="n">transactions_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyTrieRoot</span><span class="p">),</span>
        <span class="n">receipt_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyTrieRoot</span><span class="p">),</span>
        <span class="n">bloom</span><span class="o">=</span><span class="n">Bloom</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">difficulty</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">(</span>
            <span class="mh">0x20000</span> <span class="k">if</span> <span class="n">genesis_env</span><span class="o">.</span><span class="n">difficulty</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">genesis_env</span><span class="o">.</span><span class="n">difficulty</span>
        <span class="p">),</span>
        <span class="n">number</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">number</span><span class="p">),</span>
        <span class="n">gas_limit</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
        <span class="n">gas_used</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">timestamp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">extra_data</span><span class="o">=</span><span class="n">Bytes</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">mix_digest</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">nonce</span><span class="o">=</span><span class="n">HeaderNonce</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">base_fee</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">base_fee</span><span class="p">),</span>
        <span class="n">blob_gas_used</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">blob_gas_used</span><span class="p">),</span>
        <span class="n">excess_blob_gas</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">excess_blob_gas</span><span class="p">),</span>
        <span class="n">withdrawals_root</span><span class="o">=</span><span class="n">Hash</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span>
            <span class="n">EmptyTrieRoot</span> <span class="k">if</span> <span class="n">genesis_env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">beacon_root</span><span class="o">=</span><span class="n">Hash</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">beacon_root</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">genesis_rlp</span><span class="p">,</span> <span class="n">genesis</span><span class="o">.</span><span class="n">hash</span> <span class="o">=</span> <span class="n">genesis</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
        <span class="n">txs</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">withdrawals</span><span class="o">=</span><span class="n">genesis_env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">new_alloc</span><span class="p">),</span> <span class="n">genesis_rlp</span><span class="p">,</span> <span class="n">genesis</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.StateTest.make_blocks" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_blocks</span><span class="p">(</span><span class="n">t8n</span><span class="p">,</span> <span class="n">genesis</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">fork</span><span class="p">,</span> <span class="n">chain_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eips</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.StateTest.make_blocks" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a block from the state test definition.
Performs checks against the expected behavior of the test.
Raises exception on invalid test behavior.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/spec/state_test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_blocks</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
    <span class="n">genesis</span><span class="p">:</span> <span class="n">FixtureHeader</span><span class="p">,</span>
    <span class="n">pre</span><span class="p">:</span> <span class="n">Alloc</span><span class="p">,</span>
    <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
    <span class="n">chain_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">eips</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">FixtureBlock</span><span class="p">],</span> <span class="n">Hash</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a block from the state test definition.</span>
<span class="sd">    Performs checks against the expected behavior of the test.</span>
<span class="sd">    Raises exception on invalid test behavior.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">apply_new_parent</span><span class="p">(</span><span class="n">genesis</span><span class="p">)</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">set_fork_requirements</span><span class="p">(</span><span class="n">fork</span><span class="p">)</span>

    <span class="n">txs</span> <span class="o">=</span> <span class="p">[</span><span class="n">tx</span><span class="o">.</span><span class="n">with_signature_and_sender</span><span class="p">()</span> <span class="k">for</span> <span class="n">tx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">txs</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">txs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

    <span class="n">alloc</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">t8n</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
        <span class="n">alloc</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">pre</span><span class="p">),</span>
        <span class="n">txs</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">txs</span><span class="p">),</span>
        <span class="n">env</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">env</span><span class="p">),</span>
        <span class="n">fork_name</span><span class="o">=</span><span class="n">fork</span><span class="o">.</span><span class="n">fork</span><span class="p">(</span><span class="n">block_number</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">number</span><span class="p">),</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)),</span>
        <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">,</span>
        <span class="n">reward</span><span class="o">=</span><span class="n">fork</span><span class="o">.</span><span class="n">get_reward</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">number</span><span class="p">),</span> <span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)),</span>
        <span class="n">eips</span><span class="o">=</span><span class="n">eips</span><span class="p">,</span>
        <span class="n">debug_output_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_transition_tool_output_path</span><span class="p">(),</span>
    <span class="p">)</span>

    <span class="n">rejected_txs</span> <span class="o">=</span> <span class="n">verify_transactions</span><span class="p">(</span><span class="n">txs</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rejected_txs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;one or more transactions in `StateTest` are &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;intrinsically invalid, which are not allowed. &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;Use `BlockchainTest` to verify rejection of blocks &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;that include invalid transactions.&quot;</span>
        <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">verify_post_alloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="p">,</span> <span class="n">alloc</span><span class="p">)</span>
        <span class="n">verify_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">print_traces</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="n">t8n</span><span class="o">.</span><span class="n">get_traces</span><span class="p">())</span>
        <span class="k">raise</span> <span class="n">e</span>

    <span class="n">env</span><span class="o">.</span><span class="n">extra_data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span>
    <span class="n">header</span> <span class="o">=</span> <span class="n">FixtureHeader</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span>
        <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
        <span class="n">transition_tool_result</span><span class="o">=</span><span class="n">result</span><span class="p">,</span>
        <span class="n">environment</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">block</span><span class="p">,</span> <span class="n">header</span><span class="o">.</span><span class="n">hash</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
        <span class="n">txs</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
        <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">new_payload</span><span class="p">:</span> <span class="n">FixtureEngineNewPayload</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_test_config</span><span class="o">.</span><span class="n">disable_hive</span><span class="p">:</span>
        <span class="n">new_payload</span> <span class="o">=</span> <span class="n">FixtureEngineNewPayload</span><span class="o">.</span><span class="n">from_fixture_header</span><span class="p">(</span>
            <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
            <span class="n">transactions</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
            <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
            <span class="n">error_code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">engine_api_error_code</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="p">[</span>
            <span class="n">FixtureBlock</span><span class="p">(</span>
                <span class="n">rlp</span><span class="o">=</span><span class="n">block</span><span class="p">,</span>
                <span class="n">new_payload</span><span class="o">=</span><span class="n">new_payload</span><span class="p">,</span>
                <span class="n">block_header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                <span class="n">txs</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
                <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">header</span><span class="o">.</span><span class="n">hash</span><span class="p">,</span>
        <span class="n">alloc</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.BlockchainTest" class="doc doc-heading">
          <code>BlockchainTest</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.BlockchainTest" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="ethereum_test_tools.spec.base_test.BaseTest" href="#ethereum_test_tools.BaseTest">BaseTest</a></code></p>

  
      <p>Filler type that tests multiple blocks (valid or invalid) in a chain.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/spec/blockchain_test.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">BlockchainTest</span><span class="p">(</span><span class="n">BaseTest</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filler type that tests multiple blocks (valid or invalid) in a chain.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pre</span><span class="p">:</span> <span class="n">Mapping</span>
    <span class="n">post</span><span class="p">:</span> <span class="n">Mapping</span>
    <span class="n">blocks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Block</span><span class="p">]</span>
    <span class="n">genesis_environment</span><span class="p">:</span> <span class="n">Environment</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">Environment</span><span class="p">)</span>
    <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">pytest_parameter_name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the parameter name used to identify this filler in a test.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;blockchain_test&quot;</span>

    <span class="k">def</span> <span class="nf">make_genesis</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
        <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Alloc</span><span class="p">,</span> <span class="n">Bytes</span><span class="p">,</span> <span class="n">FixtureHeader</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a genesis block from the state test definition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genesis_environment</span><span class="o">.</span><span class="n">set_fork_requirements</span><span class="p">(</span><span class="n">fork</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;withdrawals must be empty at genesis&quot;</span>
        <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">beacon_root</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">Hash</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">beacon_root</span><span class="p">)</span> <span class="o">==</span> <span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;beacon_root must be empty at genesis&quot;</span>

        <span class="n">pre_alloc</span> <span class="o">=</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">fork</span><span class="o">.</span><span class="n">pre_allocation</span><span class="p">(</span><span class="n">block_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)))</span>
        <span class="n">new_alloc</span><span class="p">,</span> <span class="n">state_root</span> <span class="o">=</span> <span class="n">t8n</span><span class="o">.</span><span class="n">calc_state_root</span><span class="p">(</span>
            <span class="n">alloc</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">Alloc</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pre_alloc</span><span class="p">,</span> <span class="n">Alloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pre</span><span class="p">))),</span>
            <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
            <span class="n">debug_output_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_transition_tool_output_path</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">genesis</span> <span class="o">=</span> <span class="n">FixtureHeader</span><span class="p">(</span>
            <span class="n">parent_hash</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">ommers_hash</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyOmmersRoot</span><span class="p">),</span>
            <span class="n">coinbase</span><span class="o">=</span><span class="n">Address</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">state_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">state_root</span><span class="p">),</span>
            <span class="n">transactions_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyTrieRoot</span><span class="p">),</span>
            <span class="n">receipt_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyTrieRoot</span><span class="p">),</span>
            <span class="n">bloom</span><span class="o">=</span><span class="n">Bloom</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">difficulty</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">(</span><span class="mh">0x20000</span> <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">difficulty</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">env</span><span class="o">.</span><span class="n">difficulty</span><span class="p">),</span>
            <span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">gas_limit</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
            <span class="n">gas_used</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">extra_data</span><span class="o">=</span><span class="n">Bytes</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">mix_digest</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">nonce</span><span class="o">=</span><span class="n">HeaderNonce</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">base_fee</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">base_fee</span><span class="p">),</span>
            <span class="n">blob_gas_used</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">blob_gas_used</span><span class="p">),</span>
            <span class="n">excess_blob_gas</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">excess_blob_gas</span><span class="p">),</span>
            <span class="n">withdrawals_root</span><span class="o">=</span><span class="n">Hash</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span>
                <span class="n">withdrawals_root</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">)</span> <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">),</span>
            <span class="n">beacon_root</span><span class="o">=</span><span class="n">Hash</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">beacon_root</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">genesis_rlp</span><span class="p">,</span> <span class="n">genesis</span><span class="o">.</span><span class="n">hash</span> <span class="o">=</span> <span class="n">genesis</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
            <span class="n">txs</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">new_alloc</span><span class="p">),</span> <span class="n">genesis_rlp</span><span class="p">,</span> <span class="n">genesis</span>

    <span class="k">def</span> <span class="nf">make_block</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
        <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
        <span class="n">block</span><span class="p">:</span> <span class="n">Block</span><span class="p">,</span>
        <span class="n">previous_env</span><span class="p">:</span> <span class="n">Environment</span><span class="p">,</span>
        <span class="n">previous_alloc</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">previous_head</span><span class="p">:</span> <span class="n">Hash</span><span class="p">,</span>
        <span class="n">chain_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">eips</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">FixtureBlock</span><span class="p">,</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Hash</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produces a block based on the previous environment and allocation.</span>
<span class="sd">        If the block is an invalid block, the environment and allocation</span>
<span class="sd">        returned are the same as passed as parameters.</span>
<span class="sd">        Raises exception on invalid test behavior.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            FixtureBlock: Block to be appended to the fixture.</span>
<span class="sd">            Environment: Environment for the next block to produce.</span>
<span class="sd">                If the produced block is invalid, this is exactly the same</span>
<span class="sd">                environment as the one passed as parameter.</span>
<span class="sd">            Dict[str, Any]: Allocation for the next block to produce.</span>
<span class="sd">                If the produced block is invalid, this is exactly the same</span>
<span class="sd">                allocation as the one passed as parameter.</span>
<span class="sd">            str: Hash of the head of the chain, only updated if the produced</span>
<span class="sd">                block is not invalid.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">rlp</span> <span class="ow">and</span> <span class="n">block</span><span class="o">.</span><span class="n">exception</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;test correctness: post-state cannot be verified if the &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;block&#39;s rlp is supplied and the block is not supposed &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;to produce an exception&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">rlp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># This is the most common case, the RLP needs to be constructed</span>
            <span class="c1"># based on the transactions to be included in the block.</span>
            <span class="c1"># Set the environment according to the block to execute.</span>
            <span class="n">env</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">set_environment</span><span class="p">(</span><span class="n">previous_env</span><span class="p">)</span>
            <span class="n">env</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">set_fork_requirements</span><span class="p">(</span><span class="n">fork</span><span class="p">)</span>

            <span class="n">txs</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">[</span><span class="n">tx</span><span class="o">.</span><span class="n">with_signature_and_sender</span><span class="p">()</span> <span class="k">for</span> <span class="n">tx</span> <span class="ow">in</span> <span class="n">block</span><span class="o">.</span><span class="n">txs</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">txs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="p">[]</span>
            <span class="p">)</span>

            <span class="n">next_alloc</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">t8n</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
                <span class="n">alloc</span><span class="o">=</span><span class="n">previous_alloc</span><span class="p">,</span>
                <span class="n">txs</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">txs</span><span class="p">),</span>
                <span class="n">env</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">env</span><span class="p">),</span>
                <span class="n">fork_name</span><span class="o">=</span><span class="n">fork</span><span class="o">.</span><span class="n">fork</span><span class="p">(</span>
                    <span class="n">block_number</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">number</span><span class="p">),</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
                <span class="p">),</span>
                <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">,</span>
                <span class="n">reward</span><span class="o">=</span><span class="n">fork</span><span class="o">.</span><span class="n">get_reward</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">number</span><span class="p">),</span> <span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)),</span>
                <span class="n">eips</span><span class="o">=</span><span class="n">eips</span><span class="p">,</span>
                <span class="n">debug_output_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_transition_tool_output_path</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rejected_txs</span> <span class="o">=</span> <span class="n">verify_transactions</span><span class="p">(</span><span class="n">txs</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
                <span class="n">verify_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">print_traces</span><span class="p">(</span><span class="n">t8n</span><span class="o">.</span><span class="n">get_traces</span><span class="p">())</span>
                <span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="n">pprint</span><span class="p">(</span><span class="n">previous_alloc</span><span class="p">)</span>
                <span class="n">pprint</span><span class="p">(</span><span class="n">next_alloc</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">e</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rejected_txs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">block</span><span class="o">.</span><span class="n">exception</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">print_traces</span><span class="p">(</span><span class="n">t8n</span><span class="o">.</span><span class="n">get_traces</span><span class="p">())</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;one or more transactions in `BlockchainTest` are &quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;intrinsically invalid, but the block was not expected &quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;to be invalid. Please verify whether the transaction &quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;was indeed expected to fail and add the proper &quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;`block.exception`&quot;</span>
                <span class="p">)</span>
            <span class="n">env</span><span class="o">.</span><span class="n">extra_data</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">extra_data</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">FixtureHeader</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span>
                <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
                <span class="n">transition_tool_result</span><span class="o">=</span><span class="n">result</span><span class="p">,</span>
                <span class="n">environment</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">header_verify</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Verify the header after transition tool processing.</span>
                <span class="n">header</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">header_verify</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">rlp_modifier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Modify any parameter specified in the `rlp_modifier` after</span>
                <span class="c1"># transition tool processing.</span>
                <span class="n">header</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">rlp_modifier</span><span class="p">)</span>

            <span class="n">rlp</span><span class="p">,</span> <span class="n">header</span><span class="o">.</span><span class="n">hash</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
                <span class="n">txs</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
                <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">new_payload</span><span class="p">:</span> <span class="n">FixtureEngineNewPayload</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_test_config</span><span class="o">.</span><span class="n">disable_hive</span><span class="p">:</span>
                <span class="n">new_payload</span> <span class="o">=</span> <span class="n">FixtureEngineNewPayload</span><span class="o">.</span><span class="n">from_fixture_header</span><span class="p">(</span>
                    <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                    <span class="n">transactions</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
                    <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
                    <span class="n">error_code</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">engine_api_error_code</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">exception</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Return environment and allocation of the following block</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="n">FixtureBlock</span><span class="p">(</span>
                        <span class="n">rlp</span><span class="o">=</span><span class="n">rlp</span><span class="p">,</span>
                        <span class="n">new_payload</span><span class="o">=</span><span class="n">new_payload</span><span class="p">,</span>
                        <span class="n">block_header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                        <span class="n">block_number</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">number</span><span class="p">),</span>
                        <span class="n">txs</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
                        <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
                        <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">env</span><span class="o">.</span><span class="n">apply_new_parent</span><span class="p">(</span><span class="n">header</span><span class="p">),</span>
                    <span class="n">next_alloc</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">.</span><span class="n">hash</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="n">FixtureBlock</span><span class="p">(</span>
                        <span class="n">rlp</span><span class="o">=</span><span class="n">rlp</span><span class="p">,</span>
                        <span class="n">new_payload</span><span class="o">=</span><span class="n">new_payload</span><span class="p">,</span>
                        <span class="n">expected_exception</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">exception</span><span class="p">,</span>
                        <span class="n">block_number</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">number</span><span class="p">),</span>
                    <span class="p">),</span>
                    <span class="n">previous_env</span><span class="p">,</span>
                    <span class="n">previous_alloc</span><span class="p">,</span>
                    <span class="n">previous_head</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">FixtureBlock</span><span class="p">(</span>
                    <span class="n">rlp</span><span class="o">=</span><span class="n">Bytes</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">rlp</span><span class="p">),</span>
                    <span class="n">expected_exception</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">exception</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">previous_env</span><span class="p">,</span>
                <span class="n">previous_alloc</span><span class="p">,</span>
                <span class="n">previous_head</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">make_blocks</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
        <span class="n">genesis</span><span class="p">:</span> <span class="n">FixtureHeader</span><span class="p">,</span>
        <span class="n">pre</span><span class="p">:</span> <span class="n">Alloc</span><span class="p">,</span>
        <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
        <span class="n">chain_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">eips</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">FixtureBlock</span><span class="p">],</span> <span class="n">Hash</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a block list from the blockchain test definition.</span>
<span class="sd">        Performs checks against the expected behavior of the test.</span>
<span class="sd">        Raises exception on invalid test behavior.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">alloc</span> <span class="o">=</span> <span class="n">to_json</span><span class="p">(</span><span class="n">pre</span><span class="p">)</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="o">.</span><span class="n">from_parent_header</span><span class="p">(</span><span class="n">genesis</span><span class="p">)</span>
        <span class="n">blocks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FixtureBlock</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">genesis</span><span class="o">.</span><span class="n">hash</span> <span class="k">if</span> <span class="n">genesis</span><span class="o">.</span><span class="n">hash</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">:</span>
            <span class="n">fixture_block</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">alloc</span><span class="p">,</span> <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_block</span><span class="p">(</span>
                <span class="n">t8n</span><span class="o">=</span><span class="n">t8n</span><span class="p">,</span>
                <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
                <span class="n">block</span><span class="o">=</span><span class="n">block</span><span class="p">,</span>
                <span class="n">previous_env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
                <span class="n">previous_alloc</span><span class="o">=</span><span class="n">alloc</span><span class="p">,</span>
                <span class="n">previous_head</span><span class="o">=</span><span class="n">head</span><span class="p">,</span>
                <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">,</span>
                <span class="n">eips</span><span class="o">=</span><span class="n">eips</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fixture_block</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">verify_post_alloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="p">,</span> <span class="n">alloc</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">print_traces</span><span class="p">(</span><span class="n">t8n</span><span class="o">.</span><span class="n">get_traces</span><span class="p">())</span>
            <span class="k">raise</span> <span class="n">e</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">alloc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.BlockchainTest.pytest_parameter_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">pytest_parameter_name</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#ethereum_test_tools.BlockchainTest.pytest_parameter_name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the parameter name used to identify this filler in a test.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/spec/blockchain_test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">pytest_parameter_name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the parameter name used to identify this filler in a test.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;blockchain_test&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.BlockchainTest.make_genesis" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_genesis</span><span class="p">(</span><span class="n">t8n</span><span class="p">,</span> <span class="n">fork</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.BlockchainTest.make_genesis" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a genesis block from the state test definition.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/spec/blockchain_test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_genesis</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
    <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Alloc</span><span class="p">,</span> <span class="n">Bytes</span><span class="p">,</span> <span class="n">FixtureHeader</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a genesis block from the state test definition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genesis_environment</span><span class="o">.</span><span class="n">set_fork_requirements</span><span class="p">(</span><span class="n">fork</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;withdrawals must be empty at genesis&quot;</span>
    <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">beacon_root</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">Hash</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">beacon_root</span><span class="p">)</span> <span class="o">==</span> <span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="s2">&quot;beacon_root must be empty at genesis&quot;</span>

    <span class="n">pre_alloc</span> <span class="o">=</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">fork</span><span class="o">.</span><span class="n">pre_allocation</span><span class="p">(</span><span class="n">block_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)))</span>
    <span class="n">new_alloc</span><span class="p">,</span> <span class="n">state_root</span> <span class="o">=</span> <span class="n">t8n</span><span class="o">.</span><span class="n">calc_state_root</span><span class="p">(</span>
        <span class="n">alloc</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">Alloc</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pre_alloc</span><span class="p">,</span> <span class="n">Alloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pre</span><span class="p">))),</span>
        <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
        <span class="n">debug_output_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_transition_tool_output_path</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="n">genesis</span> <span class="o">=</span> <span class="n">FixtureHeader</span><span class="p">(</span>
        <span class="n">parent_hash</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">ommers_hash</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyOmmersRoot</span><span class="p">),</span>
        <span class="n">coinbase</span><span class="o">=</span><span class="n">Address</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">state_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">state_root</span><span class="p">),</span>
        <span class="n">transactions_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyTrieRoot</span><span class="p">),</span>
        <span class="n">receipt_root</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">EmptyTrieRoot</span><span class="p">),</span>
        <span class="n">bloom</span><span class="o">=</span><span class="n">Bloom</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">difficulty</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">(</span><span class="mh">0x20000</span> <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">difficulty</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">env</span><span class="o">.</span><span class="n">difficulty</span><span class="p">),</span>
        <span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">gas_limit</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
        <span class="n">gas_used</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">timestamp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">extra_data</span><span class="o">=</span><span class="n">Bytes</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">mix_digest</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">nonce</span><span class="o">=</span><span class="n">HeaderNonce</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="n">base_fee</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">base_fee</span><span class="p">),</span>
        <span class="n">blob_gas_used</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">blob_gas_used</span><span class="p">),</span>
        <span class="n">excess_blob_gas</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">excess_blob_gas</span><span class="p">),</span>
        <span class="n">withdrawals_root</span><span class="o">=</span><span class="n">Hash</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span>
            <span class="n">withdrawals_root</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">)</span> <span class="k">if</span> <span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">),</span>
        <span class="n">beacon_root</span><span class="o">=</span><span class="n">Hash</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">beacon_root</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">genesis_rlp</span><span class="p">,</span> <span class="n">genesis</span><span class="o">.</span><span class="n">hash</span> <span class="o">=</span> <span class="n">genesis</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
        <span class="n">txs</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">Alloc</span><span class="p">(</span><span class="n">new_alloc</span><span class="p">),</span> <span class="n">genesis_rlp</span><span class="p">,</span> <span class="n">genesis</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.BlockchainTest.make_block" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_block</span><span class="p">(</span><span class="n">t8n</span><span class="p">,</span> <span class="n">fork</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">previous_env</span><span class="p">,</span> <span class="n">previous_alloc</span><span class="p">,</span> <span class="n">previous_head</span><span class="p">,</span> <span class="n">chain_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eips</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.BlockchainTest.make_block" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Produces a block based on the previous environment and allocation.
If the block is an invalid block, the environment and allocation
returned are the same as passed as parameters.
Raises exception on invalid test behavior.</p>
<h5 id="ethereum_test_tools.BlockchainTest.make_block--returns">Returns<a class="headerlink" href="#ethereum_test_tools.BlockchainTest.make_block--returns" title="Permanent link">&para;</a></h5>
<div class="highlight"><pre><span></span><code>FixtureBlock: Block to be appended to the fixture.
Environment: Environment for the next block to produce.
    If the produced block is invalid, this is exactly the same
    environment as the one passed as parameter.
Dict[str, Any]: Allocation for the next block to produce.
    If the produced block is invalid, this is exactly the same
    allocation as the one passed as parameter.
str: Hash of the head of the chain, only updated if the produced
    block is not invalid.
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/spec/blockchain_test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_block</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
    <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
    <span class="n">block</span><span class="p">:</span> <span class="n">Block</span><span class="p">,</span>
    <span class="n">previous_env</span><span class="p">:</span> <span class="n">Environment</span><span class="p">,</span>
    <span class="n">previous_alloc</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">previous_head</span><span class="p">:</span> <span class="n">Hash</span><span class="p">,</span>
    <span class="n">chain_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">eips</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">FixtureBlock</span><span class="p">,</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Hash</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produces a block based on the previous environment and allocation.</span>
<span class="sd">    If the block is an invalid block, the environment and allocation</span>
<span class="sd">    returned are the same as passed as parameters.</span>
<span class="sd">    Raises exception on invalid test behavior.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        FixtureBlock: Block to be appended to the fixture.</span>
<span class="sd">        Environment: Environment for the next block to produce.</span>
<span class="sd">            If the produced block is invalid, this is exactly the same</span>
<span class="sd">            environment as the one passed as parameter.</span>
<span class="sd">        Dict[str, Any]: Allocation for the next block to produce.</span>
<span class="sd">            If the produced block is invalid, this is exactly the same</span>
<span class="sd">            allocation as the one passed as parameter.</span>
<span class="sd">        str: Hash of the head of the chain, only updated if the produced</span>
<span class="sd">            block is not invalid.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">rlp</span> <span class="ow">and</span> <span class="n">block</span><span class="o">.</span><span class="n">exception</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;test correctness: post-state cannot be verified if the &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;block&#39;s rlp is supplied and the block is not supposed &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;to produce an exception&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">rlp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># This is the most common case, the RLP needs to be constructed</span>
        <span class="c1"># based on the transactions to be included in the block.</span>
        <span class="c1"># Set the environment according to the block to execute.</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">set_environment</span><span class="p">(</span><span class="n">previous_env</span><span class="p">)</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">set_fork_requirements</span><span class="p">(</span><span class="n">fork</span><span class="p">)</span>

        <span class="n">txs</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[</span><span class="n">tx</span><span class="o">.</span><span class="n">with_signature_and_sender</span><span class="p">()</span> <span class="k">for</span> <span class="n">tx</span> <span class="ow">in</span> <span class="n">block</span><span class="o">.</span><span class="n">txs</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">txs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span>

        <span class="n">next_alloc</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">t8n</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
            <span class="n">alloc</span><span class="o">=</span><span class="n">previous_alloc</span><span class="p">,</span>
            <span class="n">txs</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">txs</span><span class="p">),</span>
            <span class="n">env</span><span class="o">=</span><span class="n">to_json</span><span class="p">(</span><span class="n">env</span><span class="p">),</span>
            <span class="n">fork_name</span><span class="o">=</span><span class="n">fork</span><span class="o">.</span><span class="n">fork</span><span class="p">(</span>
                <span class="n">block_number</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">number</span><span class="p">),</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
            <span class="p">),</span>
            <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">,</span>
            <span class="n">reward</span><span class="o">=</span><span class="n">fork</span><span class="o">.</span><span class="n">get_reward</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">number</span><span class="p">),</span> <span class="n">Number</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)),</span>
            <span class="n">eips</span><span class="o">=</span><span class="n">eips</span><span class="p">,</span>
            <span class="n">debug_output_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_transition_tool_output_path</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rejected_txs</span> <span class="o">=</span> <span class="n">verify_transactions</span><span class="p">(</span><span class="n">txs</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
            <span class="n">verify_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">env</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">print_traces</span><span class="p">(</span><span class="n">t8n</span><span class="o">.</span><span class="n">get_traces</span><span class="p">())</span>
            <span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="n">pprint</span><span class="p">(</span><span class="n">previous_alloc</span><span class="p">)</span>
            <span class="n">pprint</span><span class="p">(</span><span class="n">next_alloc</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rejected_txs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">block</span><span class="o">.</span><span class="n">exception</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">print_traces</span><span class="p">(</span><span class="n">t8n</span><span class="o">.</span><span class="n">get_traces</span><span class="p">())</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;one or more transactions in `BlockchainTest` are &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;intrinsically invalid, but the block was not expected &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;to be invalid. Please verify whether the transaction &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;was indeed expected to fail and add the proper &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;`block.exception`&quot;</span>
            <span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">extra_data</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">extra_data</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">FixtureHeader</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span>
            <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
            <span class="n">transition_tool_result</span><span class="o">=</span><span class="n">result</span><span class="p">,</span>
            <span class="n">environment</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">header_verify</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Verify the header after transition tool processing.</span>
            <span class="n">header</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">header_verify</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">rlp_modifier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Modify any parameter specified in the `rlp_modifier` after</span>
            <span class="c1"># transition tool processing.</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">rlp_modifier</span><span class="p">)</span>

        <span class="n">rlp</span><span class="p">,</span> <span class="n">header</span><span class="o">.</span><span class="n">hash</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
            <span class="n">txs</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
            <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">new_payload</span><span class="p">:</span> <span class="n">FixtureEngineNewPayload</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_test_config</span><span class="o">.</span><span class="n">disable_hive</span><span class="p">:</span>
            <span class="n">new_payload</span> <span class="o">=</span> <span class="n">FixtureEngineNewPayload</span><span class="o">.</span><span class="n">from_fixture_header</span><span class="p">(</span>
                <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                <span class="n">transactions</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
                <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
                <span class="n">error_code</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">engine_api_error_code</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">exception</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Return environment and allocation of the following block</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">FixtureBlock</span><span class="p">(</span>
                    <span class="n">rlp</span><span class="o">=</span><span class="n">rlp</span><span class="p">,</span>
                    <span class="n">new_payload</span><span class="o">=</span><span class="n">new_payload</span><span class="p">,</span>
                    <span class="n">block_header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                    <span class="n">block_number</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">number</span><span class="p">),</span>
                    <span class="n">txs</span><span class="o">=</span><span class="n">txs</span><span class="p">,</span>
                    <span class="n">ommers</span><span class="o">=</span><span class="p">[],</span>
                    <span class="n">withdrawals</span><span class="o">=</span><span class="n">env</span><span class="o">.</span><span class="n">withdrawals</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">env</span><span class="o">.</span><span class="n">apply_new_parent</span><span class="p">(</span><span class="n">header</span><span class="p">),</span>
                <span class="n">next_alloc</span><span class="p">,</span>
                <span class="n">header</span><span class="o">.</span><span class="n">hash</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">FixtureBlock</span><span class="p">(</span>
                    <span class="n">rlp</span><span class="o">=</span><span class="n">rlp</span><span class="p">,</span>
                    <span class="n">new_payload</span><span class="o">=</span><span class="n">new_payload</span><span class="p">,</span>
                    <span class="n">expected_exception</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">exception</span><span class="p">,</span>
                    <span class="n">block_number</span><span class="o">=</span><span class="n">Number</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">number</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">previous_env</span><span class="p">,</span>
                <span class="n">previous_alloc</span><span class="p">,</span>
                <span class="n">previous_head</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">FixtureBlock</span><span class="p">(</span>
                <span class="n">rlp</span><span class="o">=</span><span class="n">Bytes</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">rlp</span><span class="p">),</span>
                <span class="n">expected_exception</span><span class="o">=</span><span class="n">block</span><span class="o">.</span><span class="n">exception</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">previous_env</span><span class="p">,</span>
            <span class="n">previous_alloc</span><span class="p">,</span>
            <span class="n">previous_head</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.BlockchainTest.make_blocks" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_blocks</span><span class="p">(</span><span class="n">t8n</span><span class="p">,</span> <span class="n">genesis</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">fork</span><span class="p">,</span> <span class="n">chain_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eips</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.BlockchainTest.make_blocks" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a block list from the blockchain test definition.
Performs checks against the expected behavior of the test.
Raises exception on invalid test behavior.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/spec/blockchain_test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_blocks</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
    <span class="n">genesis</span><span class="p">:</span> <span class="n">FixtureHeader</span><span class="p">,</span>
    <span class="n">pre</span><span class="p">:</span> <span class="n">Alloc</span><span class="p">,</span>
    <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
    <span class="n">chain_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">eips</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">FixtureBlock</span><span class="p">],</span> <span class="n">Hash</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a block list from the blockchain test definition.</span>
<span class="sd">    Performs checks against the expected behavior of the test.</span>
<span class="sd">    Raises exception on invalid test behavior.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">alloc</span> <span class="o">=</span> <span class="n">to_json</span><span class="p">(</span><span class="n">pre</span><span class="p">)</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="o">.</span><span class="n">from_parent_header</span><span class="p">(</span><span class="n">genesis</span><span class="p">)</span>
    <span class="n">blocks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FixtureBlock</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">head</span> <span class="o">=</span> <span class="n">genesis</span><span class="o">.</span><span class="n">hash</span> <span class="k">if</span> <span class="n">genesis</span><span class="o">.</span><span class="n">hash</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Hash</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">:</span>
        <span class="n">fixture_block</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">alloc</span><span class="p">,</span> <span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_block</span><span class="p">(</span>
            <span class="n">t8n</span><span class="o">=</span><span class="n">t8n</span><span class="p">,</span>
            <span class="n">fork</span><span class="o">=</span><span class="n">fork</span><span class="p">,</span>
            <span class="n">block</span><span class="o">=</span><span class="n">block</span><span class="p">,</span>
            <span class="n">previous_env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
            <span class="n">previous_alloc</span><span class="o">=</span><span class="n">alloc</span><span class="p">,</span>
            <span class="n">previous_head</span><span class="o">=</span><span class="n">head</span><span class="p">,</span>
            <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">,</span>
            <span class="n">eips</span><span class="o">=</span><span class="n">eips</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fixture_block</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">verify_post_alloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">post</span><span class="p">,</span> <span class="n">alloc</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">print_traces</span><span class="p">(</span><span class="n">t8n</span><span class="o">.</span><span class="n">get_traces</span><span class="p">())</span>
        <span class="k">raise</span> <span class="n">e</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">alloc</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h2 id="ethereum_test_tools.compute_create2_address" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_create2_address</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">initcode</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.compute_create2_address" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Compute address of the resulting contract created using the <code>CREATE2</code>
opcode.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_create2_address</span><span class="p">(</span>
    <span class="n">address</span><span class="p">:</span> <span class="n">FixedSizeBytesConvertible</span><span class="p">,</span> <span class="n">salt</span><span class="p">:</span> <span class="n">FixedSizeBytesConvertible</span><span class="p">,</span> <span class="n">initcode</span><span class="p">:</span> <span class="n">BytesConvertible</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute address of the resulting contract created using the `CREATE2`</span>
<span class="sd">    opcode.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">hash</span> <span class="o">=</span> <span class="n">keccak256</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;</span><span class="se">\xff</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">Address</span><span class="p">(</span><span class="n">address</span><span class="p">)</span> <span class="o">+</span> <span class="n">Hash</span><span class="p">(</span><span class="n">salt</span><span class="p">)</span> <span class="o">+</span> <span class="n">keccak256</span><span class="p">(</span><span class="n">Bytes</span><span class="p">(</span><span class="n">initcode</span><span class="p">)))</span>
    <span class="k">return</span> <span class="s2">&quot;0x&quot;</span> <span class="o">+</span> <span class="nb">hash</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:]</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Yul" class="doc doc-heading">
          <code>Yul</code>


<a href="#ethereum_test_tools.Yul" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="typing.SupportsBytes">SupportsBytes</span></code>, <code><span title="typing.Sized">Sized</span></code></p>

  
      <p>Yul compiler.
Compiles Yul source code into bytecode.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/code/yul.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Yul</span><span class="p">(</span><span class="n">SupportsBytes</span><span class="p">,</span> <span class="n">Sized</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Yul compiler.</span>
<span class="sd">    Compiles Yul source code into bytecode.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">compiled</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">fork</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Fork</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">binary</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evm_version</span> <span class="o">=</span> <span class="n">get_evm_version_from_fork</span><span class="p">(</span><span class="n">fork</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">binary</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">which_path</span> <span class="o">=</span> <span class="n">which</span><span class="p">(</span><span class="s2">&quot;solc&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">which_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">binary</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">which_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">binary</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;`solc` binary executable not found, please refer to</span>
<span class="sd">                https://docs.soliditylang.org/en/latest/installing-solidity.html</span>
<span class="sd">                for help downloading and installing `solc`&quot;&quot;&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__bytes__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assembles using `solc --assemble`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compiled</span><span class="p">:</span>
            <span class="n">solc_args</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evm_version</span><span class="p">:</span>
                <span class="n">solc_args</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="p">,</span>
                    <span class="s2">&quot;--evm-version&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">evm_version</span><span class="p">,</span>
                    <span class="o">*</span><span class="n">DEFAULT_SOLC_ARGS</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">solc_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="p">,</span> <span class="o">*</span><span class="n">DEFAULT_SOLC_ARGS</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span>
                <span class="n">solc_args</span><span class="p">,</span>
                <span class="nb">input</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">),</span>
                <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span>
                <span class="n">stderr</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">stderr_lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">stderr_message</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">stderr_lines</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;failed to compile yul source:</span><span class="se">\n</span><span class="si">{</span><span class="n">stderr_message</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">hex_str</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">lines</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;Binary representation:&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">compiled</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">hex_str</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compiled</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the length of the Yul bytecode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Code</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds two code objects together, by converting both to bytes first.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Code</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Code</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds two code objects together, by converting both to bytes first.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Code</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">+</span> <span class="nb">bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Version</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return solc&#39;s version string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="p">,</span> <span class="s2">&quot;--version&quot;</span><span class="p">],</span>
            <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stderr</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">solc_output</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">version_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;Version: (.*)&quot;</span>
        <span class="n">solc_version_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">solc_output</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">match</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">version_pattern</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
                <span class="n">solc_version_string</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">solc_version_string</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Unable to determine solc version.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Version</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Sanitize</span>
        <span class="n">solc_version_string</span> <span class="o">=</span> <span class="n">solc_version_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;g++&quot;</span><span class="p">,</span> <span class="s2">&quot;gpp&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Version</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">solc_version_string</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Yul.__bytes__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__bytes__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Yul.__bytes__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Assembles using <code>solc --assemble</code>.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/yul.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__bytes__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assembles using `solc --assemble`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compiled</span><span class="p">:</span>
        <span class="n">solc_args</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evm_version</span><span class="p">:</span>
            <span class="n">solc_args</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="p">,</span>
                <span class="s2">&quot;--evm-version&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">evm_version</span><span class="p">,</span>
                <span class="o">*</span><span class="n">DEFAULT_SOLC_ARGS</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">solc_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="p">,</span> <span class="o">*</span><span class="n">DEFAULT_SOLC_ARGS</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span>
            <span class="n">solc_args</span><span class="p">,</span>
            <span class="nb">input</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">),</span>
            <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span>
            <span class="n">stderr</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">stderr_lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">stderr_message</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">stderr_lines</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;failed to compile yul source:</span><span class="se">\n</span><span class="si">{</span><span class="n">stderr_message</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">hex_str</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">lines</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;Binary representation:&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">compiled</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">hex_str</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compiled</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Yul.__len__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Yul.__len__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get the length of the Yul bytecode.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/yul.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the length of the Yul bytecode.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Yul.__add__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Yul.__add__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Adds two code objects together, by converting both to bytes first.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/yul.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Code</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds two code objects together, by converting both to bytes first.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Code</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Yul.__radd__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__radd__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Yul.__radd__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Adds two code objects together, by converting both to bytes first.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/yul.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Code</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds two code objects together, by converting both to bytes first.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Code</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">+</span> <span class="nb">bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Yul.version" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">version</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Yul.version" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Return solc's version string</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/yul.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Version</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return solc&#39;s version string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="p">,</span> <span class="s2">&quot;--version&quot;</span><span class="p">],</span>
        <span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span>
        <span class="n">stderr</span><span class="o">=</span><span class="n">PIPE</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">solc_output</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">version_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;Version: (.*)&quot;</span>
    <span class="n">solc_version_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">solc_output</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">match</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">version_pattern</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
            <span class="n">solc_version_string</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">solc_version_string</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Unable to determine solc version.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Version</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># Sanitize</span>
    <span class="n">solc_version_string</span> <span class="o">=</span> <span class="n">solc_version_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;g++&quot;</span><span class="p">,</span> <span class="s2">&quot;gpp&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Version</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">solc_version_string</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h2 id="ethereum_test_tools.cost_memory_bytes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cost_memory_bytes</span><span class="p">(</span><span class="n">new_bytes</span><span class="p">,</span> <span class="n">previous_bytes</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.cost_memory_bytes" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the cost of memory expansion, based on the costs specified in
the yellow paper: <a href="https://ethereum.github.io/yellowpaper/paper.pdf">https://ethereum.github.io/yellowpaper/paper.pdf</a></p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cost_memory_bytes</span><span class="p">(</span><span class="n">new_bytes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">previous_bytes</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the cost of memory expansion, based on the costs specified in</span>
<span class="sd">    the yellow paper: https://ethereum.github.io/yellowpaper/paper.pdf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">new_bytes</span> <span class="o">&lt;=</span> <span class="n">previous_bytes</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">new_words</span> <span class="o">=</span> <span class="n">ceiling_division</span><span class="p">(</span><span class="n">new_bytes</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">previous_words</span> <span class="o">=</span> <span class="n">ceiling_division</span><span class="p">(</span><span class="n">previous_bytes</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">c</span><span class="p">(</span><span class="n">w</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">g_memory</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">g_memory</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">w</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span> <span class="o">//</span> <span class="mi">512</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">c</span><span class="p">(</span><span class="n">new_words</span><span class="p">)</span> <span class="o">-</span> <span class="n">c</span><span class="p">(</span><span class="n">previous_words</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Removable" class="doc doc-heading">
          <code>Removable</code>


<a href="#ethereum_test_tools.Removable" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Sentinel class to detect if a parameter should be removed.
(<code>None</code> normally means "do not modify")</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Removable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sentinel class to detect if a parameter should be removed.</span>
<span class="sd">    (`None` normally means &quot;do not modify&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Auto" class="doc doc-heading">
          <code>Auto</code>


<a href="#ethereum_test_tools.Auto" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Class to use as a sentinel value for parameters that should be
automatically calculated.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Auto</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to use as a sentinel value for parameters that should be</span>
<span class="sd">    automatically calculated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the correct test id.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;auto&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Auto.__repr__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Auto.__repr__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Print the correct test id.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the correct test id.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;auto&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h2 id="ethereum_test_tools.copy_opcode_cost" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">copy_opcode_cost</span><span class="p">(</span><span class="n">length</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.copy_opcode_cost" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the cost of the COPY opcodes, assuming memory expansion from
empty memory, based on the costs specified in the yellow paper:
<a href="https://ethereum.github.io/yellowpaper/paper.pdf">https://ethereum.github.io/yellowpaper/paper.pdf</a></p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy_opcode_cost</span><span class="p">(</span><span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the cost of the COPY opcodes, assuming memory expansion from</span>
<span class="sd">    empty memory, based on the costs specified in the yellow paper:</span>
<span class="sd">    https://ethereum.github.io/yellowpaper/paper.pdf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">ceiling_division</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">cost_memory_bytes</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h2 id="ethereum_test_tools.eip_2028_transaction_data_cost" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">eip_2028_transaction_data_cost</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.eip_2028_transaction_data_cost" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the cost of a given data as part of a transaction, based on the
costs specified in EIP-2028: <a href="https://eips.ethereum.org/EIPS/eip-2028">https://eips.ethereum.org/EIPS/eip-2028</a></p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">eip_2028_transaction_data_cost</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">BytesConvertible</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the cost of a given data as part of a transaction, based on the</span>
<span class="sd">    costs specified in EIP-2028: https://eips.ethereum.org/EIPS/eip-2028</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">Bytes</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cost</span> <span class="o">+=</span> <span class="mi">4</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cost</span> <span class="o">+=</span> <span class="mi">16</span>
    <span class="k">return</span> <span class="n">cost</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.BaseTestConfig" class="doc doc-heading">
          <code>BaseTestConfig</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.BaseTestConfig" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>General configuration that all tests must support.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/spec/base_test.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">BaseTestConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    General configuration that all tests must support.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">disable_hive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Disable any hive-related properties that the output could contain.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.BaseTestConfig.disable_hive" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">disable_hive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.BaseTestConfig.disable_hive" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Disable any hive-related properties that the output could contain.</p>
  </div>

</div>




  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h2 id="ethereum_test_tools.to_address" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_address</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.to_address" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Converts an int or str into proper address 20-byte hex string.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_address</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="n">FixedSizeBytesConvertible</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts an int or str into proper address 20-byte hex string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">Address</span><span class="p">(</span><span class="nb">input</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h2 id="ethereum_test_tools.to_hash_bytes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_hash_bytes</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.to_hash_bytes" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Converts an int or str into proper 32-byte hash.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_hash_bytes</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="n">FixedSizeBytesConvertible</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts an int or str into proper 32-byte hash.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">Hash</span><span class="p">(</span><span class="nb">input</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.BaseTest" class="doc doc-heading">
          <code>BaseTest</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.BaseTest" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Represents a base Ethereum test which must return a genesis and a
blockchain.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/spec/base_test.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">BaseTest</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a base Ethereum test which must return a genesis and a</span>
<span class="sd">    blockchain.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pre</span><span class="p">:</span> <span class="n">Mapping</span>
    <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">base_test_config</span><span class="p">:</span> <span class="n">BaseTestConfig</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">BaseTestConfig</span><span class="p">)</span>

    <span class="c1"># Transition tool specific fields</span>
    <span class="n">t8n_dump_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">t8n_call_counter</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default_factory</span><span class="o">=</span><span class="n">count</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">make_genesis</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
        <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Alloc</span><span class="p">,</span> <span class="n">Bytes</span><span class="p">,</span> <span class="n">FixtureHeader</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a genesis block from the test definition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">make_blocks</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
        <span class="n">genesis</span><span class="p">:</span> <span class="n">FixtureHeader</span><span class="p">,</span>
        <span class="n">pre</span><span class="p">:</span> <span class="n">Alloc</span><span class="p">,</span>
        <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
        <span class="n">chain_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">eips</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">FixtureBlock</span><span class="p">],</span> <span class="n">Hash</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate the blockchain that must be executed sequentially during test.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">pytest_parameter_name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Must return the name of the parameter used in pytest to select this</span>
<span class="sd">        spec type as filler for the test.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">get_next_transition_tool_output_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the path to the next transition tool output file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">t8n_dump_dir</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t8n_dump_dir</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t8n_call_counter</span><span class="p">)),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.BaseTest.make_genesis" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_genesis</span><span class="p">(</span><span class="n">t8n</span><span class="p">,</span> <span class="n">fork</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#ethereum_test_tools.BaseTest.make_genesis" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a genesis block from the test definition.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/spec/base_test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">make_genesis</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
    <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Alloc</span><span class="p">,</span> <span class="n">Bytes</span><span class="p">,</span> <span class="n">FixtureHeader</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a genesis block from the test definition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.BaseTest.make_blocks" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">make_blocks</span><span class="p">(</span><span class="n">t8n</span><span class="p">,</span> <span class="n">genesis</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">fork</span><span class="p">,</span> <span class="n">chain_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eips</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#ethereum_test_tools.BaseTest.make_blocks" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Generate the blockchain that must be executed sequentially during test.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/spec/base_test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">make_blocks</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
    <span class="n">genesis</span><span class="p">:</span> <span class="n">FixtureHeader</span><span class="p">,</span>
    <span class="n">pre</span><span class="p">:</span> <span class="n">Alloc</span><span class="p">,</span>
    <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
    <span class="n">chain_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">eips</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">FixtureBlock</span><span class="p">],</span> <span class="n">Hash</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the blockchain that must be executed sequentially during test.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.BaseTest.pytest_parameter_name" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">pytest_parameter_name</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#ethereum_test_tools.BaseTest.pytest_parameter_name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Must return the name of the parameter used in pytest to select this
spec type as filler for the test.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/spec/base_test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">pytest_parameter_name</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Must return the name of the parameter used in pytest to select this</span>
<span class="sd">    spec type as filler for the test.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.BaseTest.get_next_transition_tool_output_path" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_next_transition_tool_output_path</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.BaseTest.get_next_transition_tool_output_path" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the path to the next transition tool output file.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/spec/base_test.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_next_transition_tool_output_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the path to the next transition tool output file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">t8n_dump_dir</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t8n_dump_dir</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t8n_call_counter</span><span class="p">)),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h2 id="ethereum_test_tools.to_hash" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_hash</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.to_hash" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Converts an int or str into proper 32-byte hash hex string.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_hash</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="n">FixedSizeBytesConvertible</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts an int or str into proper 32-byte hash hex string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">Hash</span><span class="p">(</span><span class="nb">input</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h2 id="ethereum_test_tools.add_kzg_version" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_kzg_version</span><span class="p">(</span><span class="n">b_hashes</span><span class="p">,</span> <span class="n">kzg_version</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.add_kzg_version" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Adds the Kzg Version to each blob hash.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/helpers.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_kzg_version</span><span class="p">(</span>
    <span class="n">b_hashes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span> <span class="n">kzg_version</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds the Kzg Version to each blob hash.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kzg_version_hex</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">kzg_version</span><span class="p">])</span>
    <span class="n">kzg_versioned_hashes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="nb">hash</span> <span class="ow">in</span> <span class="n">b_hashes</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">kzg_versioned_hashes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kzg_version_hex</span> <span class="o">+</span> <span class="n">to_hash_bytes</span><span class="p">(</span><span class="nb">hash</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="n">SupportsBytes</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="n">SupportsBytes</span><span class="p">):</span>
                <span class="nb">hash</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="nb">hash</span><span class="p">)</span>
            <span class="n">kzg_versioned_hashes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kzg_version_hex</span> <span class="o">+</span> <span class="nb">hash</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Blob hash must be either an integer, string or bytes&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kzg_versioned_hashes</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.CodeGasMeasure" class="doc doc-heading">
          <code>CodeGasMeasure</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.CodeGasMeasure" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="ethereum_test_tools.code.code.Code" href="#ethereum_test_tools.Code">Code</a></code></p>

  
      <p>Helper class used to generate bytecode that measures gas usage of a
bytecode, taking into account and subtracting any extra overhead gas costs
required to execute.
By default, the result gas calculation is saved to storage key 0.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">CodeGasMeasure</span><span class="p">(</span><span class="n">Code</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper class used to generate bytecode that measures gas usage of a</span>
<span class="sd">    bytecode, taking into account and subtracting any extra overhead gas costs</span>
<span class="sd">    required to execute.</span>
<span class="sd">    By default, the result gas calculation is saved to storage key 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bytecode to be executed to measure the gas usage.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">overhead_cost</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extra gas cost to be subtracted from extra operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">extra_stack_items</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extra stack items that remain at the end of the execution.</span>
<span class="sd">    To be considered when subtracting the value of the previous GAS operation,</span>
<span class="sd">    and to be popped at the end of the execution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sstore_key</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Storage key to save the gas used.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assemble the bytecode that measures gas usage.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="mh">0x5A</span><span class="p">,</span>  <span class="c1"># GAS</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>  <span class="c1"># Execute code to measure its gas cost</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="mh">0x5A</span><span class="p">,</span>  <span class="c1"># GAS</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="c1"># We need to swap and pop for each extra stack item that remained from</span>
        <span class="c1"># the execution of the code</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="nb">bytes</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
                    <span class="mh">0x50</span><span class="p">,</span>  <span class="c1"># POP</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_stack_items</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
                <span class="mh">0x03</span><span class="p">,</span>  <span class="c1"># SUB</span>
                <span class="mh">0x60</span><span class="p">,</span>  <span class="c1"># PUSH1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">overhead_cost</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Overhead cost + GAS opcode price</span>
                <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
                <span class="mh">0x03</span><span class="p">,</span>  <span class="c1"># SUB</span>
                <span class="mh">0x60</span><span class="p">,</span>  <span class="c1"># PUSH1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sstore_key</span><span class="p">,</span>  <span class="c1"># -&gt; SSTORE key</span>
                <span class="mh">0x55</span><span class="p">,</span>  <span class="c1"># SSTORE</span>
                <span class="mh">0x00</span><span class="p">,</span>  <span class="c1"># STOP</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.CodeGasMeasure.code" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.CodeGasMeasure.code" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Bytecode to be executed to measure the gas usage.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.CodeGasMeasure.overhead_cost" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">overhead_cost</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.CodeGasMeasure.overhead_cost" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Extra gas cost to be subtracted from extra operations.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.CodeGasMeasure.extra_stack_items" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">extra_stack_items</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.CodeGasMeasure.extra_stack_items" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Extra stack items that remain at the end of the execution.
To be considered when subtracting the value of the previous GAS operation,
and to be popped at the end of the execution.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.CodeGasMeasure.sstore_key" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sstore_key</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.CodeGasMeasure.sstore_key" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Storage key to save the gas used.</p>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.CodeGasMeasure.__post_init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.CodeGasMeasure.__post_init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Assemble the bytecode that measures gas usage.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assemble the bytecode that measures gas usage.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="mh">0x5A</span><span class="p">,</span>  <span class="c1"># GAS</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>  <span class="c1"># Execute code to measure its gas cost</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="mh">0x5A</span><span class="p">,</span>  <span class="c1"># GAS</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="c1"># We need to swap and pop for each extra stack item that remained from</span>
    <span class="c1"># the execution of the code</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span>
        <span class="nb">bytes</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
                <span class="mh">0x50</span><span class="p">,</span>  <span class="c1"># POP</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_stack_items</span>
    <span class="p">)</span>
    <span class="n">res</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
            <span class="mh">0x03</span><span class="p">,</span>  <span class="c1"># SUB</span>
            <span class="mh">0x60</span><span class="p">,</span>  <span class="c1"># PUSH1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overhead_cost</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Overhead cost + GAS opcode price</span>
            <span class="mh">0x90</span><span class="p">,</span>  <span class="c1"># SWAP1</span>
            <span class="mh">0x03</span><span class="p">,</span>  <span class="c1"># SUB</span>
            <span class="mh">0x60</span><span class="p">,</span>  <span class="c1"># PUSH1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sstore_key</span><span class="p">,</span>  <span class="c1"># -&gt; SSTORE key</span>
            <span class="mh">0x55</span><span class="p">,</span>  <span class="c1"># SSTORE</span>
            <span class="mh">0x00</span><span class="p">,</span>  <span class="c1"># STOP</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Opcodes" class="doc doc-heading">
          <code>Opcodes</code>


<a href="#ethereum_test_tools.Opcodes" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="ethereum_test_tools.vm.opcode.Opcode" href="#ethereum_test_tools.Opcode">Opcode</a></code>, <code><span title="enum.Enum">Enum</span></code></p>

  
      <p>Enum containing all known opcodes.</p>
<p>Contains deprecated and not yet implemented opcodes.</p>
<p>This enum is !! NOT !! meant to be iterated over by the tests. Instead,
create a list with cherry-picked opcodes from this Enum within the test
if iteration is needed.</p>
<p>Do !! NOT !! remove or modify existing opcodes from this list.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/vm/opcode.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Opcodes</span><span class="p">(</span><span class="n">Opcode</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enum containing all known opcodes.</span>

<span class="sd">    Contains deprecated and not yet implemented opcodes.</span>

<span class="sd">    This enum is !! NOT !! meant to be iterated over by the tests. Instead,</span>
<span class="sd">    create a list with cherry-picked opcodes from this Enum within the test</span>
<span class="sd">    if iteration is needed.</span>

<span class="sd">    Do !! NOT !! remove or modify existing opcodes from this list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">STOP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x00</span><span class="p">)</span>
    <span class="n">ADD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x01</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MUL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x02</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SUB</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x03</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">DIV</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x04</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SDIV</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x05</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MOD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x06</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SMOD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x07</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ADDMOD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x08</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MULMOD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x09</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">EXP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x0A</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SIGNEXTEND</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x0B</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">LT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x10</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">GT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x11</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SLT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x12</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SGT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x13</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">EQ</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x14</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ISZERO</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x15</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">AND</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x16</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">OR</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x17</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">XOR</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x18</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">NOT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x19</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">BYTE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x1A</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SHL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x1B</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SHR</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x1C</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SAR</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x1D</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">SHA3</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x20</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">ADDRESS</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x30</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">BALANCE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x31</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ORIGIN</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x32</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLER</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x33</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLVALUE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x34</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLDATALOAD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x35</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLDATASIZE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x36</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLDATACOPY</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x37</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">CODESIZE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x38</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CODECOPY</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x39</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">GASPRICE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3A</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">EXTCODESIZE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3B</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">EXTCODECOPY</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3C</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">RETURNDATASIZE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3D</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">RETURNDATACOPY</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3E</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">EXTCODEHASH</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x3F</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">BLOCKHASH</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x40</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">COINBASE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x41</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">TIMESTAMP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x42</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">NUMBER</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x43</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">PREVRANDAO</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x44</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">GASLIMIT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x45</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CHAINID</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x46</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SELFBALANCE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x47</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">BASEFEE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x48</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">BLOBHASH</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x49</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">POP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x50</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MLOAD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x51</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MSTORE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x52</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">MSTORE8</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x53</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">SLOAD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x54</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SSTORE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x55</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">JUMP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x56</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">JUMPI</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x57</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">PC</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x58</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">MSIZE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x59</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">GAS</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5A</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">JUMPDEST</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5B</span><span class="p">)</span>
    <span class="n">TLOAD</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5C</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">TSTORE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5D</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">MCOPY</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5E</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">RETF</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x49</span><span class="p">)</span>

    <span class="n">PUSH0</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x5F</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">PUSH1</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x60</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">PUSH2</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x61</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">PUSH3</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x62</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">PUSH4</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x63</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">PUSH5</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x64</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">PUSH6</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x65</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">PUSH7</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x66</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">PUSH8</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x67</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">PUSH9</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x68</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">PUSH10</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x69</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">PUSH11</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6A</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">PUSH12</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6B</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">PUSH13</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6C</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">PUSH14</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6D</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">PUSH15</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6E</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">PUSH16</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x6F</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">PUSH17</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x70</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
    <span class="n">PUSH18</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x71</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">PUSH19</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x72</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
    <span class="n">PUSH20</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x73</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">PUSH21</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x74</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
    <span class="n">PUSH22</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x75</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">PUSH23</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x76</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
    <span class="n">PUSH24</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x77</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
    <span class="n">PUSH25</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x78</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">PUSH26</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x79</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
    <span class="n">PUSH27</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7A</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="n">PUSH28</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7B</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">28</span><span class="p">)</span>
    <span class="n">PUSH29</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7C</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">29</span><span class="p">)</span>
    <span class="n">PUSH30</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7D</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">PUSH31</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7E</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">31</span><span class="p">)</span>
    <span class="n">PUSH32</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x7F</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

    <span class="n">DUP1</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x80</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">DUP2</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x81</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">DUP3</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x82</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">DUP4</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x83</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">DUP5</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x84</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">DUP6</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x85</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">DUP7</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x86</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">DUP8</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x87</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">DUP9</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x88</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">DUP10</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x89</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">DUP11</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8A</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">DUP12</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8B</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">DUP13</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8C</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">DUP14</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8D</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">DUP15</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8E</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">DUP16</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x8F</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">SWAP1</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x90</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">SWAP2</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x91</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">SWAP3</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x92</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">SWAP4</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x93</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">SWAP5</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x94</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">SWAP6</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x95</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">SWAP7</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x96</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">SWAP8</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x97</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">SWAP9</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x98</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">SWAP10</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x99</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">SWAP11</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9A</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">SWAP12</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9B</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">SWAP13</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9C</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">SWAP14</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9D</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">SWAP15</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9E</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">SWAP16</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0x9F</span><span class="p">,</span> <span class="n">min_stack_height</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

    <span class="n">LOG0</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xA0</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">LOG1</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xA1</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">LOG2</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xA2</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">LOG3</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xA3</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">LOG4</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xA4</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

    <span class="n">RJUMP</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xE0</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">RJUMPI</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xE1</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_portion_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">RJUMPV</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xE2</span><span class="p">)</span>

    <span class="n">CREATE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF0</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF1</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CALLCODE</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF2</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">RETURN</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF3</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">DELEGATECALL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF4</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">CREATE2</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xF5</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">STATICCALL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xFA</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">pushed_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">REVERT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xFD</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">INVALID</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xFE</span><span class="p">)</span>

    <span class="n">SELFDESTRUCT</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SENDALL</span> <span class="o">=</span> <span class="n">Opcode</span><span class="p">(</span><span class="mh">0xFF</span><span class="p">,</span> <span class="n">popped_stack_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">





  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Conditional" class="doc doc-heading">
          <code>Conditional</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.Conditional" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="ethereum_test_tools.code.code.Code" href="#ethereum_test_tools.Code">Code</a></code></p>

  
      <p>Helper class used to generate conditional bytecode.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Conditional</span><span class="p">(</span><span class="n">Code</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper class used to generate conditional bytecode.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">condition</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Condition bytecode which must return the true or false condition of the conditional statement.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">if_true</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bytecode to execute if the condition is true.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">if_false</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bytecode to execute if the condition is false.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assemble the conditional bytecode by generating the necessary jump and</span>
<span class="sd">        jumpdest opcodes surrounding the condition and the two possible execution</span>
<span class="sd">        paths.</span>

<span class="sd">        In the future, PC usage should be replaced by using RJUMP and RJUMPI</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">condition_bytes</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">)</span>
        <span class="n">if_true_bytes</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">if_true</span><span class="p">)</span>
        <span class="n">if_false_bytes</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">if_false</span><span class="p">)</span>

        <span class="c1"># First we append a jumpdest to the start of the true branch</span>
        <span class="n">if_true_bytes</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPDEST</span> <span class="o">+</span> <span class="n">if_true_bytes</span>

        <span class="c1"># Then we append the unconditional jump to the end of the false branch, used to skip the</span>
        <span class="c1"># true branch</span>
        <span class="n">if_false_bytes</span> <span class="o">+=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMP</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">ADD</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">if_true_bytes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">))</span>

        <span class="c1"># Then we need to do the conditional jump by skipping the false branch</span>
        <span class="n">condition_bytes</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPI</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">ADD</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">if_false_bytes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span> <span class="n">condition_bytes</span><span class="p">)</span>

        <span class="c1"># Finally we append the true and false branches, and the condition, plus the jumpdest at</span>
        <span class="c1"># the very end</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">condition_bytes</span> <span class="o">+</span> <span class="n">if_false_bytes</span> <span class="o">+</span> <span class="n">if_true_bytes</span> <span class="o">+</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPDEST</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Conditional.condition" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">condition</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Conditional.condition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Condition bytecode which must return the true or false condition of the conditional statement.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Conditional.if_true" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">if_true</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Conditional.if_true" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Bytecode to execute if the condition is true.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Conditional.if_false" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">if_false</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Conditional.if_false" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Bytecode to execute if the condition is false.</p>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Conditional.__post_init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Conditional.__post_init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Assemble the conditional bytecode by generating the necessary jump and
jumpdest opcodes surrounding the condition and the two possible execution
paths.</p>
<p>In the future, PC usage should be replaced by using RJUMP and RJUMPI</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assemble the conditional bytecode by generating the necessary jump and</span>
<span class="sd">    jumpdest opcodes surrounding the condition and the two possible execution</span>
<span class="sd">    paths.</span>

<span class="sd">    In the future, PC usage should be replaced by using RJUMP and RJUMPI</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">condition_bytes</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">)</span>
    <span class="n">if_true_bytes</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">if_true</span><span class="p">)</span>
    <span class="n">if_false_bytes</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">if_false</span><span class="p">)</span>

    <span class="c1"># First we append a jumpdest to the start of the true branch</span>
    <span class="n">if_true_bytes</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPDEST</span> <span class="o">+</span> <span class="n">if_true_bytes</span>

    <span class="c1"># Then we append the unconditional jump to the end of the false branch, used to skip the</span>
    <span class="c1"># true branch</span>
    <span class="n">if_false_bytes</span> <span class="o">+=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMP</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">ADD</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">if_true_bytes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">))</span>

    <span class="c1"># Then we need to do the conditional jump by skipping the false branch</span>
    <span class="n">condition_bytes</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPI</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">ADD</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">if_false_bytes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span> <span class="n">condition_bytes</span><span class="p">)</span>

    <span class="c1"># Finally we append the true and false branches, and the condition, plus the jumpdest at</span>
    <span class="c1"># the very end</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">condition_bytes</span> <span class="o">+</span> <span class="n">if_false_bytes</span> <span class="o">+</span> <span class="n">if_true_bytes</span> <span class="o">+</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPDEST</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Case" class="doc doc-heading">
          <code>Case</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.Case" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Small helper class to represent a single, generic case in a <code>Switch</code> cases
list.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Case</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Small helper class to represent a single, generic case in a `Switch` cases</span>
<span class="sd">    list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">condition</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span>
    <span class="n">action</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ensure that the condition and action are of type bytes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Case.__post_init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Case.__post_init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Ensure that the condition and action are of type bytes.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensure that the condition and action are of type bytes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Storage" class="doc doc-heading">
          <code>Storage</code>


<a href="#ethereum_test_tools.Storage" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="ethereum_test_tools.common.json.SupportsJSON">SupportsJSON</span></code></p>

  
      <p>Definition of a storage in pre or post state of a test</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Storage</span><span class="p">(</span><span class="n">SupportsJSON</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Definition of a storage in pre or post state of a test</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>

    <span class="n">current_slot</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>

    <span class="n">StorageDictType</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">TypeAlias</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span>
        <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span>
    <span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dictionary type to be used when defining an input to initialize a storage.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">InvalidType</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalid type used when describing test&#39;s expected storage key or value.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">key_or_value</span><span class="p">:</span> <span class="n">Any</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_or_value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_or_value</span> <span class="o">=</span> <span class="n">key_or_value</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;invalid type for key/value: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_or_value</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">class</span> <span class="nc">InvalidValue</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Invalid value used when describing test&#39;s expected storage key or</span>
<span class="sd">        value.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">key_or_value</span><span class="p">:</span> <span class="n">Any</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_or_value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_or_value</span> <span class="o">=</span> <span class="n">key_or_value</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;invalid value for key/value: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_or_value</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">class</span> <span class="nc">AmbiguousKeyValue</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Key is represented twice in the storage.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">key_1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span>
        <span class="n">val_1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span>
        <span class="n">key_2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span>
        <span class="n">val_2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">key_1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">val_1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">key_2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">val_2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_1</span> <span class="o">=</span> <span class="n">key_1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">val_1</span> <span class="o">=</span> <span class="n">val_1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_2</span> <span class="o">=</span> <span class="n">key_2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">val_2</span> <span class="o">=</span> <span class="n">val_2</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            Key is represented twice (due to negative numbers) with different</span>
<span class="s2">            values in storage:</span>
<span class="s2">            s[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_1</span><span class="si">}</span><span class="s2">] = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">val_1</span><span class="si">}</span><span class="s2"> and s[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_2</span><span class="si">}</span><span class="s2">] = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">val_2</span><span class="si">}</span>
<span class="s2">            &quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">MissingKey</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test expected to find a storage key set but key was missing.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">key</span><span class="p">:</span> <span class="nb">int</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="s2">&quot;key </span><span class="si">{0}</span><span class="s2"> not found in storage&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">))</span>

    <span class="k">class</span> <span class="nc">KeyValueMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test expected a certain value in a storage key but value found</span>
<span class="sd">        was different.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">int</span>
        <span class="n">want</span><span class="p">:</span> <span class="nb">int</span>
        <span class="n">got</span><span class="p">:</span> <span class="nb">int</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;incorrect value in address </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2"> for &quot;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;key </span><span class="si">{</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2">:&quot;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; want </span><span class="si">{</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="p">)</span><span class="si">}</span><span class="s2"> (dec:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">),&quot;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; got </span><span class="si">{</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="p">)</span><span class="si">}</span><span class="s2"> (dec:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse_key_value</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses a key or value to a valid int key for storage.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="nb">input</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">SupportsBytes</span><span class="p">):</span>
            <span class="nb">input</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="nb">input</span><span class="p">),</span> <span class="s2">&quot;big&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">InvalidType</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">input</span> <span class="o">&gt;</span> <span class="n">MAX_STORAGE_KEY_VALUE</span> <span class="ow">or</span> <span class="nb">input</span> <span class="o">&lt;</span> <span class="n">MIN_STORAGE_KEY_VALUE</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">InvalidValue</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">input</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">key_value_to_string</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transforms a key or value into an hex string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hex_str</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;big&quot;</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="p">(</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hex_str</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">hex_str</span> <span class="o">=</span> <span class="s2">&quot;00&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hex_str</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hex_str</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="n">hex_str</span>
        <span class="k">return</span> <span class="s2">&quot;0x&quot;</span> <span class="o">+</span> <span class="n">hex_str</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="n">StorageDictType</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">start_slot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the storage using a given mapping which can have</span>
<span class="sd">        keys and values either as string or int.</span>
<span class="sd">        Strings must be valid decimal or hexadecimal (starting with 0x)</span>
<span class="sd">        numbers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="nb">input</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_slot</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="n">start_slot</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns number of elements in the storage&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks for an item in the storage&quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns an item from the storage&quot;&quot;&quot;</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">):</span>  <span class="c1"># noqa: SC200</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets an item in the storage&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes an item from the storage&quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">store_next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stores a value in the storage and returns the key where the value is stored.</span>

<span class="sd">        Increments the key counter so the next time this function is called,</span>
<span class="sd">        the next key is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">slot</span> <span class="o">:=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_slot</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="n">slot</span>

    <span class="k">def</span> <span class="nf">__json__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">JSONEncoder</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the storage into a string dict with appropriate 32-byte</span>
<span class="sd">        hex string formatting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">key_repr</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">val_repr</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">key_repr</span> <span class="ow">in</span> <span class="n">res</span> <span class="ow">and</span> <span class="n">val_repr</span> <span class="o">!=</span> <span class="n">res</span><span class="p">[</span><span class="n">key_repr</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">AmbiguousKeyValue</span><span class="p">(</span><span class="n">key_repr</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="n">key_repr</span><span class="p">],</span> <span class="n">key</span><span class="p">,</span> <span class="n">val_repr</span><span class="p">)</span>
            <span class="n">res</span><span class="p">[</span><span class="n">key_repr</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_repr</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Storage&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if self contains all keys with equal value as</span>
<span class="sd">        contained by second storage.</span>
<span class="sd">        Used for comparison with test expected post state and alloc returned</span>
<span class="sd">        by the transition tool.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">must_contain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Storage&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Succeeds only if self contains all keys with equal value as</span>
<span class="sd">        contained by second storage.</span>
<span class="sd">        Used for comparison with test expected post state and alloc returned</span>
<span class="sd">        by the transition tool.</span>
<span class="sd">        Raises detailed exception when a difference is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="c1"># storage[key]==0 is equal to missing storage</span>
                <span class="k">if</span> <span class="n">other</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">MissingKey</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">KeyValueMismatch</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">must_be_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Storage&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Succeeds only if &quot;self&quot; is equal to &quot;other&quot; storage.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Test keys contained in both storage objects</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">KeyValueMismatch</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

        <span class="c1"># Test keys contained in either one of the storage objects</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">KeyValueMismatch</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">KeyValueMismatch</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Storage.StorageDictType" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">StorageDictType</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Storage.StorageDictType" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Dictionary type to be used when defining an input to initialize a storage.</p>
  </div>

</div>






<div class="doc doc-object doc-class">




<h3 id="ethereum_test_tools.Storage.InvalidType" class="doc doc-heading">
          <code>InvalidType</code>


<a href="#ethereum_test_tools.Storage.InvalidType" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>Exception</code></p>

  
      <p>Invalid type used when describing test's expected storage key or value.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidType</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Invalid type used when describing test&#39;s expected storage key or value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key_or_value</span><span class="p">:</span> <span class="n">Any</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_or_value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_or_value</span> <span class="o">=</span> <span class="n">key_or_value</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;invalid type for key/value: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_or_value</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h4 id="ethereum_test_tools.Storage.InvalidType.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Storage.InvalidType.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;invalid type for key/value: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_or_value</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h3 id="ethereum_test_tools.Storage.InvalidValue" class="doc doc-heading">
          <code>InvalidValue</code>


<a href="#ethereum_test_tools.Storage.InvalidValue" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>Exception</code></p>

  
      <p>Invalid value used when describing test's expected storage key or
value.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidValue</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Invalid value used when describing test&#39;s expected storage key or</span>
<span class="sd">    value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key_or_value</span><span class="p">:</span> <span class="n">Any</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_or_value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_or_value</span> <span class="o">=</span> <span class="n">key_or_value</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;invalid value for key/value: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_or_value</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h4 id="ethereum_test_tools.Storage.InvalidValue.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Storage.InvalidValue.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;invalid value for key/value: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_or_value</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h3 id="ethereum_test_tools.Storage.AmbiguousKeyValue" class="doc doc-heading">
          <code>AmbiguousKeyValue</code>


<a href="#ethereum_test_tools.Storage.AmbiguousKeyValue" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>Exception</code></p>

  
      <p>Key is represented twice in the storage.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AmbiguousKeyValue</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Key is represented twice in the storage.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key_1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span>
    <span class="n">val_1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span>
    <span class="n">key_2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span>
    <span class="n">val_2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key_1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">val_1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">key_2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">val_2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_1</span> <span class="o">=</span> <span class="n">key_1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_1</span> <span class="o">=</span> <span class="n">val_1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_2</span> <span class="o">=</span> <span class="n">key_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val_2</span> <span class="o">=</span> <span class="n">val_2</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Key is represented twice (due to negative numbers) with different</span>
<span class="s2">        values in storage:</span>
<span class="s2">        s[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_1</span><span class="si">}</span><span class="s2">] = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">val_1</span><span class="si">}</span><span class="s2"> and s[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_2</span><span class="si">}</span><span class="s2">] = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">val_2</span><span class="si">}</span>
<span class="s2">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h4 id="ethereum_test_tools.Storage.AmbiguousKeyValue.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Storage.AmbiguousKeyValue.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Key is represented twice (due to negative numbers) with different</span>
<span class="s2">    values in storage:</span>
<span class="s2">    s[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_1</span><span class="si">}</span><span class="s2">] = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">val_1</span><span class="si">}</span><span class="s2"> and s[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key_2</span><span class="si">}</span><span class="s2">] = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">val_2</span><span class="si">}</span>
<span class="s2">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h3 id="ethereum_test_tools.Storage.MissingKey" class="doc doc-heading">
          <code>MissingKey</code>


<a href="#ethereum_test_tools.Storage.MissingKey" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>Exception</code></p>

  
      <p>Test expected to find a storage key set but key was missing.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MissingKey</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test expected to find a storage key set but key was missing.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;key </span><span class="si">{0}</span><span class="s2"> not found in storage&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h4 id="ethereum_test_tools.Storage.MissingKey.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Storage.MissingKey.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;key </span><span class="si">{0}</span><span class="s2"> not found in storage&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h3 id="ethereum_test_tools.Storage.KeyValueMismatch" class="doc doc-heading">
          <code>KeyValueMismatch</code>


<a href="#ethereum_test_tools.Storage.KeyValueMismatch" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>Exception</code></p>

  
      <p>Test expected a certain value in a storage key but value found
was different.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">KeyValueMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test expected a certain value in a storage key but value found</span>
<span class="sd">    was different.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">want</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">got</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;incorrect value in address </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2"> for &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;key </span><span class="si">{</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2">:&quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; want </span><span class="si">{</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="p">)</span><span class="si">}</span><span class="s2"> (dec:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">),&quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; got </span><span class="si">{</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="p">)</span><span class="si">}</span><span class="s2"> (dec:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h4 id="ethereum_test_tools.Storage.KeyValueMismatch.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Storage.KeyValueMismatch.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;incorrect value in address </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2"> for &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;key </span><span class="si">{</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2">:&quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; want </span><span class="si">{</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="p">)</span><span class="si">}</span><span class="s2"> (dec:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">),&quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; got </span><span class="si">{</span><span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="p">)</span><span class="si">}</span><span class="s2"> (dec:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.parse_key_value" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parse_key_value</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ethereum_test_tools.Storage.parse_key_value" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parses a key or value to a valid int key for storage.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">parse_key_value</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses a key or value to a valid int key for storage.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">input</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">SupportsBytes</span><span class="p">):</span>
        <span class="nb">input</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="nb">input</span><span class="p">),</span> <span class="s2">&quot;big&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">InvalidType</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">input</span> <span class="o">&gt;</span> <span class="n">MAX_STORAGE_KEY_VALUE</span> <span class="ow">or</span> <span class="nb">input</span> <span class="o">&lt;</span> <span class="n">MIN_STORAGE_KEY_VALUE</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">InvalidValue</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">input</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.key_value_to_string" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">key_value_to_string</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ethereum_test_tools.Storage.key_value_to_string" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Transforms a key or value into an hex string.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">key_value_to_string</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms a key or value into an hex string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hex_str</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;big&quot;</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="p">(</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hex_str</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">hex_str</span> <span class="o">=</span> <span class="s2">&quot;00&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hex_str</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">hex_str</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="n">hex_str</span>
    <span class="k">return</span> <span class="s2">&quot;0x&quot;</span> <span class="o">+</span> <span class="n">hex_str</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="p">{},</span> <span class="n">start_slot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Storage.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes the storage using a given mapping which can have
keys and values either as string or int.
Strings must be valid decimal or hexadecimal (starting with 0x)
numbers.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="n">StorageDictType</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">start_slot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the storage using a given mapping which can have</span>
<span class="sd">    keys and values either as string or int.</span>
<span class="sd">    Strings must be valid decimal or hexadecimal (starting with 0x)</span>
<span class="sd">    numbers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="nb">input</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_slot</span> <span class="o">=</span> <span class="n">count</span><span class="p">(</span><span class="n">start_slot</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.__len__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Storage.__len__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns number of elements in the storage</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns number of elements in the storage&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.__contains__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__contains__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Storage.__contains__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Checks for an item in the storage</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks for an item in the storage&quot;&quot;&quot;</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.__getitem__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Storage.__getitem__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns an item from the storage</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns an item from the storage&quot;&quot;&quot;</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.__setitem__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__setitem__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Storage.__setitem__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Sets an item in the storage</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">):</span>  <span class="c1"># noqa: SC200</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets an item in the storage&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.__delitem__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__delitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Storage.__delitem__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Deletes an item from the storage</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deletes an item from the storage&quot;&quot;&quot;</span>
    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">Storage</span><span class="o">.</span><span class="n">parse_key_value</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.store_next" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">store_next</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Storage.store_next" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Stores a value in the storage and returns the key where the value is stored.</p>
<p>Increments the key counter so the next time this function is called,
the next key is used.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">store_next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stores a value in the storage and returns the key where the value is stored.</span>

<span class="sd">    Increments the key counter so the next time this function is called,</span>
<span class="sd">    the next key is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="p">[</span><span class="n">slot</span> <span class="o">:=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_slot</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">slot</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.__json__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__json__</span><span class="p">(</span><span class="n">encoder</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Storage.__json__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Converts the storage into a string dict with appropriate 32-byte
hex string formatting.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__json__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">JSONEncoder</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the storage into a string dict with appropriate 32-byte</span>
<span class="sd">    hex string formatting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="n">key_repr</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">val_repr</span> <span class="o">=</span> <span class="n">Storage</span><span class="o">.</span><span class="n">key_value_to_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">key_repr</span> <span class="ow">in</span> <span class="n">res</span> <span class="ow">and</span> <span class="n">val_repr</span> <span class="o">!=</span> <span class="n">res</span><span class="p">[</span><span class="n">key_repr</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">AmbiguousKeyValue</span><span class="p">(</span><span class="n">key_repr</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="n">key_repr</span><span class="p">],</span> <span class="n">key</span><span class="p">,</span> <span class="n">val_repr</span><span class="p">)</span>
        <span class="n">res</span><span class="p">[</span><span class="n">key_repr</span><span class="p">]</span> <span class="o">=</span> <span class="n">val_repr</span>
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.contains" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">contains</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Storage.contains" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns True if self contains all keys with equal value as
contained by second storage.
Used for comparison with test expected post state and alloc returned
by the transition tool.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Storage&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns True if self contains all keys with equal value as</span>
<span class="sd">    contained by second storage.</span>
<span class="sd">    Used for comparison with test expected post state and alloc returned</span>
<span class="sd">    by the transition tool.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.must_contain" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">must_contain</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Storage.must_contain" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Succeeds only if self contains all keys with equal value as
contained by second storage.
Used for comparison with test expected post state and alloc returned
by the transition tool.
Raises detailed exception when a difference is found.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">must_contain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Storage&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Succeeds only if self contains all keys with equal value as</span>
<span class="sd">    contained by second storage.</span>
<span class="sd">    Used for comparison with test expected post state and alloc returned</span>
<span class="sd">    by the transition tool.</span>
<span class="sd">    Raises detailed exception when a difference is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="c1"># storage[key]==0 is equal to missing storage</span>
            <span class="k">if</span> <span class="n">other</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">MissingKey</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">KeyValueMismatch</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Storage.must_be_equal" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">must_be_equal</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Storage.must_be_equal" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Succeeds only if "self" is equal to "other" storage.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">must_be_equal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;Storage&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Succeeds only if &quot;self&quot; is equal to &quot;other&quot; storage.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Test keys contained in both storage objects</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">KeyValueMismatch</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

    <span class="c1"># Test keys contained in either one of the storage objects</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">^</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">KeyValueMismatch</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Storage</span><span class="o">.</span><span class="n">KeyValueMismatch</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.CalldataCase" class="doc doc-heading">
          <code>CalldataCase</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.CalldataCase" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Small helper class to represent a single case whose condition depends
on the value of the contract's calldata in a Switch case statement.</p>
<p>By default the calldata is read from position zero, but this can be
overridden using <code>position</code>.</p>
<p>The <code>condition</code> is generated automatically based on the <code>value</code> (and
optionally <code>position</code>) and may not be set directly.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">CalldataCase</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Small helper class to represent a single case whose condition depends</span>
<span class="sd">    on the value of the contract&#39;s calldata in a Switch case statement.</span>

<span class="sd">    By default the calldata is read from position zero, but this can be</span>
<span class="sd">    overridden using `position`.</span>

<span class="sd">    The `condition` is generated automatically based on the `value` (and</span>
<span class="sd">    optionally `position`) and may not be set directly.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">action</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span>
    <span class="n">position</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">condition</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate the condition base on `value` and `position`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value_as_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">value_as_bytes</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">PUSH32</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">EQ</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">CALLDATALOAD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">),</span> <span class="n">value_as_bytes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.CalldataCase.__post_init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.CalldataCase.__post_init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Generate the condition base on <code>value</code> and <code>position</code>.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate the condition base on `value` and `position`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value_as_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">value_as_bytes</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">PUSH32</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">EQ</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">CALLDATALOAD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">),</span> <span class="n">value_as_bytes</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Switch" class="doc doc-heading">
          <code>Switch</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.Switch" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="ethereum_test_tools.code.code.Code" href="#ethereum_test_tools.Code">Code</a></code></p>

  
      <p>Helper class used to generate switch-case expressions in EVM bytecode.</p>

<details class="switch-case-behavior" open>
  <summary>Switch-case behavior</summary>
  <ul>
<li>If no condition is met in the list of BytecodeCases conditions,
    the <code>default_action</code> bytecode is executed.</li>
<li>If multiple conditions are met, the action from the first valid
    condition is the only one executed.</li>
<li>There is no fall through; it is not possible to execute multiple
    actions.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Switch</span><span class="p">(</span><span class="n">Code</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper class used to generate switch-case expressions in EVM bytecode.</span>

<span class="sd">    Switch-case behavior:</span>
<span class="sd">        - If no condition is met in the list of BytecodeCases conditions,</span>
<span class="sd">            the `default_action` bytecode is executed.</span>
<span class="sd">        - If multiple conditions are met, the action from the first valid</span>
<span class="sd">            condition is the only one executed.</span>
<span class="sd">        - There is no fall through; it is not possible to execute multiple</span>
<span class="sd">            actions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">default_action</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The default bytecode to execute; if no condition is met, this bytecode is</span>
<span class="sd">    executed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Case</span> <span class="o">|</span> <span class="n">CalldataCase</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A list of Case or CalldataCase: The first element with a condition that</span>
<span class="sd">    evaluates to a non-zero value is the one that is executed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assemble the bytecode by looping over the list of cases and adding</span>
<span class="sd">        the necessary JUMPI and JUMPDEST opcodes in order to replicate</span>
<span class="sd">        switch-case behavior.</span>

<span class="sd">        In the future, PC usage should be replaced by using RJUMP and RJUMPI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The length required to jump over subsequent actions to the final JUMPDEST at the end</span>
        <span class="c1"># of the switch-case block:</span>
        <span class="c1"># - add 6 per case for the length of the JUMPDEST and JUMP(ADD(PC, action_jump_length))</span>
        <span class="c1">#   bytecode</span>
        <span class="c1"># - add 3 to the total to account for this action&#39;s JUMP; the PC within the call</span>
        <span class="c1">#   requires a &quot;correction&quot; of 3.</span>
        <span class="n">action_jump_length</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">action</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span> <span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cases</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span>

        <span class="c1"># All conditions get pre-pended to this bytecode; if none are met, we reach the default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_action</span><span class="p">)</span> <span class="o">+</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMP</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">ADD</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span> <span class="n">action_jump_length</span><span class="p">))</span>

        <span class="c1"># The length required to jump over the default action and its JUMP bytecode</span>
        <span class="n">condition_jump_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span>

        <span class="c1"># Reversed: first case in the list has priority; it will become the outer-most onion layer.</span>
        <span class="c1"># We build up layers around the default_action, after 1 iteration of the loop, a simplified</span>
        <span class="c1"># representation of the bytecode is:</span>
        <span class="c1">#</span>
        <span class="c1">#  JUMPI(case[n-1].condition)</span>
        <span class="c1">#  + default_action + JUMP()</span>
        <span class="c1">#  + JUMPDEST + case[n-1].action + JUMP()</span>
        <span class="c1">#</span>
        <span class="c1"># and after n=len(cases) iterations:</span>
        <span class="c1">#</span>
        <span class="c1">#  JUMPI(case[0].condition)</span>
        <span class="c1">#  + JUMPI(case[1].condition)</span>
        <span class="c1">#    ...</span>
        <span class="c1">#  + JUMPI(case[n-1].condition)</span>
        <span class="c1">#  + default_action + JUMP()</span>
        <span class="c1">#  + JUMPDEST + case[n-1].action + JUMP()</span>
        <span class="c1">#  + ...</span>
        <span class="c1">#  + JUMPDEST + case[1].action + JUMP()</span>
        <span class="c1">#  + JUMPDEST + case[0].action + JUMP()</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cases</span><span class="p">):</span>
            <span class="n">action_jump_length</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">action</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPDEST</span> <span class="o">+</span> <span class="n">case</span><span class="o">.</span><span class="n">action</span> <span class="o">+</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMP</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">ADD</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span> <span class="n">action_jump_length</span><span class="p">))</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPI</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">ADD</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span> <span class="n">condition_jump_length</span><span class="p">),</span> <span class="n">case</span><span class="o">.</span><span class="n">condition</span><span class="p">)</span>
            <span class="c1"># wrap the current case around the onion as its next layer</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">condition</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">+</span> <span class="n">action</span>
            <span class="n">condition_jump_length</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">+=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPDEST</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Switch.default_action" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">default_action</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="n">SupportsBytes</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Switch.default_action" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The default bytecode to execute; if no condition is met, this bytecode is
executed.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Switch.cases" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Case</span> <span class="o">|</span> <span class="n">CalldataCase</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Switch.cases" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>A list of Case or CalldataCase: The first element with a condition that
evaluates to a non-zero value is the one that is executed.</p>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Switch.__post_init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Switch.__post_init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Assemble the bytecode by looping over the list of cases and adding
the necessary JUMPI and JUMPDEST opcodes in order to replicate
switch-case behavior.</p>
<p>In the future, PC usage should be replaced by using RJUMP and RJUMPI.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/code/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assemble the bytecode by looping over the list of cases and adding</span>
<span class="sd">    the necessary JUMPI and JUMPDEST opcodes in order to replicate</span>
<span class="sd">    switch-case behavior.</span>

<span class="sd">    In the future, PC usage should be replaced by using RJUMP and RJUMPI.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># The length required to jump over subsequent actions to the final JUMPDEST at the end</span>
    <span class="c1"># of the switch-case block:</span>
    <span class="c1"># - add 6 per case for the length of the JUMPDEST and JUMP(ADD(PC, action_jump_length))</span>
    <span class="c1">#   bytecode</span>
    <span class="c1"># - add 3 to the total to account for this action&#39;s JUMP; the PC within the call</span>
    <span class="c1">#   requires a &quot;correction&quot; of 3.</span>
    <span class="n">action_jump_length</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">action</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span> <span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cases</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span>

    <span class="c1"># All conditions get pre-pended to this bytecode; if none are met, we reach the default</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_action</span><span class="p">)</span> <span class="o">+</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMP</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">ADD</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span> <span class="n">action_jump_length</span><span class="p">))</span>

    <span class="c1"># The length required to jump over the default action and its JUMP bytecode</span>
    <span class="n">condition_jump_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span>

    <span class="c1"># Reversed: first case in the list has priority; it will become the outer-most onion layer.</span>
    <span class="c1"># We build up layers around the default_action, after 1 iteration of the loop, a simplified</span>
    <span class="c1"># representation of the bytecode is:</span>
    <span class="c1">#</span>
    <span class="c1">#  JUMPI(case[n-1].condition)</span>
    <span class="c1">#  + default_action + JUMP()</span>
    <span class="c1">#  + JUMPDEST + case[n-1].action + JUMP()</span>
    <span class="c1">#</span>
    <span class="c1"># and after n=len(cases) iterations:</span>
    <span class="c1">#</span>
    <span class="c1">#  JUMPI(case[0].condition)</span>
    <span class="c1">#  + JUMPI(case[1].condition)</span>
    <span class="c1">#    ...</span>
    <span class="c1">#  + JUMPI(case[n-1].condition)</span>
    <span class="c1">#  + default_action + JUMP()</span>
    <span class="c1">#  + JUMPDEST + case[n-1].action + JUMP()</span>
    <span class="c1">#  + ...</span>
    <span class="c1">#  + JUMPDEST + case[1].action + JUMP()</span>
    <span class="c1">#  + JUMPDEST + case[0].action + JUMP()</span>
    <span class="c1">#</span>
    <span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cases</span><span class="p">):</span>
        <span class="n">action_jump_length</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">case</span><span class="o">.</span><span class="n">action</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPDEST</span> <span class="o">+</span> <span class="n">case</span><span class="o">.</span><span class="n">action</span> <span class="o">+</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMP</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">ADD</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span> <span class="n">action_jump_length</span><span class="p">))</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPI</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">ADD</span><span class="p">(</span><span class="n">Op</span><span class="o">.</span><span class="n">PC</span><span class="p">,</span> <span class="n">condition_jump_length</span><span class="p">),</span> <span class="n">case</span><span class="o">.</span><span class="n">condition</span><span class="p">)</span>
        <span class="c1"># wrap the current case around the onion as its next layer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">=</span> <span class="n">condition</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">+</span> <span class="n">action</span>
        <span class="n">condition_jump_length</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">bytecode</span> <span class="o">+=</span> <span class="n">Op</span><span class="o">.</span><span class="n">JUMPDEST</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Account" class="doc doc-heading">
          <code>Account</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.Account" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>State associated with an address.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Account</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    State associated with an address.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">nonce</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;nonce&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">,</span>
            <span class="n">default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The scalar value equal to a) the number of transactions sent by</span>
<span class="sd">    an Externally Owned Account, b) the amount of contracts created by a</span>
<span class="sd">    contract.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">balance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;balance&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">,</span>
            <span class="n">default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The amount of Wei (10&lt;sup&gt;-18&lt;/sup&gt; Eth) the account has.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">code</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;code&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Bytes</span><span class="p">,</span>
            <span class="n">default_value</span><span class="o">=</span><span class="nb">bytes</span><span class="p">(),</span>
        <span class="p">),</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bytecode contained by the account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">storage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Storage</span> <span class="o">|</span> <span class="n">Storage</span><span class="o">.</span><span class="n">StorageDictType</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;storage&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Storage</span><span class="p">,</span>
            <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">default_value</span><span class="o">=</span><span class="p">{},</span>
        <span class="p">),</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Storage within a contract.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">NONEXISTENT</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sentinel object used to specify when an account should not exist in the</span>
<span class="sd">    state.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">NonceMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test expected a certain nonce value for an account but a different</span>
<span class="sd">        value was found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
        <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
        <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;unexpected nonce for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">class</span> <span class="nc">BalanceMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test expected a certain balance for an account but a different</span>
<span class="sd">        value was found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
        <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
        <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;unexpected balance for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">class</span> <span class="nc">CodeMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test expected a certain bytecode for an account but a different</span>
<span class="sd">        one was found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
        <span class="n">want</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
        <span class="n">got</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;unexpected code for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_alloc</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alloc</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks the returned alloc against an expected account in post state.</span>
<span class="sd">        Raises exception on failure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonce</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actual_nonce</span> <span class="o">=</span> <span class="n">int_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nonce&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">nonce</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">nonce</span> <span class="o">!=</span> <span class="n">actual_nonce</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">NonceMismatch</span><span class="p">(</span>
                    <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                    <span class="n">want</span><span class="o">=</span><span class="n">nonce</span><span class="p">,</span>
                    <span class="n">got</span><span class="o">=</span><span class="n">actual_nonce</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actual_balance</span> <span class="o">=</span> <span class="n">int_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;balance&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">balance</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">balance</span> <span class="o">!=</span> <span class="n">actual_balance</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">BalanceMismatch</span><span class="p">(</span>
                    <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                    <span class="n">want</span><span class="o">=</span><span class="n">balance</span><span class="p">,</span>
                    <span class="n">got</span><span class="o">=</span><span class="n">actual_balance</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">expected_code</span> <span class="o">=</span> <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
            <span class="n">actual_code</span> <span class="o">=</span> <span class="n">str_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">),</span> <span class="s2">&quot;0x&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">expected_code</span> <span class="o">!=</span> <span class="n">actual_code</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">CodeMismatch</span><span class="p">(</span>
                    <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                    <span class="n">want</span><span class="o">=</span><span class="n">expected_code</span><span class="p">,</span>
                    <span class="n">got</span><span class="o">=</span><span class="n">actual_code</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">expected_storage</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">,</span> <span class="n">Storage</span><span class="p">)</span> <span class="k">else</span> <span class="n">Storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">actual_storage</span> <span class="o">=</span> <span class="n">Storage</span><span class="p">(</span><span class="n">alloc</span><span class="p">[</span><span class="s2">&quot;storage&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="s2">&quot;storage&quot;</span> <span class="ow">in</span> <span class="n">alloc</span> <span class="k">else</span> <span class="n">Storage</span><span class="p">({})</span>
            <span class="n">expected_storage</span><span class="o">.</span><span class="n">must_be_equal</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="n">actual_storage</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;Account&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns true if an account deemed empty.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonce</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="o">==</span> <span class="p">{}</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="s2">&quot;Dict | Account&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Account&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create account from dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">data</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">with_code</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">BytesConvertible</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Account&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create account with provided `code` and nonce of `1`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Account</span><span class="p">(</span><span class="n">nonce</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">account_1</span><span class="p">:</span> <span class="s2">&quot;Dict | Account | None&quot;</span><span class="p">,</span> <span class="n">account_2</span><span class="p">:</span> <span class="s2">&quot;Dict | Account | None&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Account&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a merged account from two sources.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">to_kwargs_dict</span><span class="p">(</span><span class="n">account</span><span class="p">:</span> <span class="s2">&quot;Dict | Account | None&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">account</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">account</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="p">}</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected type for account merge: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">account</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">to_kwargs_dict</span><span class="p">(</span><span class="n">account_1</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">to_kwargs_dict</span><span class="p">(</span><span class="n">account_2</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Account.nonce" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">nonce</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;nonce&#39;</span><span class="p">,</span> <span class="n">cast_type</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Account.nonce" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The scalar value equal to a) the number of transactions sent by
an Externally Owned Account, b) the amount of contracts created by a
contract.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Account.balance" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">balance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;balance&#39;</span><span class="p">,</span> <span class="n">cast_type</span><span class="o">=</span><span class="n">ZeroPaddedHexNumber</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Account.balance" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The amount of Wei (10<sup>-18</sup> Eth) the account has.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Account.code" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">code</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="n">cast_type</span><span class="o">=</span><span class="n">Bytes</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="nb">bytes</span><span class="p">()))</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Account.code" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Bytecode contained by the account.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Account.storage" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">storage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Storage</span> <span class="o">|</span> <span class="n">Storage</span><span class="o">.</span><span class="n">StorageDictType</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;storage&#39;</span><span class="p">,</span> <span class="n">cast_type</span><span class="o">=</span><span class="n">Storage</span><span class="p">,</span> <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="p">{}))</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Account.storage" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Storage within a contract.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Account.NONEXISTENT" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">NONEXISTENT</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Account.NONEXISTENT" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Sentinel object used to specify when an account should not exist in the
state.</p>
  </div>

</div>






<div class="doc doc-object doc-class">




<h3 id="ethereum_test_tools.Account.NonceMismatch" class="doc doc-heading">
          <code>NonceMismatch</code>


<a href="#ethereum_test_tools.Account.NonceMismatch" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>Exception</code></p>

  
      <p>Test expected a certain nonce value for an account but a different
value was found.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">NonceMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test expected a certain nonce value for an account but a different</span>
<span class="sd">    value was found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unexpected nonce for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h4 id="ethereum_test_tools.Account.NonceMismatch.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Account.NonceMismatch.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;unexpected nonce for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h3 id="ethereum_test_tools.Account.BalanceMismatch" class="doc doc-heading">
          <code>BalanceMismatch</code>


<a href="#ethereum_test_tools.Account.BalanceMismatch" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>Exception</code></p>

  
      <p>Test expected a certain balance for an account but a different
value was found.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BalanceMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test expected a certain balance for an account but a different</span>
<span class="sd">    value was found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unexpected balance for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h4 id="ethereum_test_tools.Account.BalanceMismatch.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Account.BalanceMismatch.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;unexpected balance for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h3 id="ethereum_test_tools.Account.CodeMismatch" class="doc doc-heading">
          <code>CodeMismatch</code>


<a href="#ethereum_test_tools.Account.CodeMismatch" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>Exception</code></p>

  
      <p>Test expected a certain bytecode for an account but a different
one was found.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CodeMismatch</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test expected a certain bytecode for an account but a different</span>
<span class="sd">    one was found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">want</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">got</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">want</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">got</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">want</span> <span class="o">=</span> <span class="n">want</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">got</span> <span class="o">=</span> <span class="n">got</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unexpected code for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h4 id="ethereum_test_tools.Account.CodeMismatch.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Account.CodeMismatch.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;unexpected code for account </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="si">}</span><span class="s2">: &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;want </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">want</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">got</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Account.check_alloc" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">check_alloc</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">alloc</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Account.check_alloc" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Checks the returned alloc against an expected account in post state.
Raises exception on failure.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_alloc</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;Account&quot;</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alloc</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the returned alloc against an expected account in post state.</span>
<span class="sd">    Raises exception on failure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonce</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">actual_nonce</span> <span class="o">=</span> <span class="n">int_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nonce&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">nonce</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">nonce</span> <span class="o">!=</span> <span class="n">actual_nonce</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">NonceMismatch</span><span class="p">(</span>
                <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                <span class="n">want</span><span class="o">=</span><span class="n">nonce</span><span class="p">,</span>
                <span class="n">got</span><span class="o">=</span><span class="n">actual_nonce</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">actual_balance</span> <span class="o">=</span> <span class="n">int_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;balance&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">balance</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">balance</span> <span class="o">!=</span> <span class="n">actual_balance</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">BalanceMismatch</span><span class="p">(</span>
                <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                <span class="n">want</span><span class="o">=</span><span class="n">balance</span><span class="p">,</span>
                <span class="n">got</span><span class="o">=</span><span class="n">actual_balance</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">expected_code</span> <span class="o">=</span> <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
        <span class="n">actual_code</span> <span class="o">=</span> <span class="n">str_or_none</span><span class="p">(</span><span class="n">alloc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">),</span> <span class="s2">&quot;0x&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expected_code</span> <span class="o">!=</span> <span class="n">actual_code</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Account</span><span class="o">.</span><span class="n">CodeMismatch</span><span class="p">(</span>
                <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span>
                <span class="n">want</span><span class="o">=</span><span class="n">expected_code</span><span class="p">,</span>
                <span class="n">got</span><span class="o">=</span><span class="n">actual_code</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">expected_storage</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">,</span> <span class="n">Storage</span><span class="p">)</span> <span class="k">else</span> <span class="n">Storage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">storage</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">actual_storage</span> <span class="o">=</span> <span class="n">Storage</span><span class="p">(</span><span class="n">alloc</span><span class="p">[</span><span class="s2">&quot;storage&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="s2">&quot;storage&quot;</span> <span class="ow">in</span> <span class="n">alloc</span> <span class="k">else</span> <span class="n">Storage</span><span class="p">({})</span>
        <span class="n">expected_storage</span><span class="o">.</span><span class="n">must_be_equal</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="n">actual_storage</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Account.is_empty" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">is_empty</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Account.is_empty" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns true if an account deemed empty.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="s2">&quot;Account&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns true if an account deemed empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonce</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="o">==</span> <span class="p">{}</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Account.from_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#ethereum_test_tools.Account.from_dict" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create account from dictionary.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="s2">&quot;Dict | Account&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Account&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create account from dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Account.with_code" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">with_code</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#ethereum_test_tools.Account.with_code" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create account with provided <code>code</code> and nonce of <code>1</code>.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">with_code</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="n">BytesConvertible</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Account&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create account with provided `code` and nonce of `1`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Account</span><span class="p">(</span><span class="n">nonce</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Account.merge" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">merge</span><span class="p">(</span><span class="n">account_1</span><span class="p">,</span> <span class="n">account_2</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#ethereum_test_tools.Account.merge" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a merged account from two sources.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">merge</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">account_1</span><span class="p">:</span> <span class="s2">&quot;Dict | Account | None&quot;</span><span class="p">,</span> <span class="n">account_2</span><span class="p">:</span> <span class="s2">&quot;Dict | Account | None&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Account&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a merged account from two sources.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">to_kwargs_dict</span><span class="p">(</span><span class="n">account</span><span class="p">:</span> <span class="s2">&quot;Dict | Account | None&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">account</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">account</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">v</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">}</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected type for account merge: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">account</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">kwargs</span> <span class="o">=</span> <span class="n">to_kwargs_dict</span><span class="p">(</span><span class="n">account_1</span><span class="p">)</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">to_kwargs_dict</span><span class="p">(</span><span class="n">account_2</span><span class="p">))</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Withdrawal" class="doc doc-heading">
          <code>Withdrawal</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.Withdrawal" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Structure to represent a single withdrawal of a validator's balance from
the beacon chain.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Withdrawal</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Structure to represent a single withdrawal of a validator&#39;s balance from</span>
<span class="sd">    the beacon chain.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">index</span><span class="p">:</span> <span class="n">NumberConvertible</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">validator</span><span class="p">:</span> <span class="n">NumberConvertible</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;validatorIndex&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">address</span><span class="p">:</span> <span class="n">FixedSizeBytesConvertible</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Address</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">amount</span><span class="p">:</span> <span class="n">NumberConvertible</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_serializable_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a list of the withdrawal&#39;s attributes in the order they should</span>
<span class="sd">        be serialized.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">Uint</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validator</span><span class="p">)),</span>
            <span class="n">Address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amount</span><span class="p">)),</span>
        <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Withdrawal.to_serializable_list" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_serializable_list</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Withdrawal.to_serializable_list" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns a list of the withdrawal's attributes in the order they should
be serialized.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_serializable_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a list of the withdrawal&#39;s attributes in the order they should</span>
<span class="sd">    be serialized.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">Uint</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)),</span>
        <span class="n">Uint</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validator</span><span class="p">)),</span>
        <span class="n">Address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">),</span>
        <span class="n">Uint</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">amount</span><span class="p">)),</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Environment" class="doc doc-heading">
          <code>Environment</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.Environment" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Structure used to keep track of the context in which a block
must be executed.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Environment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Structure used to keep track of the context in which a block</span>
<span class="sd">    must be executed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">coinbase</span><span class="p">:</span> <span class="n">FixedSizeBytesConvertible</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;0x2adc25665018aa1fe0e6bc666dac8fc2697ff9ba&quot;</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;currentCoinbase&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Address</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">gas_limit</span><span class="p">:</span> <span class="n">NumberConvertible</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">100000000000000000</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;currentGasLimit&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">number</span><span class="p">:</span> <span class="n">NumberConvertible</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;currentNumber&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="n">NumberConvertible</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;currentTimestamp&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">prev_randao</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;currentRandom&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">difficulty</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;currentDifficulty&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">block_hashes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">,</span> <span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;blockHashes&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="n">k</span><span class="p">)):</span> <span class="nb">str</span><span class="p">(</span><span class="n">Hash</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
            <span class="n">skip_string_convert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">ommers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ommers&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">Hash</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">],</span>
            <span class="n">skip_string_convert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">withdrawals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Withdrawal</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;withdrawals&quot;</span><span class="p">,</span>
            <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">base_fee</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;currentBaseFee&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">parent_difficulty</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;parentDifficulty&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">parent_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;parentTimestamp&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">parent_base_fee</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;parentBaseFee&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">parent_gas_used</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;parentGasUsed&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">parent_gas_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;parentGasLimit&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">parent_ommers_hash</span><span class="p">:</span> <span class="n">FixedSizeBytesConvertible</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;parentUncleHash&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Hash</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">parent_blob_gas_used</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;parentBlobGasUsed&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">parent_excess_blob_gas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;parentExcessBlobGas&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">blob_gas_used</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;currentBlobGasUsed&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">excess_blob_gas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;currentExcessBlobGas&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Number</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">beacon_root</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;parentBeaconBlockRoot&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Hash</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">extra_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_parent_header</span><span class="p">(</span><span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;FixtureHeader&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Environment&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiates a new environment with the provided header as parent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Environment</span><span class="p">(</span>
            <span class="n">parent_difficulty</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">difficulty</span><span class="p">,</span>
            <span class="n">parent_timestamp</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
            <span class="n">parent_base_fee</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">base_fee</span><span class="p">,</span>
            <span class="n">parent_blob_gas_used</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">blob_gas_used</span><span class="p">,</span>
            <span class="n">parent_excess_blob_gas</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">excess_blob_gas</span><span class="p">,</span>
            <span class="n">parent_gas_used</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">gas_used</span><span class="p">,</span>
            <span class="n">parent_gas_limit</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">,</span>
            <span class="n">parent_ommers_hash</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">ommers_hash</span><span class="p">,</span>
            <span class="n">block_hashes</span><span class="o">=</span><span class="p">{</span><span class="n">parent</span><span class="o">.</span><span class="n">number</span><span class="p">:</span> <span class="n">parent</span><span class="o">.</span><span class="n">hash</span> <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">hash</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span><span class="p">},</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">parent_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Obtains the latest hash according to the highest block number in</span>
<span class="sd">        `block_hashes`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_hashes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>

        <span class="n">last_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">Number</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_hashes</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>
        <span class="k">return</span> <span class="n">Hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_hashes</span><span class="p">[</span><span class="n">last_index</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">apply_new_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_parent</span><span class="p">:</span> <span class="s2">&quot;FixtureHeader&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Environment&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies a header as parent to a copy of this environment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">env</span><span class="o">.</span><span class="n">parent_difficulty</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">difficulty</span>
        <span class="n">env</span><span class="o">.</span><span class="n">parent_timestamp</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">timestamp</span>
        <span class="n">env</span><span class="o">.</span><span class="n">parent_base_fee</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">base_fee</span>
        <span class="n">env</span><span class="o">.</span><span class="n">parent_blob_gas_used</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">blob_gas_used</span>
        <span class="n">env</span><span class="o">.</span><span class="n">parent_excess_blob_gas</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">excess_blob_gas</span>
        <span class="n">env</span><span class="o">.</span><span class="n">parent_gas_used</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">gas_used</span>
        <span class="n">env</span><span class="o">.</span><span class="n">parent_gas_limit</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">gas_limit</span>
        <span class="n">env</span><span class="o">.</span><span class="n">parent_ommers_hash</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">ommers_hash</span>
        <span class="n">env</span><span class="o">.</span><span class="n">block_hashes</span><span class="p">[</span><span class="n">new_parent</span><span class="o">.</span><span class="n">number</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">hash</span> <span class="k">if</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">hash</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">env</span>

    <span class="k">def</span> <span class="nf">set_fork_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Environment&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fills the required fields in an environment depending on the fork.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">in_place</span> <span class="k">else</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">header_prev_randao_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span> <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">prev_randao</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">prev_randao</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">header_withdrawals_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span> <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">withdrawals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">withdrawals</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">fork</span><span class="o">.</span><span class="n">header_base_fee_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">base_fee</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">parent_base_fee</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">base_fee</span> <span class="o">=</span> <span class="n">DEFAULT_BASE_FEE</span>

        <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">header_zero_difficulty_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">fork</span><span class="o">.</span><span class="n">header_excess_blob_gas_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">excess_blob_gas</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">parent_excess_blob_gas</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">excess_blob_gas</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">fork</span><span class="o">.</span><span class="n">header_blob_gas_used_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">blob_gas_used</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">parent_blob_gas_used</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">blob_gas_used</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">header_beacon_root_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span> <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">beacon_root</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">beacon_root</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Environment.from_parent_header" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_parent_header</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#ethereum_test_tools.Environment.from_parent_header" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Instantiates a new environment with the provided header as parent.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">from_parent_header</span><span class="p">(</span><span class="n">parent</span><span class="p">:</span> <span class="s2">&quot;FixtureHeader&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Environment&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiates a new environment with the provided header as parent.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Environment</span><span class="p">(</span>
        <span class="n">parent_difficulty</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">difficulty</span><span class="p">,</span>
        <span class="n">parent_timestamp</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
        <span class="n">parent_base_fee</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">base_fee</span><span class="p">,</span>
        <span class="n">parent_blob_gas_used</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">blob_gas_used</span><span class="p">,</span>
        <span class="n">parent_excess_blob_gas</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">excess_blob_gas</span><span class="p">,</span>
        <span class="n">parent_gas_used</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">gas_used</span><span class="p">,</span>
        <span class="n">parent_gas_limit</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">,</span>
        <span class="n">parent_ommers_hash</span><span class="o">=</span><span class="n">parent</span><span class="o">.</span><span class="n">ommers_hash</span><span class="p">,</span>
        <span class="n">block_hashes</span><span class="o">=</span><span class="p">{</span><span class="n">parent</span><span class="o">.</span><span class="n">number</span><span class="p">:</span> <span class="n">parent</span><span class="o">.</span><span class="n">hash</span> <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">hash</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span><span class="p">},</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Environment.parent_hash" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parent_hash</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Environment.parent_hash" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Obtains the latest hash according to the highest block number in
<code>block_hashes</code>.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parent_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtains the latest hash according to the highest block number in</span>
<span class="sd">    `block_hashes`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_hashes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>

    <span class="n">last_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">Number</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_hashes</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>
    <span class="k">return</span> <span class="n">Hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_hashes</span><span class="p">[</span><span class="n">last_index</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Environment.apply_new_parent" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">apply_new_parent</span><span class="p">(</span><span class="n">new_parent</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Environment.apply_new_parent" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Applies a header as parent to a copy of this environment.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_new_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_parent</span><span class="p">:</span> <span class="s2">&quot;FixtureHeader&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Environment&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies a header as parent to a copy of this environment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">env</span><span class="o">.</span><span class="n">parent_difficulty</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">difficulty</span>
    <span class="n">env</span><span class="o">.</span><span class="n">parent_timestamp</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">timestamp</span>
    <span class="n">env</span><span class="o">.</span><span class="n">parent_base_fee</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">base_fee</span>
    <span class="n">env</span><span class="o">.</span><span class="n">parent_blob_gas_used</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">blob_gas_used</span>
    <span class="n">env</span><span class="o">.</span><span class="n">parent_excess_blob_gas</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">excess_blob_gas</span>
    <span class="n">env</span><span class="o">.</span><span class="n">parent_gas_used</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">gas_used</span>
    <span class="n">env</span><span class="o">.</span><span class="n">parent_gas_limit</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">gas_limit</span>
    <span class="n">env</span><span class="o">.</span><span class="n">parent_ommers_hash</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">ommers_hash</span>
    <span class="n">env</span><span class="o">.</span><span class="n">block_hashes</span><span class="p">[</span><span class="n">new_parent</span><span class="o">.</span><span class="n">number</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">hash</span> <span class="k">if</span> <span class="n">new_parent</span><span class="o">.</span><span class="n">hash</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">env</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Environment.set_fork_requirements" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_fork_requirements</span><span class="p">(</span><span class="n">fork</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Environment.set_fork_requirements" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Fills the required fields in an environment depending on the fork.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_fork_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Environment&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fills the required fields in an environment depending on the fork.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">in_place</span> <span class="k">else</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">number</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">header_prev_randao_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span> <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">prev_randao</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">prev_randao</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">header_withdrawals_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span> <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">withdrawals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">withdrawals</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">fork</span><span class="o">.</span><span class="n">header_base_fee_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
        <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">base_fee</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">parent_base_fee</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="n">res</span><span class="o">.</span><span class="n">base_fee</span> <span class="o">=</span> <span class="n">DEFAULT_BASE_FEE</span>

    <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">header_zero_difficulty_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
        <span class="n">res</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">fork</span><span class="o">.</span><span class="n">header_excess_blob_gas_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
        <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">excess_blob_gas</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">parent_excess_blob_gas</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="n">res</span><span class="o">.</span><span class="n">excess_blob_gas</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">fork</span><span class="o">.</span><span class="n">header_blob_gas_used_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
        <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">blob_gas_used</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">parent_blob_gas_used</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="n">res</span><span class="o">.</span><span class="n">blob_gas_used</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">header_beacon_root_required</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span> <span class="ow">and</span> <span class="n">res</span><span class="o">.</span><span class="n">beacon_root</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">beacon_root</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.AccessList" class="doc doc-heading">
          <code>AccessList</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.AccessList" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Access List for transactions.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">AccessList</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Access List for transactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">address</span><span class="p">:</span> <span class="n">FixedSizeBytesConvertible</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Address</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">storage_keys</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;storageKeys&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">Hash</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x</span><span class="p">],</span>
            <span class="n">skip_string_convert</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the access list as a list of serializable elements.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">),</span> <span class="p">[</span><span class="n">Hash</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_keys</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.AccessList.to_list" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_list</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.AccessList.to_list" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the access list as a list of serializable elements.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the access list as a list of serializable elements.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">),</span> <span class="p">[</span><span class="n">Hash</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_keys</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Transaction" class="doc doc-heading">
          <code>Transaction</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.Transaction" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Generic object that can represent all Ethereum transaction types.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Transaction</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generic object that can represent all Ethereum transaction types.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ty</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;type&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transaction type value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chain_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;chainId&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">gas_price</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;gasPrice&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">max_priority_fee_per_gas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;maxPriorityFeePerGas&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">max_fee_per_gas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;maxFeePerGas&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">gas_limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">21000</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;gas&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">to</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="n">AddrAA</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Address</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">BytesConvertible</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">bytes</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Bytes</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">access_list</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">AccessList</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;accessList&quot;</span><span class="p">,</span>
            <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">max_fee_per_blob_gas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;maxFeePerBlobGas&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">blob_versioned_hashes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;blobVersionedHashes&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">Hash</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">x</span><span class="p">],</span>
            <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">v</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">r</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">s</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">wrapped_blob_transaction</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">blobs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">blob_kzg_commitments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">blob_kzg_proofs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">sender</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Address</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">secret_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;secretKey&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Hash</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">protected</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">error</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="k">class</span> <span class="nc">InvalidFeePayment</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transaction described more than one fee payment type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="s2">&quot;only one type of fee payment field can be used in a single tx&quot;</span>

    <span class="k">class</span> <span class="nc">InvalidSignaturePrivateKey</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transaction describes both the signature and private key of</span>
<span class="sd">        source account.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="s2">&quot;can&#39;t define both &#39;signature&#39; and &#39;private_key&#39;&quot;</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ensures the transaction has no conflicting properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="n">Transaction</span><span class="o">.</span><span class="n">InvalidFeePayment</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Transaction</span><span class="o">.</span><span class="n">InvalidSignaturePrivateKey</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">TestPrivateKey</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Try to deduce transaction type from included fields</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Set default values for fields that are required for certain tx types</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">with_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a copy of the transaction with an added error.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tx</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">tx</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="n">error</span>
        <span class="k">return</span> <span class="n">tx</span>

    <span class="k">def</span> <span class="nf">with_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a copy of the transaction with a modified nonce.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tx</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">tx</span><span class="o">.</span><span class="n">nonce</span> <span class="o">=</span> <span class="n">nonce</span>
        <span class="k">return</span> <span class="n">tx</span>

    <span class="k">def</span> <span class="nf">with_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a deepcopy of the transaction with modified fields.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tx</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid field &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; for Transaction&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tx</span>

    <span class="k">def</span> <span class="nf">payload_body</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the list of values included in the transaction body.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;signature must be set before serializing any tx type&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_limit must be set for all tx types&quot;</span><span class="p">)</span>
        <span class="n">to</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">bytes</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># EIP-4844: https://eips.ethereum.org/EIPS/eip-4844</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_priority_fee_per_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_blob_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_versioned_hashes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;blob_versioned_hashes must be set for type 3 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;access_list must be set for type 3 tx&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_blob_transaction</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;blobs must be set for network version of type 3 tx&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_kzg_commitments</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;blob_kzg_commitments must be set for network version of type 3 tx&quot;</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_kzg_proofs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;blob_kzg_proofs must be set for network version of type 3 tx&quot;</span>
                    <span class="p">)</span>

                <span class="k">return</span> <span class="p">[</span>
                    <span class="p">[</span>
                        <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
                        <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                        <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span><span class="p">),</span>
                        <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span><span class="p">),</span>
                        <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                        <span class="n">to</span><span class="p">,</span>
                        <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                        <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                        <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">],</span>
                        <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span><span class="p">),</span>
                        <span class="p">[</span><span class="n">Hash</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_versioned_hashes</span><span class="p">],</span>
                        <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span>
                        <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span>
                        <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
                    <span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">blobs</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">blob_kzg_commitments</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">blob_kzg_proofs</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                    <span class="n">to</span><span class="p">,</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                    <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                    <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">],</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span><span class="p">),</span>
                    <span class="p">[</span><span class="n">Hash</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_versioned_hashes</span><span class="p">],</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
                <span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># EIP-1559: https://eips.ethereum.org/EIPS/eip-1559</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_priority_fee_per_gas must be set for type 2 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_gas must be set for type 2 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;access_list must be set for type 2 tx&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                <span class="n">to</span><span class="p">,</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">],</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># EIP-2930: https://eips.ethereum.org/EIPS/eip-2930</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_price must be set for type 1 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;access_list must be set for type 1 tx&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">[</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                <span class="n">to</span><span class="p">,</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">],</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_price must be set for type 0 tx&quot;</span><span class="p">)</span>
            <span class="c1"># EIP-155: https://eips.ethereum.org/EIPS/eip-155</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                <span class="n">to</span><span class="p">,</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
            <span class="p">]</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;serialized_bytes not implemented for tx type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ty</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">serialized_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns bytes of the serialized representation of the transaction,</span>
<span class="sd">        which is almost always RLP encoding.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ty must be set for all tx types&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ty</span><span class="p">])</span> <span class="o">+</span> <span class="n">eth_rlp</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">payload_body</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">eth_rlp</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">payload_body</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">signing_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the list of values included in the envelope used for signing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_limit must be set for all tx types&quot;</span><span class="p">)</span>
        <span class="n">to</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">bytes</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># EIP-4844: https://eips.ethereum.org/EIPS/eip-4844</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_priority_fee_per_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_blob_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_versioned_hashes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;blob_versioned_hashes must be set for type 3 tx&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                <span class="n">to</span><span class="p">,</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span><span class="p">),</span>
                <span class="p">[</span><span class="n">Hash</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_versioned_hashes</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># EIP-1559: https://eips.ethereum.org/EIPS/eip-1559</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_priority_fee_per_gas must be set for type 2 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_gas must be set for type 2 tx&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                <span class="n">to</span><span class="p">,</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># EIP-2930: https://eips.ethereum.org/EIPS/eip-2930</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_price must be set for type 1 tx&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">[</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                <span class="n">to</span><span class="p">,</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_price must be set for type 0 tx&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">protected</span><span class="p">:</span>
                <span class="c1"># EIP-155: https://eips.ethereum.org/EIPS/eip-155</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                    <span class="n">to</span><span class="p">,</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                    <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                    <span class="n">to</span><span class="p">,</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                    <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                <span class="p">]</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;signing for transaction type </span><span class="si">{self.ty}</span><span class="s2"> not implemented&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">signing_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the serialized bytes of the transaction used for signing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ty must be set for all tx types&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ty</span><span class="p">])</span> <span class="o">+</span> <span class="n">eth_rlp</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signing_envelope</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">eth_rlp</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signing_envelope</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">signature_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the serialized bytes of the transaction signature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">protected</span><span class="p">:</span>
                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="n">v</span> <span class="o">-=</span> <span class="mi">35</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">-=</span> <span class="mi">27</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">v</span><span class="p">])</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">with_signature_and_sender</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a signed version of the transaction using the private key.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tx</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Transaction already signed</span>
            <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">sender</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">public_key</span> <span class="o">=</span> <span class="n">PublicKey</span><span class="o">.</span><span class="n">from_signature_and_message</span><span class="p">(</span>
                    <span class="n">tx</span><span class="o">.</span><span class="n">signature_bytes</span><span class="p">(),</span> <span class="n">keccak256</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">signing_bytes</span><span class="p">()),</span> <span class="n">hasher</span><span class="o">=</span><span class="kc">None</span>
                <span class="p">)</span>
                <span class="n">tx</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">keccak256</span><span class="p">(</span><span class="n">public_key</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">compressed</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])[</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">20</span> <span class="p">:]</span>
            <span class="k">return</span> <span class="n">tx</span>

        <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;secret_key must be set to sign a transaction&quot;</span><span class="p">)</span>

        <span class="c1"># Get the signing bytes</span>
        <span class="n">signing_hash</span> <span class="o">=</span> <span class="n">keccak256</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">signing_bytes</span><span class="p">())</span>

        <span class="c1"># Sign the bytes</span>

        <span class="n">private_key</span> <span class="o">=</span> <span class="n">PrivateKey</span><span class="p">(</span>
            <span class="n">secret</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">secret_key</span><span class="p">)</span> <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">signature_bytes</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">sign_recoverable</span><span class="p">(</span><span class="n">signing_hash</span><span class="p">,</span> <span class="n">hasher</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">public_key</span> <span class="o">=</span> <span class="n">PublicKey</span><span class="o">.</span><span class="n">from_signature_and_message</span><span class="p">(</span>
            <span class="n">signature_bytes</span><span class="p">,</span> <span class="n">signing_hash</span><span class="p">,</span> <span class="n">hasher</span><span class="o">=</span><span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">tx</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">keccak256</span><span class="p">(</span><span class="n">public_key</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">compressed</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])[</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">20</span> <span class="p">:]</span>

        <span class="n">tx</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">tx</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">tx</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">signature_bytes</span><span class="p">[</span><span class="mi">64</span><span class="p">],</span>
            <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">signature_bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">32</span><span class="p">],</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">),</span>
            <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">signature_bytes</span><span class="p">[</span><span class="mi">32</span><span class="p">:</span><span class="mi">64</span><span class="p">],</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">protected</span><span class="p">:</span>
                <span class="n">tx</span><span class="o">.</span><span class="n">v</span> <span class="o">+=</span> <span class="mi">35</span> <span class="o">+</span> <span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># not protected</span>
                <span class="n">tx</span><span class="o">.</span><span class="n">v</span> <span class="o">+=</span> <span class="mi">27</span>

        <span class="c1"># Remove the secret key because otherwise we might attempt to sign again (?)</span>
        <span class="n">tx</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">tx</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Transaction.ty" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">ty</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">cast_type</span><span class="o">=</span><span class="n">HexNumber</span><span class="p">))</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Transaction.ty" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Transaction type value.</p>
  </div>

</div>






<div class="doc doc-object doc-class">




<h3 id="ethereum_test_tools.Transaction.InvalidFeePayment" class="doc doc-heading">
          <code>InvalidFeePayment</code>


<a href="#ethereum_test_tools.Transaction.InvalidFeePayment" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>Exception</code></p>

  
      <p>Transaction described more than one fee payment type.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidFeePayment</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transaction described more than one fee payment type.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;only one type of fee payment field can be used in a single tx&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h4 id="ethereum_test_tools.Transaction.InvalidFeePayment.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Transaction.InvalidFeePayment.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;only one type of fee payment field can be used in a single tx&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h3 id="ethereum_test_tools.Transaction.InvalidSignaturePrivateKey" class="doc doc-heading">
          <code>InvalidSignaturePrivateKey</code>


<a href="#ethereum_test_tools.Transaction.InvalidSignaturePrivateKey" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code>Exception</code></p>

  
      <p>Transaction describes both the signature and private key of
source account.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidSignaturePrivateKey</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transaction describes both the signature and private key of</span>
<span class="sd">    source account.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;can&#39;t define both &#39;signature&#39; and &#39;private_key&#39;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h4 id="ethereum_test_tools.Transaction.InvalidSignaturePrivateKey.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Transaction.InvalidSignaturePrivateKey.__str__" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  
      <p>Print exception string</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print exception string&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;can&#39;t define both &#39;signature&#39; and &#39;private_key&#39;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Transaction.__post_init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Transaction.__post_init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Ensures the transaction has no conflicting properties.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures the transaction has no conflicting properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="n">Transaction</span><span class="o">.</span><span class="n">InvalidFeePayment</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Transaction</span><span class="o">.</span><span class="n">InvalidSignaturePrivateKey</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">TestPrivateKey</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Try to deduce transaction type from included fields</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Set default values for fields that are required for certain tx types</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Transaction.with_error" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">with_error</span><span class="p">(</span><span class="n">error</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Transaction.with_error" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a copy of the transaction with an added error.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">with_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">error</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a copy of the transaction with an added error.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tx</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="n">error</span>
    <span class="k">return</span> <span class="n">tx</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Transaction.with_nonce" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">with_nonce</span><span class="p">(</span><span class="n">nonce</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Transaction.with_nonce" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a copy of the transaction with a modified nonce.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">with_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a copy of the transaction with a modified nonce.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">tx</span><span class="o">.</span><span class="n">nonce</span> <span class="o">=</span> <span class="n">nonce</span>
    <span class="k">return</span> <span class="n">tx</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Transaction.with_fields" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">with_fields</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Transaction.with_fields" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a deepcopy of the transaction with modified fields.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">with_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a deepcopy of the transaction with modified fields.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid field &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; for Transaction&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tx</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Transaction.payload_body" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">payload_body</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Transaction.payload_body" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the list of values included in the transaction body.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">payload_body</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the list of values included in the transaction body.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;signature must be set before serializing any tx type&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_limit must be set for all tx types&quot;</span><span class="p">)</span>
    <span class="n">to</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">bytes</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="c1"># EIP-4844: https://eips.ethereum.org/EIPS/eip-4844</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_priority_fee_per_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_blob_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_versioned_hashes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;blob_versioned_hashes must be set for type 3 tx&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;access_list must be set for type 3 tx&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_blob_transaction</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;blobs must be set for network version of type 3 tx&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_kzg_commitments</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;blob_kzg_commitments must be set for network version of type 3 tx&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_kzg_proofs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;blob_kzg_proofs must be set for network version of type 3 tx&quot;</span>
                <span class="p">)</span>

            <span class="k">return</span> <span class="p">[</span>
                <span class="p">[</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                    <span class="n">to</span><span class="p">,</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                    <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                    <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">],</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span><span class="p">),</span>
                    <span class="p">[</span><span class="n">Hash</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_versioned_hashes</span><span class="p">],</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span>
                    <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
                <span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blobs</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blob_kzg_commitments</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blob_kzg_proofs</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                <span class="n">to</span><span class="p">,</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">],</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span><span class="p">),</span>
                <span class="p">[</span><span class="n">Hash</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_versioned_hashes</span><span class="p">],</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
            <span class="p">]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># EIP-1559: https://eips.ethereum.org/EIPS/eip-1559</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_priority_fee_per_gas must be set for type 2 tx&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_gas must be set for type 2 tx&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;access_list must be set for type 2 tx&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
            <span class="n">to</span><span class="p">,</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
            <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
            <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">],</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># EIP-2930: https://eips.ethereum.org/EIPS/eip-2930</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_price must be set for type 1 tx&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;access_list must be set for type 1 tx&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
            <span class="n">to</span><span class="p">,</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
            <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
            <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">],</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_price must be set for type 0 tx&quot;</span><span class="p">)</span>
        <span class="c1"># EIP-155: https://eips.ethereum.org/EIPS/eip-155</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
            <span class="n">to</span><span class="p">,</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
            <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">),</span>
        <span class="p">]</span>

    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;serialized_bytes not implemented for tx type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ty</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Transaction.serialized_bytes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">serialized_bytes</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Transaction.serialized_bytes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns bytes of the serialized representation of the transaction,
which is almost always RLP encoding.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">serialized_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns bytes of the serialized representation of the transaction,</span>
<span class="sd">    which is almost always RLP encoding.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ty must be set for all tx types&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ty</span><span class="p">])</span> <span class="o">+</span> <span class="n">eth_rlp</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">payload_body</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">eth_rlp</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">payload_body</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Transaction.signing_envelope" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">signing_envelope</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Transaction.signing_envelope" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the list of values included in the envelope used for signing.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">signing_envelope</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the list of values included in the envelope used for signing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_limit must be set for all tx types&quot;</span><span class="p">)</span>
    <span class="n">to</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">bytes</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="c1"># EIP-4844: https://eips.ethereum.org/EIPS/eip-4844</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_priority_fee_per_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_blob_gas must be set for type 3 tx&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_versioned_hashes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;blob_versioned_hashes must be set for type 3 tx&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
            <span class="n">to</span><span class="p">,</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
            <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
            <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_blob_gas</span><span class="p">),</span>
            <span class="p">[</span><span class="n">Hash</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_versioned_hashes</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># EIP-1559: https://eips.ethereum.org/EIPS/eip-1559</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_priority_fee_per_gas must be set for type 2 tx&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_fee_per_gas must be set for type 2 tx&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_priority_fee_per_gas</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_fee_per_gas</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
            <span class="n">to</span><span class="p">,</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
            <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
            <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
        <span class="p">]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># EIP-2930: https://eips.ethereum.org/EIPS/eip-2930</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_price must be set for type 1 tx&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span><span class="p">),</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
            <span class="n">to</span><span class="p">,</span>
            <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
            <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
            <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[],</span>
        <span class="p">]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;gas_price must be set for type 0 tx&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">protected</span><span class="p">:</span>
            <span class="c1"># EIP-155: https://eips.ethereum.org/EIPS/eip-155</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                <span class="n">to</span><span class="p">,</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nonce</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_price</span><span class="p">),</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span><span class="p">),</span>
                <span class="n">to</span><span class="p">,</span>
                <span class="n">Uint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span>
                <span class="n">Bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
            <span class="p">]</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;signing for transaction type </span><span class="si">{self.ty}</span><span class="s2"> not implemented&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Transaction.signing_bytes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">signing_bytes</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Transaction.signing_bytes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the serialized bytes of the transaction used for signing.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">signing_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the serialized bytes of the transaction used for signing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ty must be set for all tx types&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ty</span><span class="p">])</span> <span class="o">+</span> <span class="n">eth_rlp</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signing_envelope</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">eth_rlp</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signing_envelope</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Transaction.signature_bytes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">signature_bytes</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Transaction.signature_bytes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns the serialized bytes of the transaction signature.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">signature_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the serialized bytes of the transaction signature.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">protected</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">v</span> <span class="o">-=</span> <span class="mi">35</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">-=</span> <span class="mi">27</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">v</span><span class="p">])</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Transaction.with_signature_and_sender" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">with_signature_and_sender</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Transaction.with_signature_and_sender" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns a signed version of the transaction using the private key.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">with_signature_and_sender</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Transaction&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a signed version of the transaction using the private key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tx</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Transaction already signed</span>
        <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">sender</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">public_key</span> <span class="o">=</span> <span class="n">PublicKey</span><span class="o">.</span><span class="n">from_signature_and_message</span><span class="p">(</span>
                <span class="n">tx</span><span class="o">.</span><span class="n">signature_bytes</span><span class="p">(),</span> <span class="n">keccak256</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">signing_bytes</span><span class="p">()),</span> <span class="n">hasher</span><span class="o">=</span><span class="kc">None</span>
            <span class="p">)</span>
            <span class="n">tx</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">keccak256</span><span class="p">(</span><span class="n">public_key</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">compressed</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])[</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">20</span> <span class="p">:]</span>
        <span class="k">return</span> <span class="n">tx</span>

    <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;secret_key must be set to sign a transaction&quot;</span><span class="p">)</span>

    <span class="c1"># Get the signing bytes</span>
    <span class="n">signing_hash</span> <span class="o">=</span> <span class="n">keccak256</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">signing_bytes</span><span class="p">())</span>

    <span class="c1"># Sign the bytes</span>

    <span class="n">private_key</span> <span class="o">=</span> <span class="n">PrivateKey</span><span class="p">(</span>
        <span class="n">secret</span><span class="o">=</span><span class="n">Hash</span><span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">secret_key</span><span class="p">)</span> <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">secret_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">signature_bytes</span> <span class="o">=</span> <span class="n">private_key</span><span class="o">.</span><span class="n">sign_recoverable</span><span class="p">(</span><span class="n">signing_hash</span><span class="p">,</span> <span class="n">hasher</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">public_key</span> <span class="o">=</span> <span class="n">PublicKey</span><span class="o">.</span><span class="n">from_signature_and_message</span><span class="p">(</span>
        <span class="n">signature_bytes</span><span class="p">,</span> <span class="n">signing_hash</span><span class="p">,</span> <span class="n">hasher</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">tx</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">keccak256</span><span class="p">(</span><span class="n">public_key</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">compressed</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])[</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">20</span> <span class="p">:]</span>

    <span class="n">tx</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">tx</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">tx</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">signature_bytes</span><span class="p">[</span><span class="mi">64</span><span class="p">],</span>
        <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">signature_bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">32</span><span class="p">],</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">),</span>
        <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">signature_bytes</span><span class="p">[</span><span class="mi">32</span><span class="p">:</span><span class="mi">64</span><span class="p">],</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">ty</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tx</span><span class="o">.</span><span class="n">protected</span><span class="p">:</span>
            <span class="n">tx</span><span class="o">.</span><span class="n">v</span> <span class="o">+=</span> <span class="mi">35</span> <span class="o">+</span> <span class="p">(</span><span class="n">tx</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># not protected</span>
            <span class="n">tx</span><span class="o">.</span><span class="n">v</span> <span class="o">+=</span> <span class="mi">27</span>

    <span class="c1"># Remove the secret key because otherwise we might attempt to sign again (?)</span>
    <span class="n">tx</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">tx</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Header" class="doc doc-heading">
          <code>Header</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.Header" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Header type used to describe block header properties in test specs.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Header</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Header type used to describe block header properties in test specs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">parent_hash</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">ommers_hash</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">coinbase</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">state_root</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">transactions_root</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">receipt_root</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">bloom</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">difficulty</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">number</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">gas_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">gas_used</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">extra_data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">mix_digest</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">nonce</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">base_fee</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span> <span class="o">|</span> <span class="n">Removable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">withdrawals_root</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span> <span class="o">|</span> <span class="n">Removable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">blob_gas_used</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span> <span class="o">|</span> <span class="n">Removable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">excess_blob_gas</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NumberConvertible</span> <span class="o">|</span> <span class="n">Removable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">beacon_root</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span> <span class="o">|</span> <span class="n">Removable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="nb">hash</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">REMOVE_FIELD</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">Removable</span><span class="p">]</span> <span class="o">=</span> <span class="n">Removable</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sentinel object used to specify that a header field should be removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">EMPTY_FIELD</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">Removable</span><span class="p">]</span> <span class="o">=</span> <span class="n">Removable</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sentinel object used to specify that a header field must be empty during verification.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Header.REMOVE_FIELD" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">REMOVE_FIELD</span><span class="p">:</span> <span class="n">Removable</span> <span class="o">=</span> <span class="n">Removable</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Header.REMOVE_FIELD" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Sentinel object used to specify that a header field should be removed.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Header.EMPTY_FIELD" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">EMPTY_FIELD</span><span class="p">:</span> <span class="n">Removable</span> <span class="o">=</span> <span class="n">Removable</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Header.EMPTY_FIELD" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Sentinel object used to specify that a header field must be empty during verification.</p>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Block" class="doc doc-heading">
          <code>Block</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.Block" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="ethereum_test_tools.common.types.Header" href="#ethereum_test_tools.Header">Header</a></code></p>

  
      <p>Block type used to describe block properties in test specs</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Block</span><span class="p">(</span><span class="n">Header</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Block type used to describe block properties in test specs</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rlp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If set, blockchain test will skip generating the block and will pass this value directly to</span>
<span class="sd">    the Fixture.</span>

<span class="sd">    Only meant to be used to simulate blocks with bad formats, and therefore</span>
<span class="sd">    requires the block to produce an exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">header_verify</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Header</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If set, the block header will be verified against the specified values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rlp_modifier</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Header</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An RLP modifying header which values would be used to override the ones</span>
<span class="sd">    returned by the  `evm_transition_tool`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">exception</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If set, the block is expected to be rejected by the client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">engine_api_error_code</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EngineAPIError</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If set, the block is expected to produce an error response from the Engine API.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">txs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Transaction</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of transactions included in the block.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ommers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Header</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of ommer headers included in the block.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">withdrawals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Withdrawal</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    List of withdrawals to perform for this block.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">set_environment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">:</span> <span class="n">Environment</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Environment</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a copy of the environment with the characteristics of this</span>
<span class="sd">        specific block.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_env</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Values that need to be set in the environment and are `None` for</span>
<span class="sd">        this block need to be set to their defaults.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">environment_default</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">()</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">coinbase</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coinbase</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coinbase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">environment_default</span><span class="o">.</span><span class="n">coinbase</span>
        <span class="p">)</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">gas_limit</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">environment_default</span><span class="o">.</span><span class="n">gas_limit</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fee</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">base_fee</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_fee</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">withdrawals</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excess_blob_gas</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">excess_blob_gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">excess_blob_gas</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blob_gas_used</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">blob_gas_used</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_gas_used</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beacon_root</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">beacon_root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beacon_root</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        These values are required, but they depend on the previous environment,</span>
<span class="sd">        so they can be calculated here.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># calculate the next block number for the environment</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_env</span><span class="o">.</span><span class="n">block_hashes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">Number</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">new_env</span><span class="o">.</span><span class="n">block_hashes</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">new_env</span><span class="o">.</span><span class="n">parent_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="n">new_env</span><span class="o">.</span><span class="n">parent_timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_env</span>

    <span class="k">def</span> <span class="nf">copy_with_rlp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rlp</span><span class="p">:</span> <span class="n">Bytes</span> <span class="o">|</span> <span class="n">BytesConvertible</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Block&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a copy of the block and adds the specified RLP.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_block</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">new_block</span><span class="o">.</span><span class="n">rlp</span> <span class="o">=</span> <span class="n">Bytes</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">rlp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_block</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Block.rlp" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rlp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Block.rlp" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>If set, blockchain test will skip generating the block and will pass this value directly to
the Fixture.</p>
<p>Only meant to be used to simulate blocks with bad formats, and therefore
requires the block to produce an exception.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Block.header_verify" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">header_verify</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Header</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Block.header_verify" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>If set, the block header will be verified against the specified values.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Block.rlp_modifier" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">rlp_modifier</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Header</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Block.rlp_modifier" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>An RLP modifying header which values would be used to override the ones
returned by the  <code>evm_transition_tool</code>.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Block.exception" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">exception</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Block.exception" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>If set, the block is expected to be rejected by the client.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Block.engine_api_error_code" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">engine_api_error_code</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EngineAPIError</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Block.engine_api_error_code" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>If set, the block is expected to produce an error response from the Engine API.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Block.txs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">txs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Transaction</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Block.txs" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>List of transactions included in the block.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Block.ommers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">ommers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Header</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Block.ommers" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>List of ommer headers included in the block.</p>
  </div>

</div>






<div class="doc doc-object doc-attribute">




<h3 id="ethereum_test_tools.Block.withdrawals" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">withdrawals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Withdrawal</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#ethereum_test_tools.Block.withdrawals" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>List of withdrawals to perform for this block.</p>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Block.set_environment" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_environment</span><span class="p">(</span><span class="n">env</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Block.set_environment" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a copy of the environment with the characteristics of this
specific block.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_environment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">:</span> <span class="n">Environment</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Environment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a copy of the environment with the characteristics of this</span>
<span class="sd">    specific block.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_env</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Values that need to be set in the environment and are `None` for</span>
<span class="sd">    this block need to be set to their defaults.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">environment_default</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">()</span>
    <span class="n">new_env</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span>
    <span class="n">new_env</span><span class="o">.</span><span class="n">coinbase</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coinbase</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coinbase</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">environment_default</span><span class="o">.</span><span class="n">coinbase</span>
    <span class="p">)</span>
    <span class="n">new_env</span><span class="o">.</span><span class="n">gas_limit</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">environment_default</span><span class="o">.</span><span class="n">gas_limit</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_fee</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">base_fee</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_fee</span>
    <span class="n">new_env</span><span class="o">.</span><span class="n">withdrawals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">withdrawals</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">excess_blob_gas</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">excess_blob_gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">excess_blob_gas</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blob_gas_used</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">blob_gas_used</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blob_gas_used</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beacon_root</span><span class="p">,</span> <span class="n">Removable</span><span class="p">):</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">beacon_root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beacon_root</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    These values are required, but they depend on the previous environment,</span>
<span class="sd">    so they can be calculated here.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># calculate the next block number for the environment</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_env</span><span class="o">.</span><span class="n">block_hashes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_env</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">Number</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">new_env</span><span class="o">.</span><span class="n">block_hashes</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">new_env</span><span class="o">.</span><span class="n">parent_timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">new_env</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="n">new_env</span><span class="o">.</span><span class="n">parent_timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_env</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Block.copy_with_rlp" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">copy_with_rlp</span><span class="p">(</span><span class="n">rlp</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Block.copy_with_rlp" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a copy of the block and adds the specified RLP.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy_with_rlp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rlp</span><span class="p">:</span> <span class="n">Bytes</span> <span class="o">|</span> <span class="n">BytesConvertible</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Block&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a copy of the block and adds the specified RLP.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_block</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">new_block</span><span class="o">.</span><span class="n">rlp</span> <span class="o">=</span> <span class="n">Bytes</span><span class="o">.</span><span class="n">or_none</span><span class="p">(</span><span class="n">rlp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_block</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.FixtureEngineNewPayload" class="doc doc-heading">
          <code>FixtureEngineNewPayload</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.FixtureEngineNewPayload" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Representation of the <code>engine_newPayloadVX</code> information to be
sent using the block information.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">FixtureEngineNewPayload</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Representation of the `engine_newPayloadVX` information to be</span>
<span class="sd">    sent using the block information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">payload</span><span class="p">:</span> <span class="n">FixtureExecutionPayload</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;executionPayload&quot;</span><span class="p">,</span>
            <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">blob_versioned_hashes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;expectedBlobVersionedHashes&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="k">lambda</span> <span class="n">hashes</span><span class="p">:</span> <span class="p">[</span><span class="n">Hash</span><span class="p">(</span><span class="nb">hash</span><span class="p">)</span> <span class="k">for</span> <span class="nb">hash</span> <span class="ow">in</span> <span class="n">hashes</span><span class="p">],</span>
            <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="n">beacon_root</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">FixedSizeBytesConvertible</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;parentBeaconBlockRoot&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Hash</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">error_code</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EngineAPIError</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;errorCode&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_fixture_header</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
        <span class="n">header</span><span class="p">:</span> <span class="n">FixtureHeader</span><span class="p">,</span>
        <span class="n">transactions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Transaction</span><span class="p">],</span>
        <span class="n">withdrawals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Withdrawal</span><span class="p">]],</span>
        <span class="n">error_code</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EngineAPIError</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;FixtureEngineNewPayload&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a `FixtureEngineNewPayload` from a `FixtureHeader`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_payload_version</span> <span class="o">=</span> <span class="n">fork</span><span class="o">.</span><span class="n">engine_new_payload_version</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">header</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new_payload_version</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">new_payload</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">payload</span><span class="o">=</span><span class="n">FixtureExecutionPayload</span><span class="o">.</span><span class="n">from_fixture_header</span><span class="p">(</span>
                <span class="n">header</span><span class="o">=</span><span class="n">replace</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">beacon_root</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
                <span class="n">transactions</span><span class="o">=</span><span class="n">transactions</span><span class="p">,</span>
                <span class="n">withdrawals</span><span class="o">=</span><span class="n">withdrawals</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">version</span><span class="o">=</span><span class="n">new_payload_version</span><span class="p">,</span>
            <span class="n">error_code</span><span class="o">=</span><span class="n">error_code</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">engine_new_payload_blob_hashes</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">header</span><span class="o">.</span><span class="n">timestamp</span><span class="p">):</span>
            <span class="n">new_payload</span><span class="o">.</span><span class="n">blob_versioned_hashes</span> <span class="o">=</span> <span class="n">blob_versioned_hashes_from_transactions</span><span class="p">(</span>
                <span class="n">transactions</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">engine_new_payload_beacon_root</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">header</span><span class="o">.</span><span class="n">timestamp</span><span class="p">):</span>
            <span class="n">new_payload</span><span class="o">.</span><span class="n">beacon_root</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">beacon_root</span>

        <span class="k">return</span> <span class="n">new_payload</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.FixtureEngineNewPayload.from_fixture_header" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_fixture_header</span><span class="p">(</span><span class="n">fork</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="n">transactions</span><span class="p">,</span> <span class="n">withdrawals</span><span class="p">,</span> <span class="n">error_code</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#ethereum_test_tools.FixtureEngineNewPayload.from_fixture_header" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a <code>FixtureEngineNewPayload</code> from a <code>FixtureHeader</code>.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_fixture_header</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">fork</span><span class="p">:</span> <span class="n">Fork</span><span class="p">,</span>
    <span class="n">header</span><span class="p">:</span> <span class="n">FixtureHeader</span><span class="p">,</span>
    <span class="n">transactions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Transaction</span><span class="p">],</span>
    <span class="n">withdrawals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Withdrawal</span><span class="p">]],</span>
    <span class="n">error_code</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">EngineAPIError</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;FixtureEngineNewPayload&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a `FixtureEngineNewPayload` from a `FixtureHeader`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_payload_version</span> <span class="o">=</span> <span class="n">fork</span><span class="o">.</span><span class="n">engine_new_payload_version</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">header</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">new_payload_version</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">new_payload</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">payload</span><span class="o">=</span><span class="n">FixtureExecutionPayload</span><span class="o">.</span><span class="n">from_fixture_header</span><span class="p">(</span>
            <span class="n">header</span><span class="o">=</span><span class="n">replace</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">beacon_root</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
            <span class="n">transactions</span><span class="o">=</span><span class="n">transactions</span><span class="p">,</span>
            <span class="n">withdrawals</span><span class="o">=</span><span class="n">withdrawals</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">version</span><span class="o">=</span><span class="n">new_payload_version</span><span class="p">,</span>
        <span class="n">error_code</span><span class="o">=</span><span class="n">error_code</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">engine_new_payload_blob_hashes</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">header</span><span class="o">.</span><span class="n">timestamp</span><span class="p">):</span>
        <span class="n">new_payload</span><span class="o">.</span><span class="n">blob_versioned_hashes</span> <span class="o">=</span> <span class="n">blob_versioned_hashes_from_transactions</span><span class="p">(</span>
            <span class="n">transactions</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">fork</span><span class="o">.</span><span class="n">engine_new_payload_beacon_root</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">header</span><span class="o">.</span><span class="n">timestamp</span><span class="p">):</span>
        <span class="n">new_payload</span><span class="o">.</span><span class="n">beacon_root</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">beacon_root</span>

    <span class="k">return</span> <span class="n">new_payload</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>






<div class="doc doc-object doc-class">




<h2 id="ethereum_test_tools.Fixture" class="doc doc-heading">
          <code>Fixture</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#ethereum_test_tools.Fixture" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Cross-client compatible Ethereum test fixture.</p>

            <details class="quote">
              <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Fixture</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cross-client compatible Ethereum test fixture.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;_info&quot;</span><span class="p">,</span>
            <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">blocks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">FixtureBlock</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;blocks&quot;</span><span class="p">,</span>
            <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">genesis</span><span class="p">:</span> <span class="n">FixtureHeader</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;genesisBlockHeader&quot;</span><span class="p">,</span>
            <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">genesis_rlp</span><span class="p">:</span> <span class="n">Bytes</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;genesisRLP&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">head</span><span class="p">:</span> <span class="n">Hash</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;lastblockhash&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">fork</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;network&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">pre_state</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Account</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;pre&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Alloc</span><span class="p">,</span>
            <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">post_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Account</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;postState&quot;</span><span class="p">,</span>
            <span class="n">cast_type</span><span class="o">=</span><span class="n">Alloc</span><span class="p">,</span>
            <span class="n">to_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">seal_engine</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sealEngine&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">_json</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">json_encoder</span><span class="o">=</span><span class="n">JSONEncoder</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span>
            <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Post init hook to convert to JSON after instantiation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json</span> <span class="o">=</span> <span class="n">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert to JSON.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Fixture not initialized&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json</span><span class="p">[</span><span class="s2">&quot;_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json</span>

    <span class="k">def</span> <span class="nf">fill_info</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
        <span class="n">ref_spec</span><span class="p">:</span> <span class="n">ReferenceSpec</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fill the info field for this fixture</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;filling-transition-tool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t8n</span><span class="o">.</span><span class="n">version</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ref_spec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ref_spec</span><span class="o">.</span><span class="n">write_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Fixture.__post_init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Fixture.__post_init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Post init hook to convert to JSON after instantiation.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Post init hook to convert to JSON after instantiation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_json</span> <span class="o">=</span> <span class="n">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Fixture.to_json" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_json</span><span class="p">()</span></code>

<a href="#ethereum_test_tools.Fixture.to_json" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Convert to JSON.</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert to JSON.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Fixture not initialized&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_json</span><span class="p">[</span><span class="s2">&quot;_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_json</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>







<div class="doc doc-object doc-function">




<h3 id="ethereum_test_tools.Fixture.fill_info" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fill_info</span><span class="p">(</span><span class="n">t8n</span><span class="p">,</span> <span class="n">ref_spec</span><span class="p">)</span></code>

<a href="#ethereum_test_tools.Fixture.fill_info" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Fill the info field for this fixture</p>

          <details class="quote">
            <summary>Source code in <code>src/ethereum_test_tools/common/types.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fill_info</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">t8n</span><span class="p">:</span> <span class="n">TransitionTool</span><span class="p">,</span>
    <span class="n">ref_spec</span><span class="p">:</span> <span class="n">ReferenceSpec</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fill the info field for this fixture</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;filling-transition-tool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t8n</span><span class="o">.</span><span class="n">version</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ref_spec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ref_spec</span><span class="o">.</span><span class="n">write_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>




  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright: 2023, Ethereum Community
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "search.suggest", "search.highlight", "content.tabs.link", "navigation.indexes", "navigation.instant", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>