<!DOCTYPE html>
<html lang="en-us">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title></title>
        
        <style>

    html body {
        font-family: '', sans-serif;
        background-color: white;
    }

    :root {
        --accent: #2196F3;
        --border-width:  0 ;
    }

</style>


<link rel="stylesheet" href="http://localhost:1313/css/main.css">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=">





<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" crossorigin="anonymous">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />
 






<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.148.0">
        


        
            <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        <link rel="stylesheet" href="http://localhost:1313/css/callouts.css">
    </head>

    <body>
        

        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#"></a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                    
                </div>
            </div>
        </nav>


<main>

    <div>
        <h2></h2>
        <h5></h5>
        

    </div>

    <div align="start" class="content"><h1 id="an-explanation-of-test-ids-generated-by-fill">An explanation of test IDs generated by <code>fill</code></h1>
<h2 id="test-case-organization">Test Case Organization</h2>
<p>Test cases are implemented in Python &ldquo;modules&rdquo;, which are organized by folder, named after the fork where the feature-under-test was introduced, for example:</p>
<ul>
<li><code>tests/cancun/</code> contains tests for features added in the Cancun hardfork.</li>
<li><code>tests/prague/</code> contains tests for features added in the Prague hardfork.</li>
</ul>
<h2 id="test-id-generation">Test ID generation</h2>
<p>A test ID is a string, generated by the test framework, that uniquely identifies a test case. It&rsquo;s format is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>&lt;python_test_module_path&gt;::&lt;python_test_function_name&gt;[&lt;parameter_1_id&gt;-...-&lt;parameter_N_id]
</span></span></code></pre></div><p>Let&rsquo;s use the following simple test case example to understand this format:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>tests/istanbul/eip1344_chainid/test_chainid.py::test_chainid[fork_Cancun-blockchain_test]
</span></span></code></pre></div><p>The components map as following:</p>
<ul>
<li><code>&lt;python_test_module_path&gt;</code> - the Python &ldquo;module&rdquo; (file) where the test is implemented <code>tests/istanbul/eip1344_chainid/test_chainid.py</code>,</li>
<li><code>&lt;python_test_function_name&gt;</code> - the Python test function: <code>test_chainid</code>,</li>
<li><code>[&lt;parameter_1_id&gt;-...-&lt;parameter_N_id]</code> - the test parameters, this test case has the following parameters:
<ul>
<li><code>fork_Cancun</code>, to read &ldquo;fork = Cancun&rdquo;, the fork the test case is filled for,</li>
<li><code>blockchain_test</code>, the test type.</li>
</ul>
</li>
</ul>
<p>Although <code>test_chainid</code> is not directly parametrized on the test function level, the framework always parametrizes tests by fork and, if possible, by test type. If we inspect its function signature, we see that it&rsquo;s native test format is of type <code>StateTestFiller</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@pytest.mark.valid_from</span>(<span style="color:#e6db74">&#34;Istanbul&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_chainid</span>(state_test: StateTestFiller, pre: Alloc):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Test CHAINID opcode.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span></code></pre></div><h3 id="parametrization-by-fork">Parametrization by Fork</h3>
<p>Every test case is parametrized by the <code>fork</code> where the feature-under-test remains valid, for example:</p>
<ul>
<li>Test cases in <code>tests/cancun/</code> get filled for Cancun and Prague.</li>
<li>Test cases in <code>tests/prague/</code>, only get filled for Prague, at the time of writing, as Prague is the current fork in development.</li>
</ul>
<p>All test IDs contain the <code>fork_&lt;name&gt;</code> parameter used to generate the test case in the test ID, e.g., <code>test_Cancun</code>.</p>
<h4 id="transition-forks">Transition Forks</h4>
<p>The test framework can also generate blockchain tests containing blocks that span a fork boundary, these test cases receive a special fork parameter name which contain both fork names and the timestamp at which the transition was made, e.g., <code>fork_CancunToPragueAtTime15k</code>.</p>
<h3 id="parametrization-by-test-type">Parametrization by Test Type</h3>
<p>Each Python test case is also typically parametrized by test type, respectively fixture format. For example, if the test is implemented as a <code>state_test</code>, the test framework will additionally generate the following blockchain test fixtures (consisting of a single block with a single transaction):</p>
<ul>
<li>a <code>blockchain_test</code> which can be tested via the Hive <code>eest/consume-rlp</code> simulator (or directly via a dedicated client interface).</li>
<li>a <code>blockchain_engine_test</code> (for post-merge forks) which can be tested via the Hive <code>eest/consume-engine</code> simulator.</li>
</ul>
<h3 id="example-the-test-ids-generated-for-test_chainid">Example: The Test IDs generated for <code>test_chainid</code></h3>
<p>To see all the test cases and their IDs that get generated from London until Shanghai for <code>test_chainid</code>, we can execute <code>fill</code> with the <code>--collect-only -q</code> flags:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>fill tests/istanbul/eip1344_chainid/test_chainid.py --from London --until Shanghai --collect-only -q 
</span></span></code></pre></div><p>which lists the following test IDs:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>tests/istanbul/eip1344_chainid/test_chainid.py::test_chainid[fork_London-blockchain_test]
</span></span><span style="display:flex;"><span>tests/istanbul/eip1344_chainid/test_chainid.py::test_chainid[fork_London-state_test]
</span></span><span style="display:flex;"><span>tests/istanbul/eip1344_chainid/test_chainid.py::test_chainid[fork_Paris-blockchain_test]
</span></span><span style="display:flex;"><span>tests/istanbul/eip1344_chainid/test_chainid.py::test_chainid[fork_Paris-blockchain_test_engine]
</span></span><span style="display:flex;"><span>tests/istanbul/eip1344_chainid/test_chainid.py::test_chainid[fork_Paris-state_test]
</span></span><span style="display:flex;"><span>tests/istanbul/eip1344_chainid/test_chainid.py::test_chainid[fork_Shanghai-blockchain_test]
</span></span><span style="display:flex;"><span>tests/istanbul/eip1344_chainid/test_chainid.py::test_chainid[fork_Shanghai-blockchain_test_engine]
</span></span><span style="display:flex;"><span>tests/istanbul/eip1344_chainid/test_chainid.py::test_chainid[fork_Shanghai-state_test]
</span></span></code></pre></div><h3 id="additional-parametrization">Additional Parametrization</h3>
<p>The test function <code>tests/cancun/eip4844_blobs/test_blob_txs.py::test_blob_type_tx_pre_fork</code> is additionally parametrized:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>tests/cancun/eip4844_blobs/test_blob_txs.py::test_blob_type_tx_pre_fork[fork_ShanghaiToCancunAtTime15k-blockchain_test-no_blob_tx]
</span></span><span style="display:flex;"><span>tests/cancun/eip4844_blobs/test_blob_txs.py::test_blob_type_tx_pre_fork[fork_ShanghaiToCancunAtTime15k-blockchain_test-one_blob_tx]
</span></span></code></pre></div><p>The strings <code>no_blob_tx</code> and <code>one_blob_tx</code> are additional descriptive parameter IDs that indicate the focus of the test.</p>
</div>

</main>

        <footer>
            <p class="copyright text-muted">Â© All rights reserved. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a>.</p>
        </footer>

        

        
    </body>

</html>

